<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.131.0"><meta name=generator content="Relearn 8.2.0"><meta name=description content='Perfect ‚Äî you‚Äôve shared logs from a PowerShell-based attack simulation, likely involving encoded command execution, web client downloads, and obfuscated scripts ‚Äî classic indicators of malicious PowerShell activity (e.g., Cobalt Strike, Empire, or custom malware).
Since you‚Äôve already loaded the data and confirmed the structure, let‚Äôs refine the feature engineering and Isolation Forest training specifically for this dataset.
import pandas as pd import json # Load and normalize data = [] with open("dcsync.'><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="project :: DrakonOps"><meta name=twitter:description content='Perfect ‚Äî you‚Äôve shared logs from a PowerShell-based attack simulation, likely involving encoded command execution, web client downloads, and obfuscated scripts ‚Äî classic indicators of malicious PowerShell activity (e.g., Cobalt Strike, Empire, or custom malware).
Since you‚Äôve already loaded the data and confirmed the structure, let‚Äôs refine the feature engineering and Isolation Forest training specifically for this dataset.
import pandas as pd import json # Load and normalize data = [] with open("dcsync.'><meta property="og:url" content="https://web/oscp-notes/project/index.html"><meta property="og:site_name" content="DrakonOps"><meta property="og:title" content="project :: DrakonOps"><meta property="og:description" content='Perfect ‚Äî you‚Äôve shared logs from a PowerShell-based attack simulation, likely involving encoded command execution, web client downloads, and obfuscated scripts ‚Äî classic indicators of malicious PowerShell activity (e.g., Cobalt Strike, Empire, or custom malware).
Since you‚Äôve already loaded the data and confirmed the structure, let‚Äôs refine the feature engineering and Isolation Forest training specifically for this dataset.
import pandas as pd import json # Load and normalize data = [] with open("dcsync.'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="OSCP Notes"><meta itemprop=name content="project :: DrakonOps"><meta itemprop=description content='Perfect ‚Äî you‚Äôve shared logs from a PowerShell-based attack simulation, likely involving encoded command execution, web client downloads, and obfuscated scripts ‚Äî classic indicators of malicious PowerShell activity (e.g., Cobalt Strike, Empire, or custom malware).
Since you‚Äôve already loaded the data and confirmed the structure, let‚Äôs refine the feature engineering and Isolation Forest training specifically for this dataset.
import pandas as pd import json # Load and normalize data = [] with open("dcsync.'><meta itemprop=wordCount content="902"><title>project :: DrakonOps</title>
<link href=../../images/logo.png?1762285676 rel=icon type=image/png><link href=../../css/auto-complete/auto-complete.min.css?1762285676 rel=stylesheet><script src=../../js/auto-complete/auto-complete.min.js?1762285676 defer></script><script src=../../js/search-lunr.min.js?1762285676 defer></script><script src=../../js/search.min.js?1762285676 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="../../searchindex.en.js?1762285676"</script><script src=../../js/lunr/lunr.min.js?1762285676 defer></script><script src=../../js/lunr/lunr.stemmer.support.min.js?1762285676 defer></script><script src=../../js/lunr/lunr.multi.min.js?1762285676 defer></script><script src=../../js/lunr/lunr.en.min.js?1762285676 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=../../fonts/fontawesome/css/fontawesome-all.min.css?1762285676 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../fonts/fontawesome/css/fontawesome-all.min.css?1762285676 rel=stylesheet></noscript><link href=../../css/perfect-scrollbar/perfect-scrollbar.min.css?1762285676 rel=stylesheet><link href=../../css/theme.min.css?1762285676 rel=stylesheet><link href=../../css/format-html.min.css?1762285676 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/oscp-notes/project/index.html",window.relearn.relBasePath="../..",window.relearn.relBaseUri="../..",window.relearn.absBaseUri="https://web",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!1,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.relearn.themevariants=["zen-dark"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><link href=../../css/custom.css?1762285676 rel=stylesheet></head><body class="mobile-support html" data-url=../../oscp-notes/project/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></span></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#-step-1-normalize--load-the-data-again-for-clarity>‚úÖ STEP 1: Normalize & Load the Data (Again, for Clarity)</a></li><li><a href=#-step-2-focus-on-high-risk-channels>‚úÖ STEP 2: Focus on High-Risk Channels</a></li><li><a href=#step-3-feature-engineering--tailored-for-powershell-attacks>STEP 3: Feature Engineering ‚Äî Tailored for PowerShell Attacks</a><ul><li><a href=#-key-features-to-create>üéØ Key Features to Create:</a></li></ul></li><li><a href=#-step-4-prepare-feature-matrix>‚úÖ STEP 4: Prepare Feature Matrix</a></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../index.html><span itemprop=name>DrakonOps</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../oscp-notes/index.html><span itemprop=name>OSCP Notes</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>project</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><a href=../../oscp-notes/methodology/index.html title="methodology (ü°ê)"><i class="fa-fw fas fa-chevron-left"></i></a></span></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><a href=../../oscp-notes/footprinting-and-finger-printing-web-apps/index.html title="footprinting and finger printing web apps (ü°í)"><i class="fa-fw fas fa-chevron-right"></i></a></span></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable oscp-notes" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=project>project</h1><p>Perfect ‚Äî you‚Äôve shared logs from a <strong>PowerShell-based attack simulation</strong>, likely involving <strong>encoded command execution, web client downloads, and obfuscated scripts</strong> ‚Äî classic indicators of malicious PowerShell activity (e.g., Cobalt Strike, Empire, or custom malware).</p><p>Since you‚Äôve already loaded the data and confirmed the structure, let‚Äôs <strong>refine the feature engineering and Isolation Forest training</strong> specifically for this dataset.</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>import pandas as pd
import json

# Load and normalize
data = []
with open(&#34;dcsync.json&#34;, &#34;r&#34;) as f:
    for line in f:
        try:
            data.append(json.loads(line))
        except:
            continue

df = pd.json_normalize(data)
print(f&#34;‚úÖ Loaded {len(df)} events.&#34;)</code></pre></div><p>¬†</p><p>¬†</p><p><a href=#R-image-50c517745819dbaafa88c799e2929461 class=lightbox-link><img alt=profile class="lazy lightbox figure-image" loading=lazy src=../../resources/qwen_icon_dark_84-2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-50c517745819dbaafa88c799e2929461><img alt=profile class="lazy lightbox lightbox-image" loading=lazy src=../../resources/qwen_icon_dark_84-2.png></a></p><p>Qwen3-Max-Preview7:00 pm</p><p>Perfect ‚Äî you‚Äôve shared logs from a <strong>PowerShell-based attack simulation</strong>, likely involving <strong>encoded command execution, web client downloads, and obfuscated scripts</strong> ‚Äî classic indicators of malicious PowerShell activity (e.g., Cobalt Strike, Empire, or custom malware).</p><p>Since you‚Äôve already loaded the data and confirmed the structure, let‚Äôs <strong>refine the feature engineering and Isolation Forest training</strong> specifically for this dataset.</p><hr><h2 id=-step-1-normalize--load-the-data-again-for-clarity>‚úÖ STEP 1: Normalize & Load the Data (Again, for Clarity)</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Load and normalize</span>
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;dcsync.json&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> f:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            data<span style=color:#f92672>.</span>append(json<span style=color:#f92672>.</span>loads(line))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>json_normalize(data)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;‚úÖ Loaded </span><span style=color:#e6db74>{</span>len(df)<span style=color:#e6db74>}</span><span style=color:#e6db74> events.&#34;</span>)</span></span></code></pre></div><hr><h2 id=-step-2-focus-on-high-risk-channels>‚úÖ STEP 2: Focus on High-Risk Channels</h2><p>Your logs show events from:</p><ul><li><code>Windows PowerShell</code></li><li><code>Microsoft-Windows-PowerShell/Operational</code></li><li><code>Microsoft-Windows-Sysmon/Operational</code></li><li><code>security</code></li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>high_risk_channels = [
    &#39;Windows PowerShell&#39;,
    &#39;Microsoft-Windows-PowerShell/Operational&#39;,
    &#39;Microsoft-Windows-Sysmon/Operational&#39;
]

df = df[df[&#39;Channel&#39;].isin(high_risk_channels)].copy()
print(f&#34;‚úÖ Filtered to {len(df)} high-risk events.&#34;)</code></pre></div><p>¬†</p><h2 id=step-3-feature-engineering--tailored-for-powershell-attacks>STEP 3: Feature Engineering ‚Äî Tailored for PowerShell Attacks</h2><p>We‚Äôll extract features that flag <strong>suspicious PowerShell behavior</strong>:</p><h3 id=-key-features-to-create>üéØ Key Features to Create:</h3><p><a href=#R-image-4bfc67a724adb92c4ae9b3c46b9812f2 class=lightbox-link><img alt=67d53cba0e6f8cd73cc3374211afc696.png class="lazy lightbox figure-image" loading=lazy src=../../resources/67d53cba0e6f8cd73cc3374211afc696.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4bfc67a724adb92c4ae9b3c46b9812f2><img alt=67d53cba0e6f8cd73cc3374211afc696.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/67d53cba0e6f8cd73cc3374211afc696.png></a></p><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.preprocessing <span style=color:#f92672>import</span> LabelEncoder
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Convert timestamp</span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;@timestamp&#39;</span>] <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>to_datetime(df[<span style=color:#e6db74>&#39;@timestamp&#39;</span>], errors<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;coerce&#39;</span>)
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;Hour&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;@timestamp&#39;</span>]<span style=color:#f92672>.</span>dt<span style=color:#f92672>.</span>hour
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;DayOfWeek&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;@timestamp&#39;</span>]<span style=color:#f92672>.</span>dt<span style=color:#f92672>.</span>dayofweek
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Encode categorical features</span>
</span></span><span style=display:flex><span>categorical_features <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;EventID&#39;</span>, <span style=color:#e6db74>&#39;Channel&#39;</span>, <span style=color:#e6db74>&#39;AccountName&#39;</span>, <span style=color:#e6db74>&#39;Hostname&#39;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> categorical_features:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> col <span style=color:#f92672>in</span> df<span style=color:#f92672>.</span>columns:
</span></span><span style=display:flex><span>        le <span style=color:#f92672>=</span> LabelEncoder()
</span></span><span style=display:flex><span>        df[col <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;_Encoded&#39;</span>] <span style=color:#f92672>=</span> le<span style=color:#f92672>.</span>fit_transform(df[col]<span style=color:#f92672>.</span>astype(str)<span style=color:#f92672>.</span>fillna(<span style=color:#e6db74>&#39;Unknown&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Feature: CommandLine length</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_command_text</span>(row):
</span></span><span style=display:flex><span>    <span style=color:#75715e># Try Payload first, then Message, then ContextInfo</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> [<span style=color:#e6db74>&#39;Payload&#39;</span>, <span style=color:#e6db74>&#39;Message&#39;</span>, <span style=color:#e6db74>&#39;ContextInfo&#39;</span>]:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> col <span style=color:#f92672>in</span> row <span style=color:#f92672>and</span> isinstance(row[col], str):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> row[col]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;CommandText&#39;</span>] <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>apply(get_command_text, axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;CommandLineLength&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;CommandText&#39;</span>]<span style=color:#f92672>.</span>str<span style=color:#f92672>.</span>len()<span style=color:#f92672>.</span>fillna(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Feature: Base64 detection</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>has_base64</span>(text):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> isinstance(text, str):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Look for PowerShell base64 flags or long base64-like strings</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> any(flag <span style=color:#f92672>in</span> text <span style=color:#66d9ef>for</span> flag <span style=color:#f92672>in</span> [<span style=color:#e6db74>&#39;-enc &#39;</span>, <span style=color:#e6db74>&#39;-e &#39;</span>, <span style=color:#e6db74>&#39; -enc&#39;</span>, <span style=color:#e6db74>&#39; -e&#39;</span>]):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Heuristic: long string with no spaces and A-Za-z0-9+/= chars</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(text) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>200</span> <span style=color:#f92672>and</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> text[:<span style=color:#ae81ff>100</span>] <span style=color:#f92672>and</span> all(c <span style=color:#f92672>in</span> <span style=color:#e6db74>&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#39;</span> <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> text[:<span style=color:#ae81ff>200</span>]):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;HasBase64&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;CommandText&#39;</span>]<span style=color:#f92672>.</span>apply(has_base64)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Feature: WebClient detection</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>has_webclient</span>(text):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> isinstance(text, str):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    patterns <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;System.Net.WebClient&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;DownloadString&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;DownloadData&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;DownloadFile&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;Net.WebClient&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;new-object net.webclient&#39;</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> int(any(p<span style=color:#f92672>.</span>lower() <span style=color:#f92672>in</span> text<span style=color:#f92672>.</span>lower() <span style=color:#66d9ef>for</span> p <span style=color:#f92672>in</span> patterns))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;HasWebClient&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;CommandText&#39;</span>]<span style=color:#f92672>.</span>apply(has_webclient)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Feature: RC4 detection (common in implants)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>has_rc4</span>(text):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> isinstance(text, str):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    patterns <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;RC4&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;$S[$_], $S[$J] = $S[$J], $S[$_]&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;256 | ForEach-Object&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;XOR $S&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;Key Scheduling Algorithm&#39;</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> int(any(p<span style=color:#f92672>.</span>lower() <span style=color:#f92672>in</span> text<span style=color:#f92672>.</span>lower() <span style=color:#66d9ef>for</span> p <span style=color:#f92672>in</span> patterns))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;HasRC4&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;CommandText&#39;</span>]<span style=color:#f92672>.</span>apply(has_rc4)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Feature: User event frequency</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;AccountName&#39;</span> <span style=color:#f92672>in</span> df<span style=color:#f92672>.</span>columns:
</span></span><span style=display:flex><span>    user_freq <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;AccountName&#39;</span>]<span style=color:#f92672>.</span>value_counts()
</span></span><span style=display:flex><span>    df[<span style=color:#e6db74>&#39;UserEventCount&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;AccountName&#39;</span>]<span style=color:#f92672>.</span>map(user_freq)<span style=color:#f92672>.</span>fillna(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Label for evaluation (NOT used in training)</span>
</span></span><span style=display:flex><span>SUSPICIOUS_PATTERNS <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;System.Net.WebClient&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;DownloadString&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;RC4&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;-enc &#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Get-Random&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;ForEach-Object&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;New-Object&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Out-Null&#39;</span>  <span style=color:#75715e># Often abused to hide output</span>
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;IsSuspiciousEvent&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;CommandText&#39;</span>]<span style=color:#f92672>.</span>apply(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>lambda</span> x: <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> isinstance(x, str) <span style=color:#f92672>and</span> any(p<span style=color:#f92672>.</span>lower() <span style=color:#f92672>in</span> x<span style=color:#f92672>.</span>lower() <span style=color:#66d9ef>for</span> p <span style=color:#f92672>in</span> SUSPICIOUS_PATTERNS) <span style=color:#66d9ef>else</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;‚úÖ Feature engineering complete!&#34;</span>)</span></span></code></pre></div><p>¬†</p><p>¬†</p><h2 id=-step-4-prepare-feature-matrix>‚úÖ STEP 4: Prepare Feature Matrix</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>feature_columns <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;EventID_Encoded&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Channel_Encoded&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;AccountName_Encoded&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Hostname_Encoded&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Hour&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;DayOfWeek&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;CommandLineLength&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;HasBase64&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;HasWebClient&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;HasRC4&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;UserEventCount&#39;</span>
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Only keep columns that exist and are numeric</span>
</span></span><span style=display:flex><span>feature_columns <span style=color:#f92672>=</span> [col <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> feature_columns <span style=color:#66d9ef>if</span> col <span style=color:#f92672>in</span> df<span style=color:#f92672>.</span>columns]
</span></span><span style=display:flex><span>X <span style=color:#f92672>=</span> df[feature_columns]<span style=color:#f92672>.</span>fillna(<span style=color:#ae81ff>0</span>)  <span style=color:#75715e># Fill NaN with 0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;‚úÖ Selected features:&#34;</span>, feature_columns)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;‚úÖ Feature matrix shape:&#34;</span>, X<span style=color:#f92672>.</span>shape)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>‚úÖ</span> STEP <span style=color:#ae81ff>5</span>: Train Isolation Forest
</span></span><span style=display:flex><span>python
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.ensemble <span style=color:#f92672>import</span> IsolationForest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>iso_forest <span style=color:#f92672>=</span> IsolationForest(
</span></span><span style=display:flex><span>    n_estimators<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>,
</span></span><span style=display:flex><span>    contamination<span style=color:#f92672>=</span><span style=color:#ae81ff>0.05</span>,  <span style=color:#75715e># Assume 5% anomalies</span>
</span></span><span style=display:flex><span>    random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>42</span>,
</span></span><span style=display:flex><span>    n_jobs<span style=color:#f92672>=-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>iso_forest<span style=color:#f92672>.</span>fit(X)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;Anomaly&#39;</span>] <span style=color:#f92672>=</span> iso_forest<span style=color:#f92672>.</span>predict(X)  <span style=color:#75715e># -1 = anomaly, 1 = normal</span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;AnomalyScore&#39;</span>] <span style=color:#f92672>=</span> iso_forest<span style=color:#f92672>.</span>decision_function(X)  <span style=color:#75715e># Lower = more anomalous</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;‚úÖ Model trained!&#34;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Anomaly distribution:&#34;</span>)
</span></span><span style=display:flex><span>print(df[<span style=color:#e6db74>&#39;Anomaly&#39;</span>]<span style=color:#f92672>.</span>value_counts())
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>‚úÖ</span> STEP <span style=color:#ae81ff>6</span>: Evaluate Performance
</span></span><span style=display:flex><span>python
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate Recall and FPR using IsSuspiciousEvent as ground truth</span>
</span></span><span style=display:flex><span>suspicious <span style=color:#f92672>=</span> df[df[<span style=color:#e6db74>&#39;IsSuspiciousEvent&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>anomalous_suspicious <span style=color:#f92672>=</span> suspicious[suspicious[<span style=color:#e6db74>&#39;Anomaly&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total Suspicious Events: </span><span style=color:#e6db74>{</span>len(suspicious)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Detected as Anomaly: </span><span style=color:#e6db74>{</span>len(anomalous_suspicious)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> len(suspicious) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>    recall <span style=color:#f92672>=</span> len(anomalous_suspicious) <span style=color:#f92672>/</span> len(suspicious)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;üéØ Recall: </span><span style=color:#e6db74>{</span>recall<span style=color:#e6db74>:</span><span style=color:#e6db74>.2%</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>non_suspicious <span style=color:#f92672>=</span> df[df[<span style=color:#e6db74>&#39;IsSuspiciousEvent&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>fp <span style=color:#f92672>=</span> non_suspicious[non_suspicious[<span style=color:#e6db74>&#39;Anomaly&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>fpr <span style=color:#f92672>=</span> len(fp) <span style=color:#f92672>/</span> len(non_suspicious) <span style=color:#66d9ef>if</span> len(non_suspicious) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;üéØ False Positive Rate: </span><span style=color:#e6db74>{</span>fpr<span style=color:#e6db74>:</span><span style=color:#e6db74>.2%</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>üéØ</span> Your goal: Recall <span style=color:#960050;background-color:#1e0010>‚â•</span><span style=color:#ae81ff>85</span><span style=color:#f92672>%</span>, FPR <span style=color:#f92672>&lt;</span><span style=color:#ae81ff>5</span><span style=color:#f92672>%</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>‚úÖ</span> STEP <span style=color:#ae81ff>7</span>: Visualize <span style=color:#f92672>&amp;</span> Interpret Results
</span></span><span style=display:flex><span>python
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> seaborn <span style=color:#66d9ef>as</span> sns
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Plot anomaly scores</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>sns<span style=color:#f92672>.</span>histplot(data<span style=color:#f92672>=</span>df, x<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;AnomalyScore&#39;</span>, hue<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;IsSuspiciousEvent&#39;</span>, kde<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#39;Anomaly Score: Suspicious vs Normal Events&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>top_anomalies <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>nsmallest(<span style=color:#ae81ff>10</span>, <span style=color:#e6db74>&#39;AnomalyScore&#39;</span>)
</span></span><span style=display:flex><span>sns<span style=color:#f92672>.</span>barplot(data<span style=color:#f92672>=</span>top_anomalies, y<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;EventID&#39;</span>, x<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;AnomalyScore&#39;</span>, orient<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;h&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#39;Top 10 Most Anomalous Events by EventID&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>tight_layout()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Show top 5 most anomalous events</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>üîç Top 5 Most Anomalous Events:&#34;</span>)
</span></span><span style=display:flex><span>display_cols <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;@timestamp&#39;</span>, <span style=color:#e6db74>&#39;EventID&#39;</span>, <span style=color:#e6db74>&#39;Channel&#39;</span>, <span style=color:#e6db74>&#39;AccountName&#39;</span>, <span style=color:#e6db74>&#39;AnomalyScore&#39;</span>, <span style=color:#e6db74>&#39;HasBase64&#39;</span>, <span style=color:#e6db74>&#39;HasWebClient&#39;</span>, <span style=color:#e6db74>&#39;HasRC4&#39;</span>]
</span></span><span style=display:flex><span>print(df<span style=color:#f92672>.</span>nsmallest(<span style=color:#ae81ff>5</span>, <span style=color:#e6db74>&#39;AnomalyScore&#39;</span>)[display_cols]<span style=color:#f92672>.</span>to_string())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>‚úÖ</span> STEP <span style=color:#ae81ff>8</span>: Hyperparameter Tuning (Your Responsibility <span style=color:#960050;background-color:#1e0010>üòä</span>)
</span></span><span style=display:flex><span>python
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.model_selection <span style=color:#f92672>import</span> ParameterGrid
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>param_grid <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;contamination&#39;</span>: [<span style=color:#ae81ff>0.01</span>, <span style=color:#ae81ff>0.03</span>, <span style=color:#ae81ff>0.05</span>, <span style=color:#ae81ff>0.1</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;n_estimators&#39;</span>: [<span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>200</span>]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>best_recall <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>best_params <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> params <span style=color:#f92672>in</span> ParameterGrid(param_grid):
</span></span><span style=display:flex><span>    model <span style=color:#f92672>=</span> IsolationForest(<span style=color:#f92672>**</span>params, random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>42</span>, n_jobs<span style=color:#f92672>=-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    model<span style=color:#f92672>.</span>fit(X)
</span></span><span style=display:flex><span>    preds <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>predict(X)
</span></span><span style=display:flex><span>    df[<span style=color:#e6db74>&#39;Anomaly&#39;</span>] <span style=color:#f92672>=</span> preds
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    suspicious <span style=color:#f92672>=</span> df[df[<span style=color:#e6db74>&#39;IsSuspiciousEvent&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    detected <span style=color:#f92672>=</span> suspicious[suspicious[<span style=color:#e6db74>&#39;Anomaly&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    recall <span style=color:#f92672>=</span> len(detected) <span style=color:#f92672>/</span> len(suspicious) <span style=color:#66d9ef>if</span> len(suspicious) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> recall <span style=color:#f92672>&gt;</span> best_recall:
</span></span><span style=display:flex><span>        best_recall <span style=color:#f92672>=</span> recall
</span></span><span style=display:flex><span>        best_params <span style=color:#f92672>=</span> params
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;‚úÖ Best Parameters:&#34;</span>, best_params)</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=R-logo class=R-default href=../../><div class=logo-title style=display:flex;align-items:center><img src=../../images/logo.png alt=Logo style=width:90px;height:80>
<span>DrakonOps</span></div></a></div><search><form action=../../search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class="default-animation homelinks"><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-homelinks"><ul class="space collapsible-menu"><li data-nav-url=../../index.html><a class=padding href=../../index.html><i class="fa-fw fas fa-home"></i> Home</a></li></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols"><ul></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main"><ul class="enlarge morespace collapsible-menu"><li data-nav-url=../../ad-pentesting/index.html><a class=padding href=../../ad-pentesting/index.html>AD Pentesting<i class="fa-fw fas fa-check read-icon"></i></a></li><li class=parent data-nav-url=../../oscp-notes/index.html><input type=checkbox id=R-section-5f51e3ac21bcc264f305c28eac7484ea aria-controls=R-subsections-5f51e3ac21bcc264f305c28eac7484ea checked><label for=R-section-5f51e3ac21bcc264f305c28eac7484ea><i class="fa-fw fas fa-chevron-right"></i><span class=a11y-only>Submenu OSCP Notes</span></label><a class=padding href=../../oscp-notes/index.html>OSCP Notes<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-5f51e3ac21bcc264f305c28eac7484ea class=collapsible-menu><li data-nav-url=../../oscp-notes/main-methodology/index.html><a class=padding href=../../oscp-notes/main-methodology/index.html>main methodology<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/methodology/index.html><a class=padding href=../../oscp-notes/methodology/index.html>methodology<i class="fa-fw fas fa-check read-icon"></i></a></li><li class=active data-nav-url=../../oscp-notes/project/index.html><a class=padding href=../../oscp-notes/project/index.html>project<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/footprinting-and-finger-printing-web-apps/index.html><a class=padding href=../../oscp-notes/footprinting-and-finger-printing-web-apps/index.html>footprinting and finger printing web apps<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/nmap/index.html><a class=padding href=../../oscp-notes/nmap/index.html>nmap<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/go-busters/index.html><a class=padding href=../../oscp-notes/go-busters/index.html>Go busters<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/dns/index.html><a class=padding href=../../oscp-notes/dns/index.html>dns<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/smb/index.html><a class=padding href=../../oscp-notes/smb/index.html>smb<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/nfs/index.html><a class=padding href=../../oscp-notes/nfs/index.html>nfs<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/ftp/index.html><a class=padding href=../../oscp-notes/ftp/index.html>ftp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/smtp/index.html><a class=padding href=../../oscp-notes/smtp/index.html>smtp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/snmp/index.html><a class=padding href=../../oscp-notes/snmp/index.html>snmp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/imap-and-pop/index.html><a class=padding href=../../oscp-notes/imap-and-pop/index.html>imap and pop<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/mssql/index.html><a class=padding href=../../oscp-notes/mssql/index.html>mssql<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/oracle-databases-tns/index.html><a class=padding href=../../oscp-notes/oracle-databases-tns/index.html>oracle databases TNS<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/ipmi/index.html><a class=padding href=../../oscp-notes/ipmi/index.html>IPMI<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/vhosts/index.html><a class=padding href=../../oscp-notes/vhosts/index.html>vhosts<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/web-attacks/index.html><a class=padding href=../../oscp-notes/web-attacks/index.html>Web Attacks<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/xss/index.html><a class=padding href=../../oscp-notes/xss/index.html>XSS<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/login-brute-force-wordlists/index.html><a class=padding href=../../oscp-notes/login-brute-force-wordlists/index.html>login brute force wordlists<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/crackmapexec/index.html><a class=padding href=../../oscp-notes/crackmapexec/index.html>crackmapexec<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/eum4linux/index.html><a class=padding href=../../oscp-notes/eum4linux/index.html>eum4linux<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/rpcclient/index.html><a class=padding href=../../oscp-notes/rpcclient/index.html>rpcclient<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/spwaning-shell/index.html><a class=padding href=../../oscp-notes/spwaning-shell/index.html>spwaning shell<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/file-transfers-windows/index.html><a class=padding href=../../oscp-notes/file-transfers-windows/index.html>File transfers windows<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/file-transfer-using-nc_ncat-and-rdp_winrm/index.html><a class=padding href=../../oscp-notes/file-transfer-using-nc_ncat-and-rdp_winrm/index.html>file transfer using nc_ncat and rdp_winrm<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/living-off-the-land-file-transfer/index.html><a class=padding href=../../oscp-notes/living-off-the-land-file-transfer/index.html>living off the land file transfer<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/transferring-files-with-code/index.html><a class=padding href=../../oscp-notes/transferring-files-with-code/index.html>Transferring Files with Code<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/privilige-escalation/index.html><a class=padding href=../../oscp-notes/privilige-escalation/index.html>privilige escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/linux-privilege-escalation/index.html><a class=padding href=../../oscp-notes/linux-privilege-escalation/index.html>linux privilege escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/windows-privilege-escalation/index.html><a class=padding href=../../oscp-notes/windows-privilege-escalation/index.html>Windows Privilege Escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/pivoting_tunneling/index.html><a class=padding href=../../oscp-notes/pivoting_tunneling/index.html>Scanning the Pivot Target<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/the-active-directory/index.html><a class=padding href=../../oscp-notes/the-active-directory/index.html>The Active Directory<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/the-metasploit-framework/index.html><a class=padding href=../../oscp-notes/the-metasploit-framework/index.html>The Metasploit Framework<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/linux-remote-management/index.html><a class=padding href=../../oscp-notes/linux-remote-management/index.html>Linux Remote Management<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/rdp-and-windows-remote-management/index.html><a class=padding href=../../oscp-notes/rdp-and-windows-remote-management/index.html>RDP and winrm<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/file-transfers-linux/index.html><a class=padding href=../../oscp-notes/file-transfers-linux/index.html>File transfers Linux<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/password-attacks/index.html><a class=padding href=../../oscp-notes/password-attacks/index.html>password attacks<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts"><ul class="space collapsible-menu"></ul></div><div id=R-footer-margin></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols"><ul><li class=R-historyclearer><div class="padding menu-control"><i class="fa-fw fas fa-history"></i>
<span>&nbsp;</span><div class=control-style><button>Clear History</button></div><div class=clear></div></div></li></ul></div><div id=R-footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=../../js/js-yaml/js-yaml.min.js?1762285676 defer></script><script src=../../js/d3/d3-color.min.js?1762285676 defer></script><script src=../../js/d3/d3-dispatch.min.js?1762285676 defer></script><script src=../../js/d3/d3-drag.min.js?1762285676 defer></script><script src=../../js/d3/d3-ease.min.js?1762285676 defer></script><script src=../../js/d3/d3-interpolate.min.js?1762285676 defer></script><script src=../../js/d3/d3-selection.min.js?1762285676 defer></script><script src=../../js/d3/d3-timer.min.js?1762285676 defer></script><script src=../../js/d3/d3-transition.min.js?1762285676 defer></script><script src=../../js/d3/d3-zoom.min.js?1762285676 defer></script><script src=../../js/mermaid/mermaid.min.js?1762285676 defer></script><script>window.relearn.themeUseMermaid=JSON.parse("{}")</script><script src=../../js/clipboard/clipboard.min.js?1762285676 defer></script><script src=../../js/perfect-scrollbar/perfect-scrollbar.min.js?1762285676 defer></script><script src=../../js/theme.min.js?1762285676 defer></script></body></html>